<!DOCTYPE html>
<html class="has-navbar-fixed-top">
  <head>
    <meta charset="utf-8" />
    <title>
       Heatmaps with CSS Grid &ndash; Codelibrary 
    </title>

    
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-41201218-21"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "UA-41201218-21");
    </script>

    
    

    
    
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.0/themes/prism.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/instantsearch.css@7.3.1/themes/algolia-min.css"
      integrity="sha256-HB49n/BZjuqiCtQQf49OdZn63XuKFaxcIHWf0HNKte8="
      crossorigin="anonymous"
    />

    
    <link rel="stylesheet" type="text/css" href="/scss/main.css" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="shortcut icon" href="/favicon.ico" />
  </head>

  <body>
    <div class="is-hidden">
      <svg>
  <defs>
    <g id="link-2">
      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
    </g>

    <g id="check">
      <polyline points="20 6 9 17 4 12"></polyline>
    </g>

    <g id="copy">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
    </g>

    <g id="external">
      <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
      <polyline points="15 3 21 3 21 9"></polyline>
      <line x1="10" y1="14" x2="21" y2="3"></line>
    </g>

  </defs>
</svg>

    </div>

    <nav class="navbar is-fixed-top"
     role="navigation"
     aria-label="Main navigation">
    <div class="navbar-brand">
        <button class="navbar-burger burger"
                type="button"
                data-target="sidebarNavbar"
                aria-controls="sidebarNavbar"
                aria-expanded="false"
                aria-label="Main menu">
            Menu
        </button>
        <a class="navbar-item"
           href="/"
           title="Back to the homepage">
            <img src="/img/ods-logo-helphub.svg"
                 alt="Helphub Logo"/>
        </a>
        <button class="navbar-burger burger"
                type="button"
                data-target="helphubNavbar"
                aria-controls="helphubNavbar"
                aria-expanded="false"
                aria-label="Help Hub Menu">
            Help Hub
        </button>
    </div>
    <div class="navbar-menu"
         id="helphubNavbar">
        <div class="navbar-start">
            <a class="navbar-item"
               href="https://help.opendatasoft.com/">
                Help Hub
            </a>
            <a class="navbar-item"
               href="https://help.opendatasoft.com/platform/en/">
                User guide
            </a>
            <a class="navbar-item is-active"
               href="https://codelibrary.opendatasoft.com">
                Code Library
            </a>
            <a class="navbar-item"
               href="https://help.opendatasoft.com/faq-glossary/en/">
                FAQ
            </a>
            <a class="navbar-item"
               href="https://help.opendatasoft.com/widgets/">
                Widgets
            </a>
            <a class="navbar-item"
               href="https://help.opendatasoft.com/en/apis/">
                APIs
            </a>
            <a class="navbar-item"
               href="https://academy.opendatasoft.com/page/homepage">
                Academy
            </a>
            <a class="navbar-item"
               href="https://documentation-resources.opendatasoft.com/pages/release-notes/?headless=true">
                Release Notes
            </a>
        </div>
    </div>
</nav>


    <div class="columns is-desktop codelibrary mb-0">
      <div class="column is-narrow pb-0">
        <div class="sidebar-search is-hidden-touch">
  <div class="block search-wrapper">
    <div id="algolia-box"></div>
    <div class="search-results-wrapper">
      <div id="algolia-results"></div>
    </div>
  </div>
</div>
<aside class="sidebar"
       id="sidebarNavbar">
  
  <div class="sidebar-header">
    <div class="block">
      <ul class="menu-list">
        <p class="menu-label">On this page</p>
        <li>
          <a href="#">
            Top
          </a>
        </li>
        
        <li>
          <a href="#heatmap-with-static-scale">
            Heatmap with static scale
          </a>
        </li>
        
        <li>
          <a href="#bubblemap-with-static-scale">
            Bubblemap with static scale
          </a>
        </li>
        
        <li>
          <a href="#heatmap-with-dynamic-color-scale">
            Heatmap with dynamic color scale
          </a>
        </li>
        
        <li>
          <a href="#bubblemap-with-dynamic-color-scale">
            Bubblemap with dynamic color scale
          </a>
        </li>
        
        <li>
          <a href="#heatmap-with-larger-text-in-legends">
            Heatmap with larger text in legends
          </a>
        </li>
        
      </ul>
    </div>
  </div>
  
  <div class="sidebar-body">
    
    
    <ul class="menu-list">
      <li>
        <a class="sidebar-subtitle"
          href="https://codelibrary.opendatasoft.com">
          Home
        </a>
      </li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <li>
        <a href="/components/"
        class="sidebar-subtitle">
        Components
        
      </a>
    </li>
    
    
      
      
      
      
      
      
      
      
      
      
      
      
      <li>
        <a href="/custom-views/"
        class="sidebar-subtitle">
        Custom views
        
      </a>
    </li>
    
    
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <li>
        <a href="/generators/"
        class="sidebar-subtitle">
        Generators
        
      </a>
    </li>
    
    
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <li>
        <a href="/page-templates/"
        class="sidebar-subtitle">
        Page templates
        
      </a>
    </li>
    
    
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <li>
        <a href="/portal-themes/"
        class="sidebar-subtitle">
        Portal themes
        
      </a>
    </li>
    
    
      
      <li>
        <a class="sidebar-subtitle " href="/widget-tricks/">
          Widget tricks
        </a>
        <ul>
          
          <li>
            <a class="" href="/widget-tricks/animation/">
              <div>
                Animations
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/charts/">
              <div>
                Chart samples
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/catalog-cards/">
              <div>
                Custom catalog card
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/custom-tooltips/">
              <div>
                Custom Tooltips
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/dates/">
              <div>
                Dates
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/drill-down/">
              <div>
                Drill-down refine in charts
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/filter-as-list/">
              <div>
                Filters as an HTML Select
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="is-active" href="/widget-tricks/heatmaps-custom/">
              <div>
                Heatmaps with CSS Grid
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/heatmaps-vegalite/">
              <div>
                Heatmaps with Vega-Lite
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/ods-adv-analysis/">
              <div>
                ods-adv-analysis
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/ods-aggregation/">
              <div>
                ods-aggregation
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/ods-analysis/">
              <div>
                ods-analysis, quick intro
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/ods-chart-css-hacks/">
              <div>
                ods-chart: CSS Hacks
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/ods-chart-css-library/">
              <div>
                ods-chart: Custom CSS Library
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/ods-color-gradient/">
              <div>
                ods-color-gradient &#43; ods-map : a choropleth alternative
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/ods-date-range-slider/">
              <div>
                ods-date-range-slider
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/ods-map-css/">
              <div>
                ods-map: CSS Hacks
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/ods-map-tricks/">
              <div>
                ods-map: Refine &amp; Zoom
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/ods-pop-in/">
              <div>
                ods-pop-in variants
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/ods-results/">
              <div>
                ods-results
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/ods-select/">
              <div>
                ods-select
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/ods-simple-tabs/">
              <div>
                ods-simple-tabs
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/share-print/">
              <div>
                Share and print
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/widget-tricks/svg-maps/">
              <div>
                Static maps, a quick introduction
                
                
              </div>
            </a>
          </li>
          
        </ul>
      </li>
      
    
  </ul>
  <p class="menu-label">
    Tags
  </p>
  <div class="tags">
    
    <a class="tag" href="/tags/aggregation/">
      aggregation
    </a>
    
    <a class="tag" href="/tags/chart/">
      chart
    </a>
    
    <a class="tag" href="/tags/date/">
      date
    </a>
    
    <a class="tag" href="/tags/display/">
      display
    </a>
    
    <a class="tag" href="/tags/filter/">
      filter
    </a>
    
    <a class="tag" href="/tags/geo/">
      geo
    </a>
    
    <a class="tag" href="/tags/list/">
      list
    </a>
    
    <a class="tag" href="/tags/map/">
      map
    </a>
    
    <a class="tag" href="/tags/navigation/">
      navigation
    </a>
    
    <a class="tag" href="/tags/ods-aggregation/">
      ods-aggregation
    </a>
    
    <a class="tag" href="/tags/ods-analysis/">
      ods-analysis
    </a>
    
    <a class="tag" href="/tags/ods-maps/">
      ods-maps
    </a>
    
  </div>
</div>
</aside>

      </div>
      <div class="column codelibrary-content">
        
<section class="section resources">
  <div class="container is-max-widescreen">
    <h1 class="title is-1">Widget Tricks - Heatmaps with CSS Grid</h1>
    <div class="content">
      <blockquote>
<p>We consider the usage of <code>ods-adv-analysis</code> as a prerequisite of this resource.
<a href="https://help.opendatasoft.com/widgets/#/api/ods-widgets.directive:odsAdvAnalysis">Documentation available here</a></p>
</blockquote>
<blockquote>
<p>Did you see ? <a href="/widget-tricks/heatmaps-vegalite">Heatmaps with Vega-lite</a></p>
</blockquote>
<p><strong>If Vega-lite does not satisfy your needs</strong>, for advanced usages, you can create heatmaps by hand with only HTML and CSS Grid.</p>
<p>Keep in mind that, for heatmaps or bubblemaps, you&rsquo;ll need to adapt the display depending on the values, axis, and legends.</p>
<p>For example, if the aggregation is too large to be displayed in cells, using <code>ods-tooltip</code> could be a nice way to display the value while hovering with the cursor.
Legends might also be a concern as they can overlap if they are too long.</p>

    </div>
    
    <article class="block">
      <h2 class="title is-2" id="heatmap-with-static-scale">
        Heatmap with static scale 
        <a class="is-link anchor" href="#heatmap-with-static-scale">
          <span class="icon">
            <img src="/img/fas-link.svg" />
          </span>
        </a>
      </h2>
      <div class="content">
        <p>The colors are static, and set in the <code>ng-class</code> of the cell, with a simple condition and static thresholds.
The code is therefore much simpler than dynamic RGB computation.</p>
<p>But keep in mind that if the order of size of the aggregation changes, you&rsquo;ll then need to adapt your thresholds, and therefore the page.</p>

      </div>
      
      <div class="box">
        






    




<div class="codepen">
    <form id="form-heatmap-with-static-scale"
          action="https://codepen.io/pen/define"
          method="POST"
          target="_blank">
        <input type="hidden"
               name="data"
               value='{
                 "title": "New Pen!",
                 "head": &#34;\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css\&#34;\n/\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\&#34;\n/\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.css\&#34;\n/\u003e\n\n\u003c!-- ODS Platform CSS - must be hosted on static : WIP --\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://s3-us-west-2.amazonaws.com/s.cdpn.io/4124551/ods.css\&#34;\n/\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://codelibrary.opendatasoft.com/css/theme.css\&#34;\n/\u003e\n\n\u003cscript src=\&#34;//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js\&#34;\u003e\u003c/script\u003e\n\u003cscript src=\&#34;//cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.js\&#34;\u003e\u003c/script\u003e\n\u003cscript src=\&#34;//cdnjs.cloudflare.com/ajax/libs/angular-sanitize/1.8.2/angular-sanitize.min.js\&#34;\u003e\u003c/script\u003e\n\u003cscript\n  type=\&#34;text/javascript\&#34;\n  src=\&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.js\&#34;\n\u003e\u003c/script\u003e\n\n\u003cscript\n  type=\&#34;text/javascript\&#34;\n  src=\&#34;https://codelibrary.opendatasoft.com/js/platform-filters.js\&#34;\n\u003e\u003c/script\u003e\n\u003cscript\n  type=\&#34;text/javascript\&#34;\n  src=\&#34;https://codelibrary.opendatasoft.com/js/ods-catalog-card.js\&#34;\n\u003e\u003c/script\u003e\n\n\u003cscript type=\&#34;text/javascript\&#34;\u003e\n  const sourceMonitoringInterceptor = $q =\u003e {\n    return {\n      request: config =\u003e {\n        if (config.params)\n          if (config.params.source) delete config.params.source;\n\n        config.url = config.url.replace(\n          \&#34;ods-api-monitoring\&#34;,\n          \&#34;monitoring-copy\&#34;\n        );\n        return config;\n      }\n    };\n  };\n\n  angular\n    .module(\&#34;ods-widgets\&#34;)\n    .config(function(ODSWidgetsConfigProvider, $httpProvider) {\n      ODSWidgetsConfigProvider.setConfig({\n        defaultDomain: \&#34;https://userclub.opendatasoft.com/\&#34;,\n        basemaps: [\n          {\n            provider: \&#34;jawg.light\&#34;,\n            label: \&#34;Jawg Light\&#34;,\n            jawg_apikey: \&#34;opendatasoft-community\&#34;\n          },\n          {\n            provider: \&#34;jawg.streets\&#34;,\n            label: \&#34;Jawg Streets\&#34;,\n            jawg_apikey: \&#34;opendatasoft-community\&#34;,\n            id: \&#34;streets\&#34;\n          }\n        ],\n        themes: {\n          default: {\n            url: \&#34;/img/ods.svg\&#34;\n          },\n          Santé: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/doctors.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Culture, Patrimoine\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/culture.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Éducation, Formation, Recherche, Enseignement\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/college.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          Environment: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/leaf.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Transports, Déplacements\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/train_station.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Aménagement du territoire, Urbanisme, Bâtiments, Équipements, Logement\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/townplanning.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Économie, Business, PME, Développement économique, Emploi\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/economy.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Administration, Gouvernement, Finances publiques, Citoyenneté\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/administration.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Justice, Sécurité, Police, Crime\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/court.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Sport, Loisirs\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/soccer.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Hébergement, Restauration\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/accommodation.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Services, Social\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/social.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          Checklist: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/copyshop.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          Usages: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/bike.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          }\n        },\n        mapPrependAttribution: \&#34;Jawg apikey NOT suitable for production\&#34;\n      });\n      $httpProvider.interceptors.push(sourceMonitoringInterceptor);\n    });\n\u003c/script\u003e\n&#34;,
                 "editors": 110,
                 "html": &#34;\u003cdiv ng-app=\&#34;ods-widgets\&#34;\u003e\n\u003cdiv class=\&#34;container\&#34;\u003e\n    \u003cods-dataset-context context=\&#34;datum\&#34;\n                         datum-dataset=\&#34;comptage-velo-donnees-compteurs\&#34;\n                         datum-parameters=\&#34;{&#39;q&#39;:&#39;totem&#39;}\&#34;\u003e\n        \u003cdiv ng-init=\&#34;variables = {};\n                      xaxis = &#39;nom_compteur&#39;;\n                      yaxis = &#39;year&#39;;\n                      yLegendWidth = 1\&#34;\u003e\n            \u003ch3\u003eAverage number of cyclists by counting totem\u003c/h3\u003e\n\n            \u003cdiv ods-adv-analysis=\&#34;results\&#34;\n                 ods-adv-analysis-context=\&#34;datum\&#34;\n                 ods-adv-analysis-select=\&#34;avg(sum_counts) as count\&#34;\n                 ods-adv-analysis-group-by=\&#34;year(date) as {{ yaxis }}, {{ xaxis }}\&#34;\u003e\n                {{\n                variables.numrow = (results | toObject:yaxis | numKeys) ;\n                variables.numcol = (results | toObject:xaxis | numKeys) ;\n                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;\n                variables.listcol = (results | toObject:xaxis | keys | orderBy) ; \&#34;\&#34;}}\n\n                \u003c!-- the grid --\u003e\n                \u003cdiv class=\&#34;heatmap\&#34;\n                     ng-class=\&#34;{&#39;display-values&#39;: variables.displayvalues}\&#34;\u003e\n\n                    \u003c!-- X axis : (bottom horizontal) list all values and set the correct position --\u003e\n                    \u003cdiv class=\&#34;x-axis-centered\&#34;\n                         ng-repeat=\&#34;(i,e) in variables.listcol\&#34;\n                         style=\&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;\n                                grid-row: {{variables.numrow &#43; 1}};\&#34;\u003e\n                        \u003cstrong\u003e{{e}}\u003c/strong\u003e\n                    \u003c/div\u003e\n\n                    \u003c!-- Y axis : (left vertical) list all values and set the correct position --\u003e\n                    \u003cdiv ng-repeat=\&#34;(i,e) in variables.listrow\&#34;\n                         class=\&#34;y-axis\&#34;\n                         style=\&#34;grid-column: 1 / span {{ yLegendWidth }};\n                                grid-row: {{ i &#43; 1 }};\&#34;\u003e\n                        \u003cstrong\u003e{{e}}\u003c/strong\u003e\n                    \u003c/div\u003e\n\n                    \u003c!-- Grid content --\u003e\n                    \u003cdiv class=\&#34;cell\&#34;\n                         ng-repeat=\&#34;(i,e) in results\&#34;\n                         ng-class=\&#34;{&#39;orange&#39;: e.count \u003e 150, &#39;lightgreen&#39;: e.count \u003e 100 \u0026\u0026 e.count \u003c= 150,&#39;darkgreen&#39;: e.count \u003c 100}\&#34;\n                         style=\&#34;grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};\n                                grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};\&#34;\u003e\n                        {{e.count | number : 0}}\n                    \u003c/div\u003e\n                \u003c/div\u003e\n\n                \u003cdiv class=\&#34;heatmap-sub row\&#34;\u003e\n                    \u003cdiv class=\&#34;col-sm-6\&#34;\u003e\n                        \u003cdiv class=\&#34;heatmap-switch\&#34;\u003e\n                            \u003cp\u003eDisplay values: \u003c/p\u003e\n                            \u003clabel class=\&#34;switch\&#34;\u003e\n                                \u003cinput class=\&#34;switch-input\&#34;\n                                       ng-model=\&#34;variables.displayvalues\&#34;\n                                       type=\&#34;checkbox\&#34;\u003e\n                                \u003cdiv class=\&#34;switch-button\&#34;\u003e\n                                    \u003cspan class=\&#34;switch-button-left\&#34;\u003eOFF\u003c/span\u003e\n                                    \u003cspan class=\&#34;switch-button-right\&#34;\u003eON\u003c/span\u003e\n                                \u003c/div\u003e\n                            \u003c/label\u003e\n                        \u003c/div\u003e\n                    \u003c/div\u003e\n                    \u003cdiv class=\&#34;col-sm-6\&#34;\u003e\n                    \u003c/div\u003e\n                \u003c/div\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n    \u003c/ods-dataset-context\u003e\n\u003c/div\u003e\n\n\u003c/div\u003e&#34;,
                 "css": &#34;/* cells colors */\n.orange {\n    background-color: orange;\n}\n\n.darkgreen {\n    background-color: #6ca474;\n}\n\n.mediumgreen {\n    background-color: #9ab932;\n}\n\n.lightgreen {\n    background-color: #b0c313;\n}\n\n:root {\n    --values-color: white;\n}\n\n.heatmap {\n    display: grid;\n    gap: 2px;\n    grid-auto-columns: 1fr;\n    grid-auto-flow: column;\n    grid-auto-rows: auto;\n    /* full auto, adapt to the content, ie the font size */\n}\n.heatmap \u003e * {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    overflow: hidden;\n    font-size: 0.8rem;\n}\n.heatmap.display-values .cell {\n    font-size: 0.6rem;\n}\n.heatmap .cell {\n    position: relative;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    overflow: hidden;\n    color: var(--values-color);\n    font-size: 0;\n}\n.heatmap .cell:hover {\n    border: 1px solid var(--values-color);\n    transform: scale(1.5);\n    font-size: 0.6rem;\n    z-index: 1;\n}\n.heatmap .cell.square:before {\n    content: \&#34;\&#34;;\n    display: block;\n    padding-bottom: 100%;\n}\n.heatmap .cell .round {\n    border-radius: 100%;\n    border: 1px solid black;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.x-axis-centered {\n    text-align: center;\n}\n.x-axis-rotate {\n    transform: rotate(-60deg);\n    padding: 35% 0;\n}\n\n.heatmap-sub {\n    margin-top: 13px;\n}\n\n.heatmap-legend {\n    display: flex;\n    width: 100%;\n    justify-content: space-between;\n    align-items: center;\n}\n.heatmap-legend .heatmap-legend__gradient {\n    display: block;\n    height: 25px;\n    width: 100%;\n    margin: 0 6px;\n    border: 1px solid darkgray;\n}\n\n.heatmap-switch {\n    display: flex;\n    align-items: baseline;\n}\n.heatmap-switch .switch {\n    margin-left: 6px;\n}\n\n/* Button Group Switch\n   ========================================================================== */\n.switch {\n    display: inline-block;\n}\n\n.switch-button {\n    /* background and border when in \&#34;off\&#34; state */\n    background: var(--highlight);\n    border: 2px solid var(--highlight);\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    border-radius: 6px;\n    color: #FFFFFF;\n    position: relative;\n    cursor: pointer;\n    outline: 0;\n    user-select: none;\n}\n\n.switch-input:not(:checked) &#43; .switch-button .switch-button-left {\n    /* text color when in \&#34;off\&#34; state */\n    color: var(--highlight);\n}\n\n.switch-input {\n    display: none;\n}\n\n.switch-button span {\n    font-size: 0.8rem;\n    padding: 0.2rem 0.7rem;\n    text-align: center;\n    z-index: 2;\n    color: #FFFFFF;\n    transition: color 0.2s;\n}\n\n.switch-button::before {\n    content: \&#34;\&#34;;\n    position: absolute;\n    background-color: #FFFFFF;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);\n    border-radius: 4px;\n    top: 0;\n    left: 0;\n    height: 100%;\n    width: 50%;\n    z-index: 1;\n    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;\n}\n\n.switch-button:hover::before {\n    will-change: padding;\n}\n\n.switch-button:active::before {\n    padding-right: 0.4rem;\n}\n\n/* \&#34;On\&#34; state\n   ========================== */\n.switch-input:checked &#43; .switch-button {\n    /* background and border when in \&#34;on\&#34; state */\n    background-color: var(--links);\n    border-color: var(--links);\n}\n\n.switch-input:checked &#43; .switch-button .switch-button-right {\n    /* text color when in \&#34;on\&#34; state */\n    color: var(--links);\n}\n\n.switch-input:checked &#43; .switch-button::before {\n    left: 50%;\n}\n\n.switch-input:checked &#43; .switch-button:active::before {\n    margin-left: -0.4rem;\n}\n\n/* Checkbox in disabled state\n   ========================== */\n.switch-input[type=checkbox]:disabled &#43; .switch-button {\n    opacity: 0.6;\n    cursor: not-allowed;\n}&#34;
               }'>
    </form>
</div>
<div class="ods-content">
    <div class="box-live-example"
      style="height: 550px;">
      <iframe id="iframe-heatmap-with-static-scale"
              width="100%" height="100%"
              src="about:blank"
              srcdoc="
                <head>&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css&#34;
/&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css&#34;
/&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.css&#34;
/&gt;

&lt;!-- ODS Platform CSS - must be hosted on static : WIP --&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://s3-us-west-2.amazonaws.com/s.cdpn.io/4124551/ods.css&#34;
/&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://codelibrary.opendatasoft.com/css/theme.css&#34;
/&gt;

&lt;script src=&#34;//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;//cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;//cdnjs.cloudflare.com/ajax/libs/angular-sanitize/1.8.2/angular-sanitize.min.js&#34;&gt;&lt;/script&gt;
&lt;script
  type=&#34;text/javascript&#34;
  src=&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.js&#34;
&gt;&lt;/script&gt;

&lt;script
  type=&#34;text/javascript&#34;
  src=&#34;https://codelibrary.opendatasoft.com/js/platform-filters.js&#34;
&gt;&lt;/script&gt;
&lt;script
  type=&#34;text/javascript&#34;
  src=&#34;https://codelibrary.opendatasoft.com/js/ods-catalog-card.js&#34;
&gt;&lt;/script&gt;

&lt;script type=&#34;text/javascript&#34;&gt;
  const sourceMonitoringInterceptor = $q =&gt; {
    return {
      request: config =&gt; {
        if (config.params)
          if (config.params.source) delete config.params.source;

        config.url = config.url.replace(
          &#34;ods-api-monitoring&#34;,
          &#34;monitoring-copy&#34;
        );
        return config;
      }
    };
  };

  angular
    .module(&#34;ods-widgets&#34;)
    .config(function(ODSWidgetsConfigProvider, $httpProvider) {
      ODSWidgetsConfigProvider.setConfig({
        defaultDomain: &#34;https://userclub.opendatasoft.com/&#34;,
        basemaps: [
          {
            provider: &#34;jawg.light&#34;,
            label: &#34;Jawg Light&#34;,
            jawg_apikey: &#34;opendatasoft-community&#34;
          },
          {
            provider: &#34;jawg.streets&#34;,
            label: &#34;Jawg Streets&#34;,
            jawg_apikey: &#34;opendatasoft-community&#34;,
            id: &#34;streets&#34;
          }
        ],
        themes: {
          default: {
            url: &#34;/img/ods.svg&#34;
          },
          Santé: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/doctors.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Culture, Patrimoine&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/culture.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Éducation, Formation, Recherche, Enseignement&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/college.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          Environment: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/leaf.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Transports, Déplacements&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/train_station.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Aménagement du territoire, Urbanisme, Bâtiments, Équipements, Logement&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/townplanning.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Économie, Business, PME, Développement économique, Emploi&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/economy.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Administration, Gouvernement, Finances publiques, Citoyenneté&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/administration.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Justice, Sécurité, Police, Crime&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/court.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Sport, Loisirs&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/soccer.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Hébergement, Restauration&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/accommodation.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Services, Social&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/social.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          Checklist: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/copyshop.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          Usages: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/bike.svg&#34;,
            color: &#34;#1446A0&#34;
          }
        },
        mapPrependAttribution: &#34;Jawg apikey NOT suitable for production&#34;
      });
      $httpProvider.interceptors.push(sourceMonitoringInterceptor);
    });
&lt;/script&gt;
</head>
                <base href='https://userclub.opendatasoft.com/'>
                <body>
                <div ng-app='ods-widgets'>&lt;div ng-app=&#34;ods-widgets&#34;&gt;
&lt;div class=&#34;container&#34;&gt;
    &lt;ods-dataset-context context=&#34;datum&#34;
                         datum-dataset=&#34;comptage-velo-donnees-compteurs&#34;
                         datum-parameters=&#34;{&#39;q&#39;:&#39;totem&#39;}&#34;&gt;
        &lt;div ng-init=&#34;variables = {};
                      xaxis = &#39;nom_compteur&#39;;
                      yaxis = &#39;year&#39;;
                      yLegendWidth = 1&#34;&gt;
            &lt;h3&gt;Average number of cyclists by counting totem&lt;/h3&gt;

            &lt;div ods-adv-analysis=&#34;results&#34;
                 ods-adv-analysis-context=&#34;datum&#34;
                 ods-adv-analysis-select=&#34;avg(sum_counts) as count&#34;
                 ods-adv-analysis-group-by=&#34;year(date) as {{ yaxis }}, {{ xaxis }}&#34;&gt;
                {{
                variables.numrow = (results | toObject:yaxis | numKeys) ;
                variables.numcol = (results | toObject:xaxis | numKeys) ;
                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;
                variables.listcol = (results | toObject:xaxis | keys | orderBy) ; &#34;&#34;}}

                &lt;!-- the grid --&gt;
                &lt;div class=&#34;heatmap&#34;
                     ng-class=&#34;{&#39;display-values&#39;: variables.displayvalues}&#34;&gt;

                    &lt;!-- X axis : (bottom horizontal) list all values and set the correct position --&gt;
                    &lt;div class=&#34;x-axis-centered&#34;
                         ng-repeat=&#34;(i,e) in variables.listcol&#34;
                         style=&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;
                                grid-row: {{variables.numrow &#43; 1}};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Y axis : (left vertical) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listrow&#34;
                         class=&#34;y-axis&#34;
                         style=&#34;grid-column: 1 / span {{ yLegendWidth }};
                                grid-row: {{ i &#43; 1 }};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Grid content --&gt;
                    &lt;div class=&#34;cell&#34;
                         ng-repeat=&#34;(i,e) in results&#34;
                         ng-class=&#34;{&#39;orange&#39;: e.count &gt; 150, &#39;lightgreen&#39;: e.count &gt; 100 &amp;&amp; e.count &lt;= 150,&#39;darkgreen&#39;: e.count &lt; 100}&#34;
                         style=&#34;grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};
                                grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};&#34;&gt;
                        {{e.count | number : 0}}
                    &lt;/div&gt;
                &lt;/div&gt;

                &lt;div class=&#34;heatmap-sub row&#34;&gt;
                    &lt;div class=&#34;col-sm-6&#34;&gt;
                        &lt;div class=&#34;heatmap-switch&#34;&gt;
                            &lt;p&gt;Display values: &lt;/p&gt;
                            &lt;label class=&#34;switch&#34;&gt;
                                &lt;input class=&#34;switch-input&#34;
                                       ng-model=&#34;variables.displayvalues&#34;
                                       type=&#34;checkbox&#34;&gt;
                                &lt;div class=&#34;switch-button&#34;&gt;
                                    &lt;span class=&#34;switch-button-left&#34;&gt;OFF&lt;/span&gt;
                                    &lt;span class=&#34;switch-button-right&#34;&gt;ON&lt;/span&gt;
                                &lt;/div&gt;
                            &lt;/label&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&#34;col-sm-6&#34;&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/ods-dataset-context&gt;
&lt;/div&gt;

&lt;/div&gt;</div>
                <style type='text/css'>
                    /* cells colors */
.orange {
    background-color: orange;
}

.darkgreen {
    background-color: #6ca474;
}

.mediumgreen {
    background-color: #9ab932;
}

.lightgreen {
    background-color: #b0c313;
}

:root {
    --values-color: white;
}

.heatmap {
    display: grid;
    gap: 2px;
    grid-auto-columns: 1fr;
    grid-auto-flow: column;
    grid-auto-rows: auto;
    /* full auto, adapt to the content, ie the font size */
}
.heatmap &gt; * {
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    font-size: 0.8rem;
}
.heatmap.display-values .cell {
    font-size: 0.6rem;
}
.heatmap .cell {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    color: var(--values-color);
    font-size: 0;
}
.heatmap .cell:hover {
    border: 1px solid var(--values-color);
    transform: scale(1.5);
    font-size: 0.6rem;
    z-index: 1;
}
.heatmap .cell.square:before {
    content: &#34;&#34;;
    display: block;
    padding-bottom: 100%;
}
.heatmap .cell .round {
    border-radius: 100%;
    border: 1px solid black;
    display: flex;
    justify-content: center;
    align-items: center;
}

.x-axis-centered {
    text-align: center;
}
.x-axis-rotate {
    transform: rotate(-60deg);
    padding: 35% 0;
}

.heatmap-sub {
    margin-top: 13px;
}

.heatmap-legend {
    display: flex;
    width: 100%;
    justify-content: space-between;
    align-items: center;
}
.heatmap-legend .heatmap-legend__gradient {
    display: block;
    height: 25px;
    width: 100%;
    margin: 0 6px;
    border: 1px solid darkgray;
}

.heatmap-switch {
    display: flex;
    align-items: baseline;
}
.heatmap-switch .switch {
    margin-left: 6px;
}

/* Button Group Switch
   ========================================================================== */
.switch {
    display: inline-block;
}

.switch-button {
    /* background and border when in &#34;off&#34; state */
    background: var(--highlight);
    border: 2px solid var(--highlight);
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-radius: 6px;
    color: #FFFFFF;
    position: relative;
    cursor: pointer;
    outline: 0;
    user-select: none;
}

.switch-input:not(:checked) &#43; .switch-button .switch-button-left {
    /* text color when in &#34;off&#34; state */
    color: var(--highlight);
}

.switch-input {
    display: none;
}

.switch-button span {
    font-size: 0.8rem;
    padding: 0.2rem 0.7rem;
    text-align: center;
    z-index: 2;
    color: #FFFFFF;
    transition: color 0.2s;
}

.switch-button::before {
    content: &#34;&#34;;
    position: absolute;
    background-color: #FFFFFF;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    border-radius: 4px;
    top: 0;
    left: 0;
    height: 100%;
    width: 50%;
    z-index: 1;
    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;
}

.switch-button:hover::before {
    will-change: padding;
}

.switch-button:active::before {
    padding-right: 0.4rem;
}

/* &#34;On&#34; state
   ========================== */
.switch-input:checked &#43; .switch-button {
    /* background and border when in &#34;on&#34; state */
    background-color: var(--links);
    border-color: var(--links);
}

.switch-input:checked &#43; .switch-button .switch-button-right {
    /* text color when in &#34;on&#34; state */
    color: var(--links);
}

.switch-input:checked &#43; .switch-button::before {
    left: 50%;
}

.switch-input:checked &#43; .switch-button:active::before {
    margin-left: -0.4rem;
}

/* Checkbox in disabled state
   ========================== */
.switch-input[type=checkbox]:disabled &#43; .switch-button {
    opacity: 0.6;
    cursor: not-allowed;
}
                </style>
                </body>
              ">
      </iframe>
      <div class="show-code buttons has-addons">
          <button class="button is-light">
            <span>Show code</span>
          </button>
          <button class="button is-light"
             target="_blank"
             aria-role="link"
             rel="noopener"
             title="Edit on CodePen, open a new tab"
             onclick="document.getElementById('form-heatmap-with-static-scale').submit()">
              <span>Edit on Codepen</span>
              <span class="icon is-small">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                  <use xlink:href="#external"></use>
                </svg>
              </span>
          </button>
      </div>
    </div>
    <div class="box-code js-tabs is-hidden">
        <nav class="level is-mobile">
            <div class="level-left">
                <div class="level-item">
                    <div class="buttons has-addons js-tablist">
                        <a
                          class="button is-primary is-outlined js-tablist__item js-tablist__link"
                          href="#code-heatmap-with-static-scale-html-content"
                        >
                          HTML
                        </a>
                        
                        <a
                          class="button is-primary is-outlined js-tablist__item js-tablist__link"
                          href="#code-heatmap-with-static-scale-css-content"
                        >
                          CSS
                        </a>
                        
                    </div>
                </div>
            </div>
            <div class="level-right">
                <button class="copy-to-cc button is-primary is-outlined is-rounded has-tooltip-left"
                  data-tooltip="Copy to clipboard"
                  aria-role="button"
                  title="Edit on CodePen, open a new tab"
                >
                  <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                      <use xlink:href="#copy"></use>
                    </svg>
                  </span>
                </button>
                <button class="copied-to-cc button is-success is-outlined is-rounded has-tooltip-left is-hidden"
                  data-tooltip="Copied"
                  aria-role="button"
                  title="Copied"
                >
                  <figure class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                      <use xlink:href="#check"></use>
                    </svg>
                  </figure>
                </button>
            </div>
        </nav>
        <div class="tab-content">
            <div class="js-tabcontent"
                 id="code-heatmap-with-static-scale-html-content"
                 data-clipboard="&lt;div class=&#34;container&#34;&gt;
    &lt;ods-dataset-context context=&#34;datum&#34;
                         datum-dataset=&#34;comptage-velo-donnees-compteurs&#34;
                         datum-parameters=&#34;{&#39;q&#39;:&#39;totem&#39;}&#34;&gt;
        &lt;div ng-init=&#34;variables = {};
                      xaxis = &#39;nom_compteur&#39;;
                      yaxis = &#39;year&#39;;
                      yLegendWidth = 1&#34;&gt;
            &lt;h3&gt;Average number of cyclists by counting totem&lt;/h3&gt;

            &lt;div ods-adv-analysis=&#34;results&#34;
                 ods-adv-analysis-context=&#34;datum&#34;
                 ods-adv-analysis-select=&#34;avg(sum_counts) as count&#34;
                 ods-adv-analysis-group-by=&#34;year(date) as {{ yaxis }}, {{ xaxis }}&#34;&gt;
                {{
                variables.numrow = (results | toObject:yaxis | numKeys) ;
                variables.numcol = (results | toObject:xaxis | numKeys) ;
                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;
                variables.listcol = (results | toObject:xaxis | keys | orderBy) ; &#34;&#34;}}

                &lt;!-- the grid --&gt;
                &lt;div class=&#34;heatmap&#34;
                     ng-class=&#34;{&#39;display-values&#39;: variables.displayvalues}&#34;&gt;

                    &lt;!-- X axis : (bottom horizontal) list all values and set the correct position --&gt;
                    &lt;div class=&#34;x-axis-centered&#34;
                         ng-repeat=&#34;(i,e) in variables.listcol&#34;
                         style=&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;
                                grid-row: {{variables.numrow &#43; 1}};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Y axis : (left vertical) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listrow&#34;
                         class=&#34;y-axis&#34;
                         style=&#34;grid-column: 1 / span {{ yLegendWidth }};
                                grid-row: {{ i &#43; 1 }};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Grid content --&gt;
                    &lt;div class=&#34;cell&#34;
                         ng-repeat=&#34;(i,e) in results&#34;
                         ng-class=&#34;{&#39;orange&#39;: e.count &gt; 150, &#39;lightgreen&#39;: e.count &gt; 100 &amp;&amp; e.count &lt;= 150,&#39;darkgreen&#39;: e.count &lt; 100}&#34;
                         style=&#34;grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};
                                grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};&#34;&gt;
                        {{e.count | number : 0}}
                    &lt;/div&gt;
                &lt;/div&gt;

                &lt;div class=&#34;heatmap-sub row&#34;&gt;
                    &lt;div class=&#34;col-sm-6&#34;&gt;
                        &lt;div class=&#34;heatmap-switch&#34;&gt;
                            &lt;p&gt;Display values: &lt;/p&gt;
                            &lt;label class=&#34;switch&#34;&gt;
                                &lt;input class=&#34;switch-input&#34;
                                       ng-model=&#34;variables.displayvalues&#34;
                                       type=&#34;checkbox&#34;&gt;
                                &lt;div class=&#34;switch-button&#34;&gt;
                                    &lt;span class=&#34;switch-button-left&#34;&gt;OFF&lt;/span&gt;
                                    &lt;span class=&#34;switch-button-right&#34;&gt;ON&lt;/span&gt;
                                &lt;/div&gt;
                            &lt;/label&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&#34;col-sm-6&#34;&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/ods-dataset-context&gt;
&lt;/div&gt;

"
                 role="tabpanel">
                <div class="highlight">
                    <pre class="language-html" data-lang="html"><code>&lt;div class=&#34;container&#34;&gt;
    &lt;ods-dataset-context context=&#34;datum&#34;
                         datum-dataset=&#34;comptage-velo-donnees-compteurs&#34;
                         datum-parameters=&#34;{&#39;q&#39;:&#39;totem&#39;}&#34;&gt;
        &lt;div ng-init=&#34;variables = {};
                      xaxis = &#39;nom_compteur&#39;;
                      yaxis = &#39;year&#39;;
                      yLegendWidth = 1&#34;&gt;
            &lt;h3&gt;Average number of cyclists by counting totem&lt;/h3&gt;

            &lt;div ods-adv-analysis=&#34;results&#34;
                 ods-adv-analysis-context=&#34;datum&#34;
                 ods-adv-analysis-select=&#34;avg(sum_counts) as count&#34;
                 ods-adv-analysis-group-by=&#34;year(date) as {{ yaxis }}, {{ xaxis }}&#34;&gt;
                {{
                variables.numrow = (results | toObject:yaxis | numKeys) ;
                variables.numcol = (results | toObject:xaxis | numKeys) ;
                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;
                variables.listcol = (results | toObject:xaxis | keys | orderBy) ; &#34;&#34;}}

                &lt;!-- the grid --&gt;
                &lt;div class=&#34;heatmap&#34;
                     ng-class=&#34;{&#39;display-values&#39;: variables.displayvalues}&#34;&gt;

                    &lt;!-- X axis : (bottom horizontal) list all values and set the correct position --&gt;
                    &lt;div class=&#34;x-axis-centered&#34;
                         ng-repeat=&#34;(i,e) in variables.listcol&#34;
                         style=&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;
                                grid-row: {{variables.numrow &#43; 1}};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Y axis : (left vertical) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listrow&#34;
                         class=&#34;y-axis&#34;
                         style=&#34;grid-column: 1 / span {{ yLegendWidth }};
                                grid-row: {{ i &#43; 1 }};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Grid content --&gt;
                    &lt;div class=&#34;cell&#34;
                         ng-repeat=&#34;(i,e) in results&#34;
                         ng-class=&#34;{&#39;orange&#39;: e.count &gt; 150, &#39;lightgreen&#39;: e.count &gt; 100 &amp;&amp; e.count &lt;= 150,&#39;darkgreen&#39;: e.count &lt; 100}&#34;
                         style=&#34;grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};
                                grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};&#34;&gt;
                        {{e.count | number : 0}}
                    &lt;/div&gt;
                &lt;/div&gt;

                &lt;div class=&#34;heatmap-sub row&#34;&gt;
                    &lt;div class=&#34;col-sm-6&#34;&gt;
                        &lt;div class=&#34;heatmap-switch&#34;&gt;
                            &lt;p&gt;Display values: &lt;/p&gt;
                            &lt;label class=&#34;switch&#34;&gt;
                                &lt;input class=&#34;switch-input&#34;
                                       ng-model=&#34;variables.displayvalues&#34;
                                       type=&#34;checkbox&#34;&gt;
                                &lt;div class=&#34;switch-button&#34;&gt;
                                    &lt;span class=&#34;switch-button-left&#34;&gt;OFF&lt;/span&gt;
                                    &lt;span class=&#34;switch-button-right&#34;&gt;ON&lt;/span&gt;
                                &lt;/div&gt;
                            &lt;/label&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&#34;col-sm-6&#34;&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/ods-dataset-context&gt;
&lt;/div&gt;

</code></pre>
                </div>
            </div>
            
            <div class="js-tabcontent"
                 id="code-heatmap-with-static-scale-css-content"
                 data-clipboard="/* cells colors */
.orange {
    background-color: orange;
}

.darkgreen {
    background-color: #6ca474;
}

.mediumgreen {
    background-color: #9ab932;
}

.lightgreen {
    background-color: #b0c313;
}

:root {
    --values-color: white;
}

.heatmap {
    display: grid;
    gap: 2px;
    grid-auto-columns: 1fr;
    grid-auto-flow: column;
    grid-auto-rows: auto;
    /* full auto, adapt to the content, ie the font size */
}
.heatmap &gt; * {
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    font-size: 0.8rem;
}
.heatmap.display-values .cell {
    font-size: 0.6rem;
}
.heatmap .cell {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    color: var(--values-color);
    font-size: 0;
}
.heatmap .cell:hover {
    border: 1px solid var(--values-color);
    transform: scale(1.5);
    font-size: 0.6rem;
    z-index: 1;
}
.heatmap .cell.square:before {
    content: &#34;&#34;;
    display: block;
    padding-bottom: 100%;
}
.heatmap .cell .round {
    border-radius: 100%;
    border: 1px solid black;
    display: flex;
    justify-content: center;
    align-items: center;
}

.x-axis-centered {
    text-align: center;
}
.x-axis-rotate {
    transform: rotate(-60deg);
    padding: 35% 0;
}

.heatmap-sub {
    margin-top: 13px;
}

.heatmap-legend {
    display: flex;
    width: 100%;
    justify-content: space-between;
    align-items: center;
}
.heatmap-legend .heatmap-legend__gradient {
    display: block;
    height: 25px;
    width: 100%;
    margin: 0 6px;
    border: 1px solid darkgray;
}

.heatmap-switch {
    display: flex;
    align-items: baseline;
}
.heatmap-switch .switch {
    margin-left: 6px;
}

/* Button Group Switch
   ========================================================================== */
.switch {
    display: inline-block;
}

.switch-button {
    /* background and border when in &#34;off&#34; state */
    background: var(--highlight);
    border: 2px solid var(--highlight);
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-radius: 6px;
    color: #FFFFFF;
    position: relative;
    cursor: pointer;
    outline: 0;
    user-select: none;
}

.switch-input:not(:checked) &#43; .switch-button .switch-button-left {
    /* text color when in &#34;off&#34; state */
    color: var(--highlight);
}

.switch-input {
    display: none;
}

.switch-button span {
    font-size: 0.8rem;
    padding: 0.2rem 0.7rem;
    text-align: center;
    z-index: 2;
    color: #FFFFFF;
    transition: color 0.2s;
}

.switch-button::before {
    content: &#34;&#34;;
    position: absolute;
    background-color: #FFFFFF;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    border-radius: 4px;
    top: 0;
    left: 0;
    height: 100%;
    width: 50%;
    z-index: 1;
    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;
}

.switch-button:hover::before {
    will-change: padding;
}

.switch-button:active::before {
    padding-right: 0.4rem;
}

/* &#34;On&#34; state
   ========================== */
.switch-input:checked &#43; .switch-button {
    /* background and border when in &#34;on&#34; state */
    background-color: var(--links);
    border-color: var(--links);
}

.switch-input:checked &#43; .switch-button .switch-button-right {
    /* text color when in &#34;on&#34; state */
    color: var(--links);
}

.switch-input:checked &#43; .switch-button::before {
    left: 50%;
}

.switch-input:checked &#43; .switch-button:active::before {
    margin-left: -0.4rem;
}

/* Checkbox in disabled state
   ========================== */
.switch-input[type=checkbox]:disabled &#43; .switch-button {
    opacity: 0.6;
    cursor: not-allowed;
}">
                <div class="highlight">
                    <pre class="language-css" data-lang="css"><code>/* cells colors */
.orange {
    background-color: orange;
}

.darkgreen {
    background-color: #6ca474;
}

.mediumgreen {
    background-color: #9ab932;
}

.lightgreen {
    background-color: #b0c313;
}

:root {
    --values-color: white;
}

.heatmap {
    display: grid;
    gap: 2px;
    grid-auto-columns: 1fr;
    grid-auto-flow: column;
    grid-auto-rows: auto;
    /* full auto, adapt to the content, ie the font size */
}
.heatmap &gt; * {
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    font-size: 0.8rem;
}
.heatmap.display-values .cell {
    font-size: 0.6rem;
}
.heatmap .cell {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    color: var(--values-color);
    font-size: 0;
}
.heatmap .cell:hover {
    border: 1px solid var(--values-color);
    transform: scale(1.5);
    font-size: 0.6rem;
    z-index: 1;
}
.heatmap .cell.square:before {
    content: &#34;&#34;;
    display: block;
    padding-bottom: 100%;
}
.heatmap .cell .round {
    border-radius: 100%;
    border: 1px solid black;
    display: flex;
    justify-content: center;
    align-items: center;
}

.x-axis-centered {
    text-align: center;
}
.x-axis-rotate {
    transform: rotate(-60deg);
    padding: 35% 0;
}

.heatmap-sub {
    margin-top: 13px;
}

.heatmap-legend {
    display: flex;
    width: 100%;
    justify-content: space-between;
    align-items: center;
}
.heatmap-legend .heatmap-legend__gradient {
    display: block;
    height: 25px;
    width: 100%;
    margin: 0 6px;
    border: 1px solid darkgray;
}

.heatmap-switch {
    display: flex;
    align-items: baseline;
}
.heatmap-switch .switch {
    margin-left: 6px;
}

/* Button Group Switch
   ========================================================================== */
.switch {
    display: inline-block;
}

.switch-button {
    /* background and border when in &#34;off&#34; state */
    background: var(--highlight);
    border: 2px solid var(--highlight);
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-radius: 6px;
    color: #FFFFFF;
    position: relative;
    cursor: pointer;
    outline: 0;
    user-select: none;
}

.switch-input:not(:checked) &#43; .switch-button .switch-button-left {
    /* text color when in &#34;off&#34; state */
    color: var(--highlight);
}

.switch-input {
    display: none;
}

.switch-button span {
    font-size: 0.8rem;
    padding: 0.2rem 0.7rem;
    text-align: center;
    z-index: 2;
    color: #FFFFFF;
    transition: color 0.2s;
}

.switch-button::before {
    content: &#34;&#34;;
    position: absolute;
    background-color: #FFFFFF;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    border-radius: 4px;
    top: 0;
    left: 0;
    height: 100%;
    width: 50%;
    z-index: 1;
    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;
}

.switch-button:hover::before {
    will-change: padding;
}

.switch-button:active::before {
    padding-right: 0.4rem;
}

/* &#34;On&#34; state
   ========================== */
.switch-input:checked &#43; .switch-button {
    /* background and border when in &#34;on&#34; state */
    background-color: var(--links);
    border-color: var(--links);
}

.switch-input:checked &#43; .switch-button .switch-button-right {
    /* text color when in &#34;on&#34; state */
    color: var(--links);
}

.switch-input:checked &#43; .switch-button::before {
    left: 50%;
}

.switch-input:checked &#43; .switch-button:active::before {
    margin-left: -0.4rem;
}

/* Checkbox in disabled state
   ========================== */
.switch-input[type=checkbox]:disabled &#43; .switch-button {
    opacity: 0.6;
    cursor: not-allowed;
}</code></pre>
                </div>
            </div>
            
        </div>
    </div>
</div>

      </div>
    </article>
    
    <article class="block">
      <h2 class="title is-2" id="bubblemap-with-static-scale">
        Bubblemap with static scale 
        <a class="is-link anchor" href="#bubblemap-with-static-scale">
          <span class="icon">
            <img src="/img/fas-link.svg" />
          </span>
        </a>
      </h2>
      <div class="content">
        <p>X and Y CSS axis might need to be adapted depending on the value and its length.</p>

      </div>
      
      <div class="box">
        






    




<div class="codepen">
    <form id="form-bubblemap-with-static-scale"
          action="https://codepen.io/pen/define"
          method="POST"
          target="_blank">
        <input type="hidden"
               name="data"
               value='{
                 "title": "New Pen!",
                 "head": &#34;\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css\&#34;\n/\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\&#34;\n/\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.css\&#34;\n/\u003e\n\n\u003c!-- ODS Platform CSS - must be hosted on static : WIP --\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://s3-us-west-2.amazonaws.com/s.cdpn.io/4124551/ods.css\&#34;\n/\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://codelibrary.opendatasoft.com/css/theme.css\&#34;\n/\u003e\n\n\u003cscript src=\&#34;//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js\&#34;\u003e\u003c/script\u003e\n\u003cscript src=\&#34;//cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.js\&#34;\u003e\u003c/script\u003e\n\u003cscript src=\&#34;//cdnjs.cloudflare.com/ajax/libs/angular-sanitize/1.8.2/angular-sanitize.min.js\&#34;\u003e\u003c/script\u003e\n\u003cscript\n  type=\&#34;text/javascript\&#34;\n  src=\&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.js\&#34;\n\u003e\u003c/script\u003e\n\n\u003cscript\n  type=\&#34;text/javascript\&#34;\n  src=\&#34;https://codelibrary.opendatasoft.com/js/platform-filters.js\&#34;\n\u003e\u003c/script\u003e\n\u003cscript\n  type=\&#34;text/javascript\&#34;\n  src=\&#34;https://codelibrary.opendatasoft.com/js/ods-catalog-card.js\&#34;\n\u003e\u003c/script\u003e\n\n\u003cscript type=\&#34;text/javascript\&#34;\u003e\n  const sourceMonitoringInterceptor = $q =\u003e {\n    return {\n      request: config =\u003e {\n        if (config.params)\n          if (config.params.source) delete config.params.source;\n\n        config.url = config.url.replace(\n          \&#34;ods-api-monitoring\&#34;,\n          \&#34;monitoring-copy\&#34;\n        );\n        return config;\n      }\n    };\n  };\n\n  angular\n    .module(\&#34;ods-widgets\&#34;)\n    .config(function(ODSWidgetsConfigProvider, $httpProvider) {\n      ODSWidgetsConfigProvider.setConfig({\n        defaultDomain: \&#34;https://userclub.opendatasoft.com/\&#34;,\n        basemaps: [\n          {\n            provider: \&#34;jawg.light\&#34;,\n            label: \&#34;Jawg Light\&#34;,\n            jawg_apikey: \&#34;opendatasoft-community\&#34;\n          },\n          {\n            provider: \&#34;jawg.streets\&#34;,\n            label: \&#34;Jawg Streets\&#34;,\n            jawg_apikey: \&#34;opendatasoft-community\&#34;,\n            id: \&#34;streets\&#34;\n          }\n        ],\n        themes: {\n          default: {\n            url: \&#34;/img/ods.svg\&#34;\n          },\n          Santé: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/doctors.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Culture, Patrimoine\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/culture.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Éducation, Formation, Recherche, Enseignement\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/college.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          Environment: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/leaf.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Transports, Déplacements\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/train_station.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Aménagement du territoire, Urbanisme, Bâtiments, Équipements, Logement\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/townplanning.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Économie, Business, PME, Développement économique, Emploi\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/economy.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Administration, Gouvernement, Finances publiques, Citoyenneté\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/administration.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Justice, Sécurité, Police, Crime\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/court.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Sport, Loisirs\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/soccer.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Hébergement, Restauration\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/accommodation.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Services, Social\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/social.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          Checklist: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/copyshop.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          Usages: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/bike.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          }\n        },\n        mapPrependAttribution: \&#34;Jawg apikey NOT suitable for production\&#34;\n      });\n      $httpProvider.interceptors.push(sourceMonitoringInterceptor);\n    });\n\u003c/script\u003e\n&#34;,
                 "editors": 110,
                 "html": &#34;\u003cdiv ng-app=\&#34;ods-widgets\&#34;\u003e\n\u003cdiv class=\&#34;container\&#34;\u003e\n    \u003cods-dataset-context context=\&#34;datum\&#34;\n                         datum-dataset=\&#34;comptage-velo-donnees-compteurs\&#34;\n                         datum-parameters=\&#34;{&#39;q&#39;:&#39;totem&#39;}\&#34;\u003e\n        \u003cdiv ng-init=\&#34;variables = {};\n                      xaxis = &#39;nom_compteur&#39;;\n                      yaxis = &#39;year&#39;;\n                      yLegendWidth = 1\&#34;\u003e\n            \u003ch3\u003eAverage number of cyclists by counting totem\u003c/h3\u003e\n\n            \u003cdiv ods-adv-analysis=\&#34;results\&#34;\n                 ods-adv-analysis-context=\&#34;datum\&#34;\n                 ods-adv-analysis-select=\&#34;avg(sum_counts) as count\&#34;\n                 ods-adv-analysis-group-by=\&#34;year(date) as {{ yaxis }}, {{ xaxis }}\&#34;\u003e\n                {{\n                variables.numrow = (results | toObject:yaxis | numKeys) ;\n                variables.numcol = (results | toObject:xaxis | numKeys) ;\n                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;\n                variables.listcol = (results | toObject:xaxis | keys | orderBy) ; \&#34;\&#34;}}\n\n                \u003c!--\n                                    To compute color ranges and bubble size lateron, you need to get the min and max values from the analysis\n                                    this block list all values, and store the min and max in variables each time it finds a new one.\n                                --\u003e\n                \u003cspan ng-repeat=\&#34;res in results\&#34;\u003e\n                    {{ variables.min = (!variables.min || res.count \u003c variables.min ? res.count : variables.min); &#39;&#39; }}\n                    {{ variables.max = (!variables.max || res.count \u003e variables.max ? res.count : variables.max); &#39;&#39; }}\n                \u003c/span\u003e\n\n                \u003c!-- the grid --\u003e\n                \u003cdiv class=\&#34;bubblemap\&#34;\n                     ng-class=\&#34;{&#39;display-values&#39;: variables.displayvalues}\&#34;\u003e\n\n                    \u003c!-- X axis : (bottom horizontal) list all values and set the correct position --\u003e\n                    \u003cdiv class=\&#34;x-axis-centered x-axis-rotate\&#34;\n                         ng-repeat=\&#34;(i,e) in variables.listcol\&#34;\n                         style=\&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;\n                                grid-row: {{variables.numrow &#43; 1}};\&#34;\u003e\n                        \u003cstrong\u003e{{e}}\u003c/strong\u003e\n                    \u003c/div\u003e\n\n                    \u003c!-- Y axis : (left vertical) list all values and set the correct position --\u003e\n                    \u003cdiv ng-repeat=\&#34;(i,e) in variables.listrow\&#34;\n                         class=\&#34;y-axis\&#34;\n                         style=\&#34;grid-column: 1 / span {{ yLegendWidth }};\n                                grid-row: {{ i &#43; 1 }};\&#34;\u003e\n                        \u003cstrong\u003e{{e}}\u003c/strong\u003e\n                    \u003c/div\u003e\n\n                    \u003c!-- Grid content --\u003e\n                    \u003cdiv class=\&#34;cell square\&#34;\n                         ng-repeat=\&#34;e in results\&#34;\n                         style=\&#34;grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};\n                                grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};\&#34;\u003e\n                        \u003cdiv class=\&#34;round\&#34;\n                             ng-class=\&#34;{&#39;orange&#39;: e.count \u003e 150, &#39;lightgreen&#39;: e.count \u003e 100 \u0026\u0026 e.count \u003c= 150,&#39;darkgreen&#39;: e.count \u003c 100}\&#34;\n                             style=\&#34;width : {{ ((e.count | math : &#39;sqrt&#39;)/(variables.max|math:&#39;sqrt&#39;))*100 }}%;\n                                    height : {{ ((e.count | math : &#39;sqrt&#39;)/(variables.max|math:&#39;sqrt&#39;))*100 }}%;\n                             ods-tooltip=\&#34; {{e.count | number}}\n                        \&#34;\u003e\n                        {{e.count | number : 0}}\n                    \u003c/div\u003e\n                \u003c/div\u003e\n            \u003c/div\u003e\n\n        \u003c/div\u003e\n\u003c/div\u003e\n\u003c/ods-dataset-context\u003e\n\u003c/div\u003e\n\n\u003c/div\u003e&#34;,
                 "css": &#34;/* cells colors */\n.orange {\n    background-color: orange;\n}\n\n.darkgreen {\n    background-color: #6ca474;\n}\n\n.mediumgreen {\n    background-color: #9ab932;\n}\n\n.lightgreen {\n    background-color: #b0c313;\n}\n\n:root {\n    --values-color: white;\n}\n\n.bubblemap {\n    display: grid;\n    grid-auto-columns: 1fr;\n    grid-auto-flow: column;\n    grid-auto-rows: auto;\n    /* full auto, adapt to the content, ie the font size */\n}\n.bubblemap \u003e * {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    overflow: hidden;\n    font-size: 0.8rem;\n}\n.bubblemap.display-values .cell {\n    font-size: 0.6rem;\n}\n.bubblemap .cell {\n    position: relative;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    overflow: hidden;\n    color: var(--values-color);\n    font-size: 0;\n}\n.bubblemap .cell:hover {\n    transform: scale(1.2);\n    font-size: 0.6rem;\n    z-index: 1;\n}\n.bubblemap .cell.square:before {\n    content: \&#34;\&#34;;\n    display: block;\n    padding-bottom: 100%;\n}\n.bubblemap .cell .round {\n    border-radius: 100%;\n    border: 1px solid black;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.x-axis-centered {\n    text-align: center;\n}\n.x-axis-rotate {\n    transform: rotate(-60deg);\n    padding: 35% 0;\n}\n\n.bubblemap-sub {\n    margin-top: 13px;\n}\n\n.bubblemap-legend {\n    display: flex;\n    width: 100%;\n    justify-content: space-between;\n    align-items: center;\n}\n.bubblemap-legend .bubblemap-legend__gradient {\n    display: block;\n    height: 25px;\n    width: 100%;\n    margin: 0 6px;\n    border: 1px solid darkgray;\n}\n\n.bubblemap-switch {\n    display: flex;\n    align-items: baseline;\n}\n.bubblemap-switch .switch {\n    margin-left: 6px;\n}\n\n/* Button Group Switch\n   ========================================================================== */\n.switch {\n    display: inline-block;\n}\n\n.switch-button {\n    /* background and border when in \&#34;off\&#34; state */\n    background: var(--highlight);\n    border: 2px solid var(--highlight);\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    border-radius: 6px;\n    color: #FFFFFF;\n    position: relative;\n    cursor: pointer;\n    outline: 0;\n    user-select: none;\n}\n\n.switch-input:not(:checked) &#43; .switch-button .switch-button-left {\n    /* text color when in \&#34;off\&#34; state */\n    color: var(--highlight);\n}\n\n.switch-input {\n    display: none;\n}\n\n.switch-button span {\n    font-size: 0.8rem;\n    padding: 0.2rem 0.7rem;\n    text-align: center;\n    z-index: 2;\n    color: #FFFFFF;\n    transition: color 0.2s;\n}\n\n.switch-button::before {\n    content: \&#34;\&#34;;\n    position: absolute;\n    background-color: #FFFFFF;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);\n    border-radius: 4px;\n    top: 0;\n    left: 0;\n    height: 100%;\n    width: 50%;\n    z-index: 1;\n    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;\n}\n\n.switch-button:hover::before {\n    will-change: padding;\n}\n\n.switch-button:active::before {\n    padding-right: 0.4rem;\n}\n\n/* \&#34;On\&#34; state\n   ========================== */\n.switch-input:checked &#43; .switch-button {\n    /* background and border when in \&#34;on\&#34; state */\n    background-color: var(--links);\n    border-color: var(--links);\n}\n\n.switch-input:checked &#43; .switch-button .switch-button-right {\n    /* text color when in \&#34;on\&#34; state */\n    color: var(--links);\n}\n\n.switch-input:checked &#43; .switch-button::before {\n    left: 50%;\n}\n\n.switch-input:checked &#43; .switch-button:active::before {\n    margin-left: -0.4rem;\n}\n\n/* Checkbox in disabled state\n   ========================== */\n.switch-input[type=checkbox]:disabled &#43; .switch-button {\n    opacity: 0.6;\n    cursor: not-allowed;\n}&#34;
               }'>
    </form>
</div>
<div class="ods-content">
    <div class="box-live-example"
      style="height: 550px;">
      <iframe id="iframe-bubblemap-with-static-scale"
              width="100%" height="100%"
              src="about:blank"
              srcdoc="
                <head>&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css&#34;
/&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css&#34;
/&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.css&#34;
/&gt;

&lt;!-- ODS Platform CSS - must be hosted on static : WIP --&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://s3-us-west-2.amazonaws.com/s.cdpn.io/4124551/ods.css&#34;
/&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://codelibrary.opendatasoft.com/css/theme.css&#34;
/&gt;

&lt;script src=&#34;//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;//cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;//cdnjs.cloudflare.com/ajax/libs/angular-sanitize/1.8.2/angular-sanitize.min.js&#34;&gt;&lt;/script&gt;
&lt;script
  type=&#34;text/javascript&#34;
  src=&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.js&#34;
&gt;&lt;/script&gt;

&lt;script
  type=&#34;text/javascript&#34;
  src=&#34;https://codelibrary.opendatasoft.com/js/platform-filters.js&#34;
&gt;&lt;/script&gt;
&lt;script
  type=&#34;text/javascript&#34;
  src=&#34;https://codelibrary.opendatasoft.com/js/ods-catalog-card.js&#34;
&gt;&lt;/script&gt;

&lt;script type=&#34;text/javascript&#34;&gt;
  const sourceMonitoringInterceptor = $q =&gt; {
    return {
      request: config =&gt; {
        if (config.params)
          if (config.params.source) delete config.params.source;

        config.url = config.url.replace(
          &#34;ods-api-monitoring&#34;,
          &#34;monitoring-copy&#34;
        );
        return config;
      }
    };
  };

  angular
    .module(&#34;ods-widgets&#34;)
    .config(function(ODSWidgetsConfigProvider, $httpProvider) {
      ODSWidgetsConfigProvider.setConfig({
        defaultDomain: &#34;https://userclub.opendatasoft.com/&#34;,
        basemaps: [
          {
            provider: &#34;jawg.light&#34;,
            label: &#34;Jawg Light&#34;,
            jawg_apikey: &#34;opendatasoft-community&#34;
          },
          {
            provider: &#34;jawg.streets&#34;,
            label: &#34;Jawg Streets&#34;,
            jawg_apikey: &#34;opendatasoft-community&#34;,
            id: &#34;streets&#34;
          }
        ],
        themes: {
          default: {
            url: &#34;/img/ods.svg&#34;
          },
          Santé: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/doctors.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Culture, Patrimoine&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/culture.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Éducation, Formation, Recherche, Enseignement&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/college.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          Environment: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/leaf.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Transports, Déplacements&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/train_station.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Aménagement du territoire, Urbanisme, Bâtiments, Équipements, Logement&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/townplanning.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Économie, Business, PME, Développement économique, Emploi&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/economy.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Administration, Gouvernement, Finances publiques, Citoyenneté&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/administration.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Justice, Sécurité, Police, Crime&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/court.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Sport, Loisirs&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/soccer.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Hébergement, Restauration&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/accommodation.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Services, Social&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/social.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          Checklist: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/copyshop.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          Usages: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/bike.svg&#34;,
            color: &#34;#1446A0&#34;
          }
        },
        mapPrependAttribution: &#34;Jawg apikey NOT suitable for production&#34;
      });
      $httpProvider.interceptors.push(sourceMonitoringInterceptor);
    });
&lt;/script&gt;
</head>
                <base href='https://userclub.opendatasoft.com/'>
                <body>
                <div ng-app='ods-widgets'>&lt;div ng-app=&#34;ods-widgets&#34;&gt;
&lt;div class=&#34;container&#34;&gt;
    &lt;ods-dataset-context context=&#34;datum&#34;
                         datum-dataset=&#34;comptage-velo-donnees-compteurs&#34;
                         datum-parameters=&#34;{&#39;q&#39;:&#39;totem&#39;}&#34;&gt;
        &lt;div ng-init=&#34;variables = {};
                      xaxis = &#39;nom_compteur&#39;;
                      yaxis = &#39;year&#39;;
                      yLegendWidth = 1&#34;&gt;
            &lt;h3&gt;Average number of cyclists by counting totem&lt;/h3&gt;

            &lt;div ods-adv-analysis=&#34;results&#34;
                 ods-adv-analysis-context=&#34;datum&#34;
                 ods-adv-analysis-select=&#34;avg(sum_counts) as count&#34;
                 ods-adv-analysis-group-by=&#34;year(date) as {{ yaxis }}, {{ xaxis }}&#34;&gt;
                {{
                variables.numrow = (results | toObject:yaxis | numKeys) ;
                variables.numcol = (results | toObject:xaxis | numKeys) ;
                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;
                variables.listcol = (results | toObject:xaxis | keys | orderBy) ; &#34;&#34;}}

                &lt;!--
                                    To compute color ranges and bubble size lateron, you need to get the min and max values from the analysis
                                    this block list all values, and store the min and max in variables each time it finds a new one.
                                --&gt;
                &lt;span ng-repeat=&#34;res in results&#34;&gt;
                    {{ variables.min = (!variables.min || res.count &lt; variables.min ? res.count : variables.min); &#39;&#39; }}
                    {{ variables.max = (!variables.max || res.count &gt; variables.max ? res.count : variables.max); &#39;&#39; }}
                &lt;/span&gt;

                &lt;!-- the grid --&gt;
                &lt;div class=&#34;bubblemap&#34;
                     ng-class=&#34;{&#39;display-values&#39;: variables.displayvalues}&#34;&gt;

                    &lt;!-- X axis : (bottom horizontal) list all values and set the correct position --&gt;
                    &lt;div class=&#34;x-axis-centered x-axis-rotate&#34;
                         ng-repeat=&#34;(i,e) in variables.listcol&#34;
                         style=&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;
                                grid-row: {{variables.numrow &#43; 1}};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Y axis : (left vertical) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listrow&#34;
                         class=&#34;y-axis&#34;
                         style=&#34;grid-column: 1 / span {{ yLegendWidth }};
                                grid-row: {{ i &#43; 1 }};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Grid content --&gt;
                    &lt;div class=&#34;cell square&#34;
                         ng-repeat=&#34;e in results&#34;
                         style=&#34;grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};
                                grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};&#34;&gt;
                        &lt;div class=&#34;round&#34;
                             ng-class=&#34;{&#39;orange&#39;: e.count &gt; 150, &#39;lightgreen&#39;: e.count &gt; 100 &amp;&amp; e.count &lt;= 150,&#39;darkgreen&#39;: e.count &lt; 100}&#34;
                             style=&#34;width : {{ ((e.count | math : &#39;sqrt&#39;)/(variables.max|math:&#39;sqrt&#39;))*100 }}%;
                                    height : {{ ((e.count | math : &#39;sqrt&#39;)/(variables.max|math:&#39;sqrt&#39;))*100 }}%;
                             ods-tooltip=&#34; {{e.count | number}}
                        &#34;&gt;
                        {{e.count | number : 0}}
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;

        &lt;/div&gt;
&lt;/div&gt;
&lt;/ods-dataset-context&gt;
&lt;/div&gt;

&lt;/div&gt;</div>
                <style type='text/css'>
                    /* cells colors */
.orange {
    background-color: orange;
}

.darkgreen {
    background-color: #6ca474;
}

.mediumgreen {
    background-color: #9ab932;
}

.lightgreen {
    background-color: #b0c313;
}

:root {
    --values-color: white;
}

.bubblemap {
    display: grid;
    grid-auto-columns: 1fr;
    grid-auto-flow: column;
    grid-auto-rows: auto;
    /* full auto, adapt to the content, ie the font size */
}
.bubblemap &gt; * {
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    font-size: 0.8rem;
}
.bubblemap.display-values .cell {
    font-size: 0.6rem;
}
.bubblemap .cell {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    color: var(--values-color);
    font-size: 0;
}
.bubblemap .cell:hover {
    transform: scale(1.2);
    font-size: 0.6rem;
    z-index: 1;
}
.bubblemap .cell.square:before {
    content: &#34;&#34;;
    display: block;
    padding-bottom: 100%;
}
.bubblemap .cell .round {
    border-radius: 100%;
    border: 1px solid black;
    display: flex;
    justify-content: center;
    align-items: center;
}

.x-axis-centered {
    text-align: center;
}
.x-axis-rotate {
    transform: rotate(-60deg);
    padding: 35% 0;
}

.bubblemap-sub {
    margin-top: 13px;
}

.bubblemap-legend {
    display: flex;
    width: 100%;
    justify-content: space-between;
    align-items: center;
}
.bubblemap-legend .bubblemap-legend__gradient {
    display: block;
    height: 25px;
    width: 100%;
    margin: 0 6px;
    border: 1px solid darkgray;
}

.bubblemap-switch {
    display: flex;
    align-items: baseline;
}
.bubblemap-switch .switch {
    margin-left: 6px;
}

/* Button Group Switch
   ========================================================================== */
.switch {
    display: inline-block;
}

.switch-button {
    /* background and border when in &#34;off&#34; state */
    background: var(--highlight);
    border: 2px solid var(--highlight);
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-radius: 6px;
    color: #FFFFFF;
    position: relative;
    cursor: pointer;
    outline: 0;
    user-select: none;
}

.switch-input:not(:checked) &#43; .switch-button .switch-button-left {
    /* text color when in &#34;off&#34; state */
    color: var(--highlight);
}

.switch-input {
    display: none;
}

.switch-button span {
    font-size: 0.8rem;
    padding: 0.2rem 0.7rem;
    text-align: center;
    z-index: 2;
    color: #FFFFFF;
    transition: color 0.2s;
}

.switch-button::before {
    content: &#34;&#34;;
    position: absolute;
    background-color: #FFFFFF;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    border-radius: 4px;
    top: 0;
    left: 0;
    height: 100%;
    width: 50%;
    z-index: 1;
    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;
}

.switch-button:hover::before {
    will-change: padding;
}

.switch-button:active::before {
    padding-right: 0.4rem;
}

/* &#34;On&#34; state
   ========================== */
.switch-input:checked &#43; .switch-button {
    /* background and border when in &#34;on&#34; state */
    background-color: var(--links);
    border-color: var(--links);
}

.switch-input:checked &#43; .switch-button .switch-button-right {
    /* text color when in &#34;on&#34; state */
    color: var(--links);
}

.switch-input:checked &#43; .switch-button::before {
    left: 50%;
}

.switch-input:checked &#43; .switch-button:active::before {
    margin-left: -0.4rem;
}

/* Checkbox in disabled state
   ========================== */
.switch-input[type=checkbox]:disabled &#43; .switch-button {
    opacity: 0.6;
    cursor: not-allowed;
}
                </style>
                </body>
              ">
      </iframe>
      <div class="show-code buttons has-addons">
          <button class="button is-light">
            <span>Show code</span>
          </button>
          <button class="button is-light"
             target="_blank"
             aria-role="link"
             rel="noopener"
             title="Edit on CodePen, open a new tab"
             onclick="document.getElementById('form-bubblemap-with-static-scale').submit()">
              <span>Edit on Codepen</span>
              <span class="icon is-small">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                  <use xlink:href="#external"></use>
                </svg>
              </span>
          </button>
      </div>
    </div>
    <div class="box-code js-tabs is-hidden">
        <nav class="level is-mobile">
            <div class="level-left">
                <div class="level-item">
                    <div class="buttons has-addons js-tablist">
                        <a
                          class="button is-primary is-outlined js-tablist__item js-tablist__link"
                          href="#code-bubblemap-with-static-scale-html-content"
                        >
                          HTML
                        </a>
                        
                        <a
                          class="button is-primary is-outlined js-tablist__item js-tablist__link"
                          href="#code-bubblemap-with-static-scale-css-content"
                        >
                          CSS
                        </a>
                        
                    </div>
                </div>
            </div>
            <div class="level-right">
                <button class="copy-to-cc button is-primary is-outlined is-rounded has-tooltip-left"
                  data-tooltip="Copy to clipboard"
                  aria-role="button"
                  title="Edit on CodePen, open a new tab"
                >
                  <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                      <use xlink:href="#copy"></use>
                    </svg>
                  </span>
                </button>
                <button class="copied-to-cc button is-success is-outlined is-rounded has-tooltip-left is-hidden"
                  data-tooltip="Copied"
                  aria-role="button"
                  title="Copied"
                >
                  <figure class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                      <use xlink:href="#check"></use>
                    </svg>
                  </figure>
                </button>
            </div>
        </nav>
        <div class="tab-content">
            <div class="js-tabcontent"
                 id="code-bubblemap-with-static-scale-html-content"
                 data-clipboard="&lt;div class=&#34;container&#34;&gt;
    &lt;ods-dataset-context context=&#34;datum&#34;
                         datum-dataset=&#34;comptage-velo-donnees-compteurs&#34;
                         datum-parameters=&#34;{&#39;q&#39;:&#39;totem&#39;}&#34;&gt;
        &lt;div ng-init=&#34;variables = {};
                      xaxis = &#39;nom_compteur&#39;;
                      yaxis = &#39;year&#39;;
                      yLegendWidth = 1&#34;&gt;
            &lt;h3&gt;Average number of cyclists by counting totem&lt;/h3&gt;

            &lt;div ods-adv-analysis=&#34;results&#34;
                 ods-adv-analysis-context=&#34;datum&#34;
                 ods-adv-analysis-select=&#34;avg(sum_counts) as count&#34;
                 ods-adv-analysis-group-by=&#34;year(date) as {{ yaxis }}, {{ xaxis }}&#34;&gt;
                {{
                variables.numrow = (results | toObject:yaxis | numKeys) ;
                variables.numcol = (results | toObject:xaxis | numKeys) ;
                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;
                variables.listcol = (results | toObject:xaxis | keys | orderBy) ; &#34;&#34;}}

                &lt;!--
                                    To compute color ranges and bubble size lateron, you need to get the min and max values from the analysis
                                    this block list all values, and store the min and max in variables each time it finds a new one.
                                --&gt;
                &lt;span ng-repeat=&#34;res in results&#34;&gt;
                    {{ variables.min = (!variables.min || res.count &lt; variables.min ? res.count : variables.min); &#39;&#39; }}
                    {{ variables.max = (!variables.max || res.count &gt; variables.max ? res.count : variables.max); &#39;&#39; }}
                &lt;/span&gt;

                &lt;!-- the grid --&gt;
                &lt;div class=&#34;bubblemap&#34;
                     ng-class=&#34;{&#39;display-values&#39;: variables.displayvalues}&#34;&gt;

                    &lt;!-- X axis : (bottom horizontal) list all values and set the correct position --&gt;
                    &lt;div class=&#34;x-axis-centered x-axis-rotate&#34;
                         ng-repeat=&#34;(i,e) in variables.listcol&#34;
                         style=&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;
                                grid-row: {{variables.numrow &#43; 1}};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Y axis : (left vertical) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listrow&#34;
                         class=&#34;y-axis&#34;
                         style=&#34;grid-column: 1 / span {{ yLegendWidth }};
                                grid-row: {{ i &#43; 1 }};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Grid content --&gt;
                    &lt;div class=&#34;cell square&#34;
                         ng-repeat=&#34;e in results&#34;
                         style=&#34;grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};
                                grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};&#34;&gt;
                        &lt;div class=&#34;round&#34;
                             ng-class=&#34;{&#39;orange&#39;: e.count &gt; 150, &#39;lightgreen&#39;: e.count &gt; 100 &amp;&amp; e.count &lt;= 150,&#39;darkgreen&#39;: e.count &lt; 100}&#34;
                             style=&#34;width : {{ ((e.count | math : &#39;sqrt&#39;)/(variables.max|math:&#39;sqrt&#39;))*100 }}%;
                                    height : {{ ((e.count | math : &#39;sqrt&#39;)/(variables.max|math:&#39;sqrt&#39;))*100 }}%;
                             ods-tooltip=&#34; {{e.count | number}}
                        &#34;&gt;
                        {{e.count | number : 0}}
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;

        &lt;/div&gt;
&lt;/div&gt;
&lt;/ods-dataset-context&gt;
&lt;/div&gt;

"
                 role="tabpanel">
                <div class="highlight">
                    <pre class="language-html" data-lang="html"><code>&lt;div class=&#34;container&#34;&gt;
    &lt;ods-dataset-context context=&#34;datum&#34;
                         datum-dataset=&#34;comptage-velo-donnees-compteurs&#34;
                         datum-parameters=&#34;{&#39;q&#39;:&#39;totem&#39;}&#34;&gt;
        &lt;div ng-init=&#34;variables = {};
                      xaxis = &#39;nom_compteur&#39;;
                      yaxis = &#39;year&#39;;
                      yLegendWidth = 1&#34;&gt;
            &lt;h3&gt;Average number of cyclists by counting totem&lt;/h3&gt;

            &lt;div ods-adv-analysis=&#34;results&#34;
                 ods-adv-analysis-context=&#34;datum&#34;
                 ods-adv-analysis-select=&#34;avg(sum_counts) as count&#34;
                 ods-adv-analysis-group-by=&#34;year(date) as {{ yaxis }}, {{ xaxis }}&#34;&gt;
                {{
                variables.numrow = (results | toObject:yaxis | numKeys) ;
                variables.numcol = (results | toObject:xaxis | numKeys) ;
                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;
                variables.listcol = (results | toObject:xaxis | keys | orderBy) ; &#34;&#34;}}

                &lt;!--
                                    To compute color ranges and bubble size lateron, you need to get the min and max values from the analysis
                                    this block list all values, and store the min and max in variables each time it finds a new one.
                                --&gt;
                &lt;span ng-repeat=&#34;res in results&#34;&gt;
                    {{ variables.min = (!variables.min || res.count &lt; variables.min ? res.count : variables.min); &#39;&#39; }}
                    {{ variables.max = (!variables.max || res.count &gt; variables.max ? res.count : variables.max); &#39;&#39; }}
                &lt;/span&gt;

                &lt;!-- the grid --&gt;
                &lt;div class=&#34;bubblemap&#34;
                     ng-class=&#34;{&#39;display-values&#39;: variables.displayvalues}&#34;&gt;

                    &lt;!-- X axis : (bottom horizontal) list all values and set the correct position --&gt;
                    &lt;div class=&#34;x-axis-centered x-axis-rotate&#34;
                         ng-repeat=&#34;(i,e) in variables.listcol&#34;
                         style=&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;
                                grid-row: {{variables.numrow &#43; 1}};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Y axis : (left vertical) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listrow&#34;
                         class=&#34;y-axis&#34;
                         style=&#34;grid-column: 1 / span {{ yLegendWidth }};
                                grid-row: {{ i &#43; 1 }};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Grid content --&gt;
                    &lt;div class=&#34;cell square&#34;
                         ng-repeat=&#34;e in results&#34;
                         style=&#34;grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};
                                grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};&#34;&gt;
                        &lt;div class=&#34;round&#34;
                             ng-class=&#34;{&#39;orange&#39;: e.count &gt; 150, &#39;lightgreen&#39;: e.count &gt; 100 &amp;&amp; e.count &lt;= 150,&#39;darkgreen&#39;: e.count &lt; 100}&#34;
                             style=&#34;width : {{ ((e.count | math : &#39;sqrt&#39;)/(variables.max|math:&#39;sqrt&#39;))*100 }}%;
                                    height : {{ ((e.count | math : &#39;sqrt&#39;)/(variables.max|math:&#39;sqrt&#39;))*100 }}%;
                             ods-tooltip=&#34; {{e.count | number}}
                        &#34;&gt;
                        {{e.count | number : 0}}
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;

        &lt;/div&gt;
&lt;/div&gt;
&lt;/ods-dataset-context&gt;
&lt;/div&gt;

</code></pre>
                </div>
            </div>
            
            <div class="js-tabcontent"
                 id="code-bubblemap-with-static-scale-css-content"
                 data-clipboard="/* cells colors */
.orange {
    background-color: orange;
}

.darkgreen {
    background-color: #6ca474;
}

.mediumgreen {
    background-color: #9ab932;
}

.lightgreen {
    background-color: #b0c313;
}

:root {
    --values-color: white;
}

.bubblemap {
    display: grid;
    grid-auto-columns: 1fr;
    grid-auto-flow: column;
    grid-auto-rows: auto;
    /* full auto, adapt to the content, ie the font size */
}
.bubblemap &gt; * {
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    font-size: 0.8rem;
}
.bubblemap.display-values .cell {
    font-size: 0.6rem;
}
.bubblemap .cell {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    color: var(--values-color);
    font-size: 0;
}
.bubblemap .cell:hover {
    transform: scale(1.2);
    font-size: 0.6rem;
    z-index: 1;
}
.bubblemap .cell.square:before {
    content: &#34;&#34;;
    display: block;
    padding-bottom: 100%;
}
.bubblemap .cell .round {
    border-radius: 100%;
    border: 1px solid black;
    display: flex;
    justify-content: center;
    align-items: center;
}

.x-axis-centered {
    text-align: center;
}
.x-axis-rotate {
    transform: rotate(-60deg);
    padding: 35% 0;
}

.bubblemap-sub {
    margin-top: 13px;
}

.bubblemap-legend {
    display: flex;
    width: 100%;
    justify-content: space-between;
    align-items: center;
}
.bubblemap-legend .bubblemap-legend__gradient {
    display: block;
    height: 25px;
    width: 100%;
    margin: 0 6px;
    border: 1px solid darkgray;
}

.bubblemap-switch {
    display: flex;
    align-items: baseline;
}
.bubblemap-switch .switch {
    margin-left: 6px;
}

/* Button Group Switch
   ========================================================================== */
.switch {
    display: inline-block;
}

.switch-button {
    /* background and border when in &#34;off&#34; state */
    background: var(--highlight);
    border: 2px solid var(--highlight);
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-radius: 6px;
    color: #FFFFFF;
    position: relative;
    cursor: pointer;
    outline: 0;
    user-select: none;
}

.switch-input:not(:checked) &#43; .switch-button .switch-button-left {
    /* text color when in &#34;off&#34; state */
    color: var(--highlight);
}

.switch-input {
    display: none;
}

.switch-button span {
    font-size: 0.8rem;
    padding: 0.2rem 0.7rem;
    text-align: center;
    z-index: 2;
    color: #FFFFFF;
    transition: color 0.2s;
}

.switch-button::before {
    content: &#34;&#34;;
    position: absolute;
    background-color: #FFFFFF;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    border-radius: 4px;
    top: 0;
    left: 0;
    height: 100%;
    width: 50%;
    z-index: 1;
    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;
}

.switch-button:hover::before {
    will-change: padding;
}

.switch-button:active::before {
    padding-right: 0.4rem;
}

/* &#34;On&#34; state
   ========================== */
.switch-input:checked &#43; .switch-button {
    /* background and border when in &#34;on&#34; state */
    background-color: var(--links);
    border-color: var(--links);
}

.switch-input:checked &#43; .switch-button .switch-button-right {
    /* text color when in &#34;on&#34; state */
    color: var(--links);
}

.switch-input:checked &#43; .switch-button::before {
    left: 50%;
}

.switch-input:checked &#43; .switch-button:active::before {
    margin-left: -0.4rem;
}

/* Checkbox in disabled state
   ========================== */
.switch-input[type=checkbox]:disabled &#43; .switch-button {
    opacity: 0.6;
    cursor: not-allowed;
}">
                <div class="highlight">
                    <pre class="language-css" data-lang="css"><code>/* cells colors */
.orange {
    background-color: orange;
}

.darkgreen {
    background-color: #6ca474;
}

.mediumgreen {
    background-color: #9ab932;
}

.lightgreen {
    background-color: #b0c313;
}

:root {
    --values-color: white;
}

.bubblemap {
    display: grid;
    grid-auto-columns: 1fr;
    grid-auto-flow: column;
    grid-auto-rows: auto;
    /* full auto, adapt to the content, ie the font size */
}
.bubblemap &gt; * {
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    font-size: 0.8rem;
}
.bubblemap.display-values .cell {
    font-size: 0.6rem;
}
.bubblemap .cell {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    color: var(--values-color);
    font-size: 0;
}
.bubblemap .cell:hover {
    transform: scale(1.2);
    font-size: 0.6rem;
    z-index: 1;
}
.bubblemap .cell.square:before {
    content: &#34;&#34;;
    display: block;
    padding-bottom: 100%;
}
.bubblemap .cell .round {
    border-radius: 100%;
    border: 1px solid black;
    display: flex;
    justify-content: center;
    align-items: center;
}

.x-axis-centered {
    text-align: center;
}
.x-axis-rotate {
    transform: rotate(-60deg);
    padding: 35% 0;
}

.bubblemap-sub {
    margin-top: 13px;
}

.bubblemap-legend {
    display: flex;
    width: 100%;
    justify-content: space-between;
    align-items: center;
}
.bubblemap-legend .bubblemap-legend__gradient {
    display: block;
    height: 25px;
    width: 100%;
    margin: 0 6px;
    border: 1px solid darkgray;
}

.bubblemap-switch {
    display: flex;
    align-items: baseline;
}
.bubblemap-switch .switch {
    margin-left: 6px;
}

/* Button Group Switch
   ========================================================================== */
.switch {
    display: inline-block;
}

.switch-button {
    /* background and border when in &#34;off&#34; state */
    background: var(--highlight);
    border: 2px solid var(--highlight);
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-radius: 6px;
    color: #FFFFFF;
    position: relative;
    cursor: pointer;
    outline: 0;
    user-select: none;
}

.switch-input:not(:checked) &#43; .switch-button .switch-button-left {
    /* text color when in &#34;off&#34; state */
    color: var(--highlight);
}

.switch-input {
    display: none;
}

.switch-button span {
    font-size: 0.8rem;
    padding: 0.2rem 0.7rem;
    text-align: center;
    z-index: 2;
    color: #FFFFFF;
    transition: color 0.2s;
}

.switch-button::before {
    content: &#34;&#34;;
    position: absolute;
    background-color: #FFFFFF;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    border-radius: 4px;
    top: 0;
    left: 0;
    height: 100%;
    width: 50%;
    z-index: 1;
    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;
}

.switch-button:hover::before {
    will-change: padding;
}

.switch-button:active::before {
    padding-right: 0.4rem;
}

/* &#34;On&#34; state
   ========================== */
.switch-input:checked &#43; .switch-button {
    /* background and border when in &#34;on&#34; state */
    background-color: var(--links);
    border-color: var(--links);
}

.switch-input:checked &#43; .switch-button .switch-button-right {
    /* text color when in &#34;on&#34; state */
    color: var(--links);
}

.switch-input:checked &#43; .switch-button::before {
    left: 50%;
}

.switch-input:checked &#43; .switch-button:active::before {
    margin-left: -0.4rem;
}

/* Checkbox in disabled state
   ========================== */
.switch-input[type=checkbox]:disabled &#43; .switch-button {
    opacity: 0.6;
    cursor: not-allowed;
}</code></pre>
                </div>
            </div>
            
        </div>
    </div>
</div>

      </div>
    </article>
    
    <article class="block">
      <h2 class="title is-2" id="heatmap-with-dynamic-color-scale">
        Heatmap with dynamic color scale 
        <a class="is-link anchor" href="#heatmap-with-dynamic-color-scale">
          <span class="icon">
            <img src="/img/fas-link.svg" />
          </span>
        </a>
      </h2>
      <div class="content">
        <p>Custom heatmaps or bubblemaps are made of a CSS grid, an <code>ods-adv-analysis</code> and several computations to get the colors and the axis.</p>
<ul>
<li><code>ods-adv-analysis</code> returns the list of values for each axis. You need to adapt the axis <code>id</code> in <code>toObject</code> filter.</li>
<li>The min and max of all aggregation are computed to get the boundaries and will be useful for colors computations.</li>
<li>To display the grid, three computations are needed: the x-axis value positions, the y-axis value positions and the color values.</li>
</ul>
<p>Colors are RGB codes, computed of the aggregation value within the range of all values. Low and high colors values are set into <code>variables</code> object at the beginning of the code.</p>
<p>The toggle button, and the legend are independent of the grid and can be removed.</p>
<blockquote>
<p>Note: It&rsquo;s much easier to deal with dates with Vega-Lite as it can split by day, day of the week, month with the labels and the correct ordering. We then strongly advice to go for <a href="/widget-tricks/heatmaps-vegalite">Vega-Lite heatmaps</a> in that case.</p>
</blockquote>

      </div>
      
      <div class="box">
        






    




<div class="codepen">
    <form id="form-heatmap-with-dynamic-color-scale"
          action="https://codepen.io/pen/define"
          method="POST"
          target="_blank">
        <input type="hidden"
               name="data"
               value='{
                 "title": "New Pen!",
                 "head": &#34;\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css\&#34;\n/\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\&#34;\n/\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.css\&#34;\n/\u003e\n\n\u003c!-- ODS Platform CSS - must be hosted on static : WIP --\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://s3-us-west-2.amazonaws.com/s.cdpn.io/4124551/ods.css\&#34;\n/\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://codelibrary.opendatasoft.com/css/theme.css\&#34;\n/\u003e\n\n\u003cscript src=\&#34;//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js\&#34;\u003e\u003c/script\u003e\n\u003cscript src=\&#34;//cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.js\&#34;\u003e\u003c/script\u003e\n\u003cscript src=\&#34;//cdnjs.cloudflare.com/ajax/libs/angular-sanitize/1.8.2/angular-sanitize.min.js\&#34;\u003e\u003c/script\u003e\n\u003cscript\n  type=\&#34;text/javascript\&#34;\n  src=\&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.js\&#34;\n\u003e\u003c/script\u003e\n\n\u003cscript\n  type=\&#34;text/javascript\&#34;\n  src=\&#34;https://codelibrary.opendatasoft.com/js/platform-filters.js\&#34;\n\u003e\u003c/script\u003e\n\u003cscript\n  type=\&#34;text/javascript\&#34;\n  src=\&#34;https://codelibrary.opendatasoft.com/js/ods-catalog-card.js\&#34;\n\u003e\u003c/script\u003e\n\n\u003cscript type=\&#34;text/javascript\&#34;\u003e\n  const sourceMonitoringInterceptor = $q =\u003e {\n    return {\n      request: config =\u003e {\n        if (config.params)\n          if (config.params.source) delete config.params.source;\n\n        config.url = config.url.replace(\n          \&#34;ods-api-monitoring\&#34;,\n          \&#34;monitoring-copy\&#34;\n        );\n        return config;\n      }\n    };\n  };\n\n  angular\n    .module(\&#34;ods-widgets\&#34;)\n    .config(function(ODSWidgetsConfigProvider, $httpProvider) {\n      ODSWidgetsConfigProvider.setConfig({\n        defaultDomain: \&#34;https://userclub.opendatasoft.com/\&#34;,\n        basemaps: [\n          {\n            provider: \&#34;jawg.light\&#34;,\n            label: \&#34;Jawg Light\&#34;,\n            jawg_apikey: \&#34;opendatasoft-community\&#34;\n          },\n          {\n            provider: \&#34;jawg.streets\&#34;,\n            label: \&#34;Jawg Streets\&#34;,\n            jawg_apikey: \&#34;opendatasoft-community\&#34;,\n            id: \&#34;streets\&#34;\n          }\n        ],\n        themes: {\n          default: {\n            url: \&#34;/img/ods.svg\&#34;\n          },\n          Santé: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/doctors.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Culture, Patrimoine\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/culture.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Éducation, Formation, Recherche, Enseignement\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/college.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          Environment: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/leaf.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Transports, Déplacements\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/train_station.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Aménagement du territoire, Urbanisme, Bâtiments, Équipements, Logement\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/townplanning.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Économie, Business, PME, Développement économique, Emploi\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/economy.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Administration, Gouvernement, Finances publiques, Citoyenneté\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/administration.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Justice, Sécurité, Police, Crime\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/court.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Sport, Loisirs\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/soccer.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Hébergement, Restauration\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/accommodation.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Services, Social\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/social.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          Checklist: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/copyshop.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          Usages: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/bike.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          }\n        },\n        mapPrependAttribution: \&#34;Jawg apikey NOT suitable for production\&#34;\n      });\n      $httpProvider.interceptors.push(sourceMonitoringInterceptor);\n    });\n\u003c/script\u003e\n&#34;,
                 "editors": 110,
                 "html": &#34;\u003cdiv ng-app=\&#34;ods-widgets\&#34;\u003e\n\u003cdiv class=\&#34;container\&#34;\u003e\n    \u003cods-dataset-context context=\&#34;datum\&#34;\n                         datum-dataset=\&#34;comptage-velo-donnees-compteurs\&#34;\u003e\n\n        \u003cdiv ng-init=\&#34;variables = {&#39;min&#39;:undefined, &#39;max&#39;:undefined};\n                                  rgbstart = [0,55,237];\n                                  rgbend = [180,197,241];\n                                  xaxis = &#39;day&#39;;\n                                  yaxis = &#39;month&#39;;\n                                  yLegendWidth = 1\&#34;\u003e\n\n            \u003ch3\u003e# of cyclists, by month and day\u003c/h3\u003e\n            \u003c!--\n                group-by month and day, then for each group by dimension, with toObject and keys filter we get the list of all values.\n                it constructs the x and y axis by listing all different values for each axis.\n\n                xaxis and yaxis variables are here to avoid using specific id at several places in the code.\n                therefore, be sure to name your adv-analysis group-by accordingly.\n            --\u003e\n            \u003cdiv ods-adv-analysis=\&#34;results\&#34;\n                 ods-adv-analysis-context=\&#34;datum\&#34;\n                 ods-adv-analysis-select=\&#34;sum(sum_counts) as count\&#34;\n                 ods-adv-analysis-group-by=\&#34;month(date) as {{ yaxis }}, day(date) as {{ xaxis }}\&#34;\n                 ods-adv-analysis-order-by=\&#34;month asc, day asc\&#34;\u003e\n                {{\n                variables.numrow = (results | toObject:yaxis | numKeys) ;\n                variables.numcol = (results | toObject:xaxis | numKeys) ;\n                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;\n                variables.listcol = (results | toObject:xaxis | keys | orderBy) ;\n                \&#34;\&#34;\n                }}\n\n                \u003c!--\n                    To compute color ranges lateron, you need to get the min and max values from the analysis\n                    this block list all values, and store the min and max in variables each time it finds a new one.\n                --\u003e\n                \u003cspan ng-repeat=\&#34;res in results\&#34;\u003e\n                    {{ variables.min = (!variables.min || res.count \u003c variables.min ? res.count : variables.min); &#39;&#39; }}\n                    {{ variables.max = (!variables.max || res.count \u003e variables.max ? res.count : variables.max); &#39;&#39; }}\n                \u003c/span\u003e\n\n                \u003c!-- The grid --\u003e\n                \u003cdiv class=\&#34;heatmap\&#34;\n                     ng-class=\&#34;{&#39;display-values&#39;: variables.displayvalues}\&#34;\n                     ng-if=\&#34;variables.min \u0026\u0026 variables.max\&#34;\u003e\n\n                    \u003c!-- X axis : (bottom horizontal) list all values and set the correct position --\u003e\n                    \u003cdiv ng-repeat=\&#34;(i,e) in variables.listcol\&#34;\n                         style=\&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;\n                                grid-row: {{variables.numrow &#43; 1}};\&#34;\u003e\n                        \u003cstrong\u003e{{e}}\u003c/strong\u003e\n                    \u003c/div\u003e\n\n                    \u003c!-- Y axis : (left vertical) list all values and set the correct position --\u003e\n                    \u003cdiv ng-repeat=\&#34;(i,e) in variables.listrow\&#34;\n                         class=\&#34;y-axis\&#34;\n                         style=\&#34;grid-column: 1 / span {{ yLegendWidth }};\n                                grid-row: {{ i &#43; 1 }};\&#34;\u003e\n                        \u003cstrong\u003e{{e}}\u003c/strong\u003e\n                    \u003c/div\u003e\n\n                    \u003c!-- Grid content --\u003e\n                    \u003cdiv class=\&#34;cell square\&#34;\n                         ng-repeat=\&#34;e in results\&#34;\n                         ng-init=\&#34;val = ((e.count - variables.min) / (variables.max - variables.min))\&#34;\n                         style=\&#34;background-color: {{ &#39;rgb(&#39; &#43;\n                                                                    ((val * rgbstart[0] &#43; (1 - val) * rgbend[0]) | math : &#39;floor&#39;) &#43;\n                                                                    &#39;,&#39; &#43;\n                                                                    ((val * rgbstart[1] &#43; (1 - val) * rgbend[1]) | math : &#39;floor&#39;) &#43;\n                                                                    &#39;,&#39; &#43;\n                                                                    ((val * rgbstart[2] &#43; (1 - val) * rgbend[2]) | math : &#39;floor&#39;) &#43;\n                                                                    &#39;)&#39; }};\n                                               grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};\n                                               grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};\&#34;\u003e\n                        {{e.count | number}}\n                    \u003c/div\u003e\n                \u003c/div\u003e\n\n                \u003cdiv class=\&#34;heatmap-sub row\&#34;\u003e\n                    \u003cdiv class=\&#34;col-xs-6\&#34;\u003e\n                        \u003cdiv class=\&#34;heatmap-switch\&#34;\u003e\n                            \u003cp\u003eDisplay values: \u003c/p\u003e\n                            \u003clabel class=\&#34;switch\&#34;\u003e\n                                \u003cinput class=\&#34;switch-input\&#34;\n                                       ng-model=\&#34;variables.displayvalues\&#34;\n                                       type=\&#34;checkbox\&#34;\u003e\n                                \u003cdiv class=\&#34;switch-button\&#34;\u003e\n                                    \u003cspan class=\&#34;switch-button-left\&#34;\u003eOFF\u003c/span\u003e\n                                    \u003cspan class=\&#34;switch-button-right\&#34;\u003eON\u003c/span\u003e\n                                \u003c/div\u003e\n                            \u003c/label\u003e\n                        \u003c/div\u003e\n                    \u003c/div\u003e\n                    \u003cdiv class=\&#34;col-xs-6\&#34;\u003e\n                        \u003cdiv class=\&#34;heatmap-legend\&#34;\u003e\n                            \u003cdiv class=\&#34;heatmap-legend__min-value\&#34;\u003e{{ variables.min | number }}\u003c/div\u003e\n                            \u003cdiv class=\&#34;heatmap-legend__gradient\&#34;\n                                 style=\&#34;background: linear-gradient(270deg,\n                                                                        {{ &#39;rgb(&#39;&#43;rgbstart[0]&#43;&#39;,&#39;&#43;rgbstart[1]&#43;&#39;,&#39;&#43;rgbstart[2]&#43;&#39;)&#39; }},\n                                                                        {{ &#39;rgb(&#39;&#43;rgbend[0]&#43;&#39;,&#39;&#43;rgbend[1]&#43;&#39;,&#39;&#43;rgbend[2]&#43;&#39;)&#39; }}\n                                     )\&#34;\u003e\u003c/div\u003e\n                            \u003cdiv class=\&#34;heatmap-legend__max-value\&#34;\u003e{{ variables.max | number }}\u003c/div\u003e\n                        \u003c/div\u003e\n                    \u003c/div\u003e\n                \u003c/div\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n    \u003c/ods-dataset-context\u003e\n\u003c/div\u003e\n\n\u003c/div\u003e&#34;,
                 "css": &#34;:root {\n    --values-color: white;\n}\n\n.heatmap {\n    display: grid;\n    grid-auto-columns: 1fr;\n    grid-auto-flow: column;\n    grid-auto-rows: auto;\n    /* full auto, adapt to the content, ie the font size */\n}\n.heatmap \u003e * {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    overflow: hidden;\n    font-size: 0.7rem;\n}\n.heatmap.display-values .cell {\n    font-size: 0.5rem;\n}\n.heatmap .cell {\n    position: relative;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    overflow: hidden;\n    color: var(--values-color);\n    font-size: 0;\n}\n.heatmap .cell:hover {\n    border: 1px solid var(--values-color);\n    transform: scale(2);\n    font-size: 0.4rem;\n    z-index: 1;\n}\n.heatmap .cell.square:before {\n    content: \&#34;\&#34;;\n    display: block;\n    padding-bottom: 100%;\n}\n.heatmap .cell .round {\n    border-radius: 100%;\n    border: 1px solid black;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.x-axis-centered {\n    text-align: center;\n}\n.x-axis-rotate {\n    transform: rotate(-60deg);\n    padding: 35% 0;\n}\n\n.heatmap-sub {\n    margin-top: 13px;\n}\n\n.heatmap-legend {\n    display: flex;\n    width: 100%;\n    justify-content: space-between;\n    align-items: center;\n}\n.heatmap-legend .heatmap-legend__gradient {\n    display: block;\n    height: 25px;\n    width: 100%;\n    margin: 0 6px;\n    border: 1px solid darkgray;\n}\n\n.heatmap-switch {\n    display: flex;\n    align-items: baseline;\n}\n.heatmap-switch .switch {\n    margin-left: 6px;\n}\n\n/* Button Group Switch\n   ========================================================================== */\n.switch {\n    display: inline-block;\n}\n\n.switch-button {\n    /* background and border when in \&#34;off\&#34; state */\n    background: var(--highlight);\n    border: 2px solid var(--highlight);\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    border-radius: 6px;\n    color: #FFFFFF;\n    position: relative;\n    cursor: pointer;\n    outline: 0;\n    user-select: none;\n}\n\n.switch-input:not(:checked) &#43; .switch-button .switch-button-left {\n    /* text color when in \&#34;off\&#34; state */\n    color: var(--highlight);\n}\n\n.switch-input {\n    display: none;\n}\n\n.switch-button span {\n    font-size: 0.8rem;\n    padding: 0.2rem 0.7rem;\n    text-align: center;\n    z-index: 2;\n    color: #FFFFFF;\n    transition: color 0.2s;\n}\n\n.switch-button::before {\n    content: \&#34;\&#34;;\n    position: absolute;\n    background-color: #FFFFFF;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);\n    border-radius: 4px;\n    top: 0;\n    left: 0;\n    height: 100%;\n    width: 50%;\n    z-index: 1;\n    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;\n}\n\n.switch-button:hover::before {\n    will-change: padding;\n}\n\n.switch-button:active::before {\n    padding-right: 0.4rem;\n}\n\n/* \&#34;On\&#34; state\n   ========================== */\n.switch-input:checked &#43; .switch-button {\n    /* background and border when in \&#34;on\&#34; state */\n    background-color: var(--links);\n    border-color: var(--links);\n}\n\n.switch-input:checked &#43; .switch-button .switch-button-right {\n    /* text color when in \&#34;on\&#34; state */\n    color: var(--links);\n}\n\n.switch-input:checked &#43; .switch-button::before {\n    left: 50%;\n}\n\n.switch-input:checked &#43; .switch-button:active::before {\n    margin-left: -0.4rem;\n}\n\n/* Checkbox in disabled state\n   ========================== */\n.switch-input[type=checkbox]:disabled &#43; .switch-button {\n    opacity: 0.6;\n    cursor: not-allowed;\n}&#34;
               }'>
    </form>
</div>
<div class="ods-content">
    <div class="box-live-example"
      style="height: 550px;">
      <iframe id="iframe-heatmap-with-dynamic-color-scale"
              width="100%" height="100%"
              src="about:blank"
              srcdoc="
                <head>&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css&#34;
/&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css&#34;
/&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.css&#34;
/&gt;

&lt;!-- ODS Platform CSS - must be hosted on static : WIP --&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://s3-us-west-2.amazonaws.com/s.cdpn.io/4124551/ods.css&#34;
/&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://codelibrary.opendatasoft.com/css/theme.css&#34;
/&gt;

&lt;script src=&#34;//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;//cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;//cdnjs.cloudflare.com/ajax/libs/angular-sanitize/1.8.2/angular-sanitize.min.js&#34;&gt;&lt;/script&gt;
&lt;script
  type=&#34;text/javascript&#34;
  src=&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.js&#34;
&gt;&lt;/script&gt;

&lt;script
  type=&#34;text/javascript&#34;
  src=&#34;https://codelibrary.opendatasoft.com/js/platform-filters.js&#34;
&gt;&lt;/script&gt;
&lt;script
  type=&#34;text/javascript&#34;
  src=&#34;https://codelibrary.opendatasoft.com/js/ods-catalog-card.js&#34;
&gt;&lt;/script&gt;

&lt;script type=&#34;text/javascript&#34;&gt;
  const sourceMonitoringInterceptor = $q =&gt; {
    return {
      request: config =&gt; {
        if (config.params)
          if (config.params.source) delete config.params.source;

        config.url = config.url.replace(
          &#34;ods-api-monitoring&#34;,
          &#34;monitoring-copy&#34;
        );
        return config;
      }
    };
  };

  angular
    .module(&#34;ods-widgets&#34;)
    .config(function(ODSWidgetsConfigProvider, $httpProvider) {
      ODSWidgetsConfigProvider.setConfig({
        defaultDomain: &#34;https://userclub.opendatasoft.com/&#34;,
        basemaps: [
          {
            provider: &#34;jawg.light&#34;,
            label: &#34;Jawg Light&#34;,
            jawg_apikey: &#34;opendatasoft-community&#34;
          },
          {
            provider: &#34;jawg.streets&#34;,
            label: &#34;Jawg Streets&#34;,
            jawg_apikey: &#34;opendatasoft-community&#34;,
            id: &#34;streets&#34;
          }
        ],
        themes: {
          default: {
            url: &#34;/img/ods.svg&#34;
          },
          Santé: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/doctors.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Culture, Patrimoine&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/culture.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Éducation, Formation, Recherche, Enseignement&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/college.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          Environment: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/leaf.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Transports, Déplacements&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/train_station.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Aménagement du territoire, Urbanisme, Bâtiments, Équipements, Logement&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/townplanning.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Économie, Business, PME, Développement économique, Emploi&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/economy.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Administration, Gouvernement, Finances publiques, Citoyenneté&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/administration.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Justice, Sécurité, Police, Crime&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/court.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Sport, Loisirs&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/soccer.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Hébergement, Restauration&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/accommodation.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Services, Social&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/social.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          Checklist: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/copyshop.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          Usages: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/bike.svg&#34;,
            color: &#34;#1446A0&#34;
          }
        },
        mapPrependAttribution: &#34;Jawg apikey NOT suitable for production&#34;
      });
      $httpProvider.interceptors.push(sourceMonitoringInterceptor);
    });
&lt;/script&gt;
</head>
                <base href='https://userclub.opendatasoft.com/'>
                <body>
                <div ng-app='ods-widgets'>&lt;div ng-app=&#34;ods-widgets&#34;&gt;
&lt;div class=&#34;container&#34;&gt;
    &lt;ods-dataset-context context=&#34;datum&#34;
                         datum-dataset=&#34;comptage-velo-donnees-compteurs&#34;&gt;

        &lt;div ng-init=&#34;variables = {&#39;min&#39;:undefined, &#39;max&#39;:undefined};
                                  rgbstart = [0,55,237];
                                  rgbend = [180,197,241];
                                  xaxis = &#39;day&#39;;
                                  yaxis = &#39;month&#39;;
                                  yLegendWidth = 1&#34;&gt;

            &lt;h3&gt;# of cyclists, by month and day&lt;/h3&gt;
            &lt;!--
                group-by month and day, then for each group by dimension, with toObject and keys filter we get the list of all values.
                it constructs the x and y axis by listing all different values for each axis.

                xaxis and yaxis variables are here to avoid using specific id at several places in the code.
                therefore, be sure to name your adv-analysis group-by accordingly.
            --&gt;
            &lt;div ods-adv-analysis=&#34;results&#34;
                 ods-adv-analysis-context=&#34;datum&#34;
                 ods-adv-analysis-select=&#34;sum(sum_counts) as count&#34;
                 ods-adv-analysis-group-by=&#34;month(date) as {{ yaxis }}, day(date) as {{ xaxis }}&#34;
                 ods-adv-analysis-order-by=&#34;month asc, day asc&#34;&gt;
                {{
                variables.numrow = (results | toObject:yaxis | numKeys) ;
                variables.numcol = (results | toObject:xaxis | numKeys) ;
                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;
                variables.listcol = (results | toObject:xaxis | keys | orderBy) ;
                &#34;&#34;
                }}

                &lt;!--
                    To compute color ranges lateron, you need to get the min and max values from the analysis
                    this block list all values, and store the min and max in variables each time it finds a new one.
                --&gt;
                &lt;span ng-repeat=&#34;res in results&#34;&gt;
                    {{ variables.min = (!variables.min || res.count &lt; variables.min ? res.count : variables.min); &#39;&#39; }}
                    {{ variables.max = (!variables.max || res.count &gt; variables.max ? res.count : variables.max); &#39;&#39; }}
                &lt;/span&gt;

                &lt;!-- The grid --&gt;
                &lt;div class=&#34;heatmap&#34;
                     ng-class=&#34;{&#39;display-values&#39;: variables.displayvalues}&#34;
                     ng-if=&#34;variables.min &amp;&amp; variables.max&#34;&gt;

                    &lt;!-- X axis : (bottom horizontal) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listcol&#34;
                         style=&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;
                                grid-row: {{variables.numrow &#43; 1}};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Y axis : (left vertical) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listrow&#34;
                         class=&#34;y-axis&#34;
                         style=&#34;grid-column: 1 / span {{ yLegendWidth }};
                                grid-row: {{ i &#43; 1 }};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Grid content --&gt;
                    &lt;div class=&#34;cell square&#34;
                         ng-repeat=&#34;e in results&#34;
                         ng-init=&#34;val = ((e.count - variables.min) / (variables.max - variables.min))&#34;
                         style=&#34;background-color: {{ &#39;rgb(&#39; &#43;
                                                                    ((val * rgbstart[0] &#43; (1 - val) * rgbend[0]) | math : &#39;floor&#39;) &#43;
                                                                    &#39;,&#39; &#43;
                                                                    ((val * rgbstart[1] &#43; (1 - val) * rgbend[1]) | math : &#39;floor&#39;) &#43;
                                                                    &#39;,&#39; &#43;
                                                                    ((val * rgbstart[2] &#43; (1 - val) * rgbend[2]) | math : &#39;floor&#39;) &#43;
                                                                    &#39;)&#39; }};
                                               grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};
                                               grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};&#34;&gt;
                        {{e.count | number}}
                    &lt;/div&gt;
                &lt;/div&gt;

                &lt;div class=&#34;heatmap-sub row&#34;&gt;
                    &lt;div class=&#34;col-xs-6&#34;&gt;
                        &lt;div class=&#34;heatmap-switch&#34;&gt;
                            &lt;p&gt;Display values: &lt;/p&gt;
                            &lt;label class=&#34;switch&#34;&gt;
                                &lt;input class=&#34;switch-input&#34;
                                       ng-model=&#34;variables.displayvalues&#34;
                                       type=&#34;checkbox&#34;&gt;
                                &lt;div class=&#34;switch-button&#34;&gt;
                                    &lt;span class=&#34;switch-button-left&#34;&gt;OFF&lt;/span&gt;
                                    &lt;span class=&#34;switch-button-right&#34;&gt;ON&lt;/span&gt;
                                &lt;/div&gt;
                            &lt;/label&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&#34;col-xs-6&#34;&gt;
                        &lt;div class=&#34;heatmap-legend&#34;&gt;
                            &lt;div class=&#34;heatmap-legend__min-value&#34;&gt;{{ variables.min | number }}&lt;/div&gt;
                            &lt;div class=&#34;heatmap-legend__gradient&#34;
                                 style=&#34;background: linear-gradient(270deg,
                                                                        {{ &#39;rgb(&#39;&#43;rgbstart[0]&#43;&#39;,&#39;&#43;rgbstart[1]&#43;&#39;,&#39;&#43;rgbstart[2]&#43;&#39;)&#39; }},
                                                                        {{ &#39;rgb(&#39;&#43;rgbend[0]&#43;&#39;,&#39;&#43;rgbend[1]&#43;&#39;,&#39;&#43;rgbend[2]&#43;&#39;)&#39; }}
                                     )&#34;&gt;&lt;/div&gt;
                            &lt;div class=&#34;heatmap-legend__max-value&#34;&gt;{{ variables.max | number }}&lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/ods-dataset-context&gt;
&lt;/div&gt;

&lt;/div&gt;</div>
                <style type='text/css'>
                    :root {
    --values-color: white;
}

.heatmap {
    display: grid;
    grid-auto-columns: 1fr;
    grid-auto-flow: column;
    grid-auto-rows: auto;
    /* full auto, adapt to the content, ie the font size */
}
.heatmap &gt; * {
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    font-size: 0.7rem;
}
.heatmap.display-values .cell {
    font-size: 0.5rem;
}
.heatmap .cell {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    color: var(--values-color);
    font-size: 0;
}
.heatmap .cell:hover {
    border: 1px solid var(--values-color);
    transform: scale(2);
    font-size: 0.4rem;
    z-index: 1;
}
.heatmap .cell.square:before {
    content: &#34;&#34;;
    display: block;
    padding-bottom: 100%;
}
.heatmap .cell .round {
    border-radius: 100%;
    border: 1px solid black;
    display: flex;
    justify-content: center;
    align-items: center;
}

.x-axis-centered {
    text-align: center;
}
.x-axis-rotate {
    transform: rotate(-60deg);
    padding: 35% 0;
}

.heatmap-sub {
    margin-top: 13px;
}

.heatmap-legend {
    display: flex;
    width: 100%;
    justify-content: space-between;
    align-items: center;
}
.heatmap-legend .heatmap-legend__gradient {
    display: block;
    height: 25px;
    width: 100%;
    margin: 0 6px;
    border: 1px solid darkgray;
}

.heatmap-switch {
    display: flex;
    align-items: baseline;
}
.heatmap-switch .switch {
    margin-left: 6px;
}

/* Button Group Switch
   ========================================================================== */
.switch {
    display: inline-block;
}

.switch-button {
    /* background and border when in &#34;off&#34; state */
    background: var(--highlight);
    border: 2px solid var(--highlight);
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-radius: 6px;
    color: #FFFFFF;
    position: relative;
    cursor: pointer;
    outline: 0;
    user-select: none;
}

.switch-input:not(:checked) &#43; .switch-button .switch-button-left {
    /* text color when in &#34;off&#34; state */
    color: var(--highlight);
}

.switch-input {
    display: none;
}

.switch-button span {
    font-size: 0.8rem;
    padding: 0.2rem 0.7rem;
    text-align: center;
    z-index: 2;
    color: #FFFFFF;
    transition: color 0.2s;
}

.switch-button::before {
    content: &#34;&#34;;
    position: absolute;
    background-color: #FFFFFF;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    border-radius: 4px;
    top: 0;
    left: 0;
    height: 100%;
    width: 50%;
    z-index: 1;
    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;
}

.switch-button:hover::before {
    will-change: padding;
}

.switch-button:active::before {
    padding-right: 0.4rem;
}

/* &#34;On&#34; state
   ========================== */
.switch-input:checked &#43; .switch-button {
    /* background and border when in &#34;on&#34; state */
    background-color: var(--links);
    border-color: var(--links);
}

.switch-input:checked &#43; .switch-button .switch-button-right {
    /* text color when in &#34;on&#34; state */
    color: var(--links);
}

.switch-input:checked &#43; .switch-button::before {
    left: 50%;
}

.switch-input:checked &#43; .switch-button:active::before {
    margin-left: -0.4rem;
}

/* Checkbox in disabled state
   ========================== */
.switch-input[type=checkbox]:disabled &#43; .switch-button {
    opacity: 0.6;
    cursor: not-allowed;
}
                </style>
                </body>
              ">
      </iframe>
      <div class="show-code buttons has-addons">
          <button class="button is-light">
            <span>Show code</span>
          </button>
          <button class="button is-light"
             target="_blank"
             aria-role="link"
             rel="noopener"
             title="Edit on CodePen, open a new tab"
             onclick="document.getElementById('form-heatmap-with-dynamic-color-scale').submit()">
              <span>Edit on Codepen</span>
              <span class="icon is-small">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                  <use xlink:href="#external"></use>
                </svg>
              </span>
          </button>
      </div>
    </div>
    <div class="box-code js-tabs is-hidden">
        <nav class="level is-mobile">
            <div class="level-left">
                <div class="level-item">
                    <div class="buttons has-addons js-tablist">
                        <a
                          class="button is-primary is-outlined js-tablist__item js-tablist__link"
                          href="#code-heatmap-with-dynamic-color-scale-html-content"
                        >
                          HTML
                        </a>
                        
                        <a
                          class="button is-primary is-outlined js-tablist__item js-tablist__link"
                          href="#code-heatmap-with-dynamic-color-scale-css-content"
                        >
                          CSS
                        </a>
                        
                    </div>
                </div>
            </div>
            <div class="level-right">
                <button class="copy-to-cc button is-primary is-outlined is-rounded has-tooltip-left"
                  data-tooltip="Copy to clipboard"
                  aria-role="button"
                  title="Edit on CodePen, open a new tab"
                >
                  <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                      <use xlink:href="#copy"></use>
                    </svg>
                  </span>
                </button>
                <button class="copied-to-cc button is-success is-outlined is-rounded has-tooltip-left is-hidden"
                  data-tooltip="Copied"
                  aria-role="button"
                  title="Copied"
                >
                  <figure class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                      <use xlink:href="#check"></use>
                    </svg>
                  </figure>
                </button>
            </div>
        </nav>
        <div class="tab-content">
            <div class="js-tabcontent"
                 id="code-heatmap-with-dynamic-color-scale-html-content"
                 data-clipboard="&lt;div class=&#34;container&#34;&gt;
    &lt;ods-dataset-context context=&#34;datum&#34;
                         datum-dataset=&#34;comptage-velo-donnees-compteurs&#34;&gt;

        &lt;div ng-init=&#34;variables = {&#39;min&#39;:undefined, &#39;max&#39;:undefined};
                                  rgbstart = [0,55,237];
                                  rgbend = [180,197,241];
                                  xaxis = &#39;day&#39;;
                                  yaxis = &#39;month&#39;;
                                  yLegendWidth = 1&#34;&gt;

            &lt;h3&gt;# of cyclists, by month and day&lt;/h3&gt;
            &lt;!--
                group-by month and day, then for each group by dimension, with toObject and keys filter we get the list of all values.
                it constructs the x and y axis by listing all different values for each axis.

                xaxis and yaxis variables are here to avoid using specific id at several places in the code.
                therefore, be sure to name your adv-analysis group-by accordingly.
            --&gt;
            &lt;div ods-adv-analysis=&#34;results&#34;
                 ods-adv-analysis-context=&#34;datum&#34;
                 ods-adv-analysis-select=&#34;sum(sum_counts) as count&#34;
                 ods-adv-analysis-group-by=&#34;month(date) as {{ yaxis }}, day(date) as {{ xaxis }}&#34;
                 ods-adv-analysis-order-by=&#34;month asc, day asc&#34;&gt;
                {{
                variables.numrow = (results | toObject:yaxis | numKeys) ;
                variables.numcol = (results | toObject:xaxis | numKeys) ;
                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;
                variables.listcol = (results | toObject:xaxis | keys | orderBy) ;
                &#34;&#34;
                }}

                &lt;!--
                    To compute color ranges lateron, you need to get the min and max values from the analysis
                    this block list all values, and store the min and max in variables each time it finds a new one.
                --&gt;
                &lt;span ng-repeat=&#34;res in results&#34;&gt;
                    {{ variables.min = (!variables.min || res.count &lt; variables.min ? res.count : variables.min); &#39;&#39; }}
                    {{ variables.max = (!variables.max || res.count &gt; variables.max ? res.count : variables.max); &#39;&#39; }}
                &lt;/span&gt;

                &lt;!-- The grid --&gt;
                &lt;div class=&#34;heatmap&#34;
                     ng-class=&#34;{&#39;display-values&#39;: variables.displayvalues}&#34;
                     ng-if=&#34;variables.min &amp;&amp; variables.max&#34;&gt;

                    &lt;!-- X axis : (bottom horizontal) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listcol&#34;
                         style=&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;
                                grid-row: {{variables.numrow &#43; 1}};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Y axis : (left vertical) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listrow&#34;
                         class=&#34;y-axis&#34;
                         style=&#34;grid-column: 1 / span {{ yLegendWidth }};
                                grid-row: {{ i &#43; 1 }};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Grid content --&gt;
                    &lt;div class=&#34;cell square&#34;
                         ng-repeat=&#34;e in results&#34;
                         ng-init=&#34;val = ((e.count - variables.min) / (variables.max - variables.min))&#34;
                         style=&#34;background-color: {{ &#39;rgb(&#39; &#43;
                                                                    ((val * rgbstart[0] &#43; (1 - val) * rgbend[0]) | math : &#39;floor&#39;) &#43;
                                                                    &#39;,&#39; &#43;
                                                                    ((val * rgbstart[1] &#43; (1 - val) * rgbend[1]) | math : &#39;floor&#39;) &#43;
                                                                    &#39;,&#39; &#43;
                                                                    ((val * rgbstart[2] &#43; (1 - val) * rgbend[2]) | math : &#39;floor&#39;) &#43;
                                                                    &#39;)&#39; }};
                                               grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};
                                               grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};&#34;&gt;
                        {{e.count | number}}
                    &lt;/div&gt;
                &lt;/div&gt;

                &lt;div class=&#34;heatmap-sub row&#34;&gt;
                    &lt;div class=&#34;col-xs-6&#34;&gt;
                        &lt;div class=&#34;heatmap-switch&#34;&gt;
                            &lt;p&gt;Display values: &lt;/p&gt;
                            &lt;label class=&#34;switch&#34;&gt;
                                &lt;input class=&#34;switch-input&#34;
                                       ng-model=&#34;variables.displayvalues&#34;
                                       type=&#34;checkbox&#34;&gt;
                                &lt;div class=&#34;switch-button&#34;&gt;
                                    &lt;span class=&#34;switch-button-left&#34;&gt;OFF&lt;/span&gt;
                                    &lt;span class=&#34;switch-button-right&#34;&gt;ON&lt;/span&gt;
                                &lt;/div&gt;
                            &lt;/label&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&#34;col-xs-6&#34;&gt;
                        &lt;div class=&#34;heatmap-legend&#34;&gt;
                            &lt;div class=&#34;heatmap-legend__min-value&#34;&gt;{{ variables.min | number }}&lt;/div&gt;
                            &lt;div class=&#34;heatmap-legend__gradient&#34;
                                 style=&#34;background: linear-gradient(270deg,
                                                                        {{ &#39;rgb(&#39;&#43;rgbstart[0]&#43;&#39;,&#39;&#43;rgbstart[1]&#43;&#39;,&#39;&#43;rgbstart[2]&#43;&#39;)&#39; }},
                                                                        {{ &#39;rgb(&#39;&#43;rgbend[0]&#43;&#39;,&#39;&#43;rgbend[1]&#43;&#39;,&#39;&#43;rgbend[2]&#43;&#39;)&#39; }}
                                     )&#34;&gt;&lt;/div&gt;
                            &lt;div class=&#34;heatmap-legend__max-value&#34;&gt;{{ variables.max | number }}&lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/ods-dataset-context&gt;
&lt;/div&gt;

"
                 role="tabpanel">
                <div class="highlight">
                    <pre class="language-html" data-lang="html"><code>&lt;div class=&#34;container&#34;&gt;
    &lt;ods-dataset-context context=&#34;datum&#34;
                         datum-dataset=&#34;comptage-velo-donnees-compteurs&#34;&gt;

        &lt;div ng-init=&#34;variables = {&#39;min&#39;:undefined, &#39;max&#39;:undefined};
                                  rgbstart = [0,55,237];
                                  rgbend = [180,197,241];
                                  xaxis = &#39;day&#39;;
                                  yaxis = &#39;month&#39;;
                                  yLegendWidth = 1&#34;&gt;

            &lt;h3&gt;# of cyclists, by month and day&lt;/h3&gt;
            &lt;!--
                group-by month and day, then for each group by dimension, with toObject and keys filter we get the list of all values.
                it constructs the x and y axis by listing all different values for each axis.

                xaxis and yaxis variables are here to avoid using specific id at several places in the code.
                therefore, be sure to name your adv-analysis group-by accordingly.
            --&gt;
            &lt;div ods-adv-analysis=&#34;results&#34;
                 ods-adv-analysis-context=&#34;datum&#34;
                 ods-adv-analysis-select=&#34;sum(sum_counts) as count&#34;
                 ods-adv-analysis-group-by=&#34;month(date) as {{ yaxis }}, day(date) as {{ xaxis }}&#34;
                 ods-adv-analysis-order-by=&#34;month asc, day asc&#34;&gt;
                {{
                variables.numrow = (results | toObject:yaxis | numKeys) ;
                variables.numcol = (results | toObject:xaxis | numKeys) ;
                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;
                variables.listcol = (results | toObject:xaxis | keys | orderBy) ;
                &#34;&#34;
                }}

                &lt;!--
                    To compute color ranges lateron, you need to get the min and max values from the analysis
                    this block list all values, and store the min and max in variables each time it finds a new one.
                --&gt;
                &lt;span ng-repeat=&#34;res in results&#34;&gt;
                    {{ variables.min = (!variables.min || res.count &lt; variables.min ? res.count : variables.min); &#39;&#39; }}
                    {{ variables.max = (!variables.max || res.count &gt; variables.max ? res.count : variables.max); &#39;&#39; }}
                &lt;/span&gt;

                &lt;!-- The grid --&gt;
                &lt;div class=&#34;heatmap&#34;
                     ng-class=&#34;{&#39;display-values&#39;: variables.displayvalues}&#34;
                     ng-if=&#34;variables.min &amp;&amp; variables.max&#34;&gt;

                    &lt;!-- X axis : (bottom horizontal) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listcol&#34;
                         style=&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;
                                grid-row: {{variables.numrow &#43; 1}};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Y axis : (left vertical) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listrow&#34;
                         class=&#34;y-axis&#34;
                         style=&#34;grid-column: 1 / span {{ yLegendWidth }};
                                grid-row: {{ i &#43; 1 }};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Grid content --&gt;
                    &lt;div class=&#34;cell square&#34;
                         ng-repeat=&#34;e in results&#34;
                         ng-init=&#34;val = ((e.count - variables.min) / (variables.max - variables.min))&#34;
                         style=&#34;background-color: {{ &#39;rgb(&#39; &#43;
                                                                    ((val * rgbstart[0] &#43; (1 - val) * rgbend[0]) | math : &#39;floor&#39;) &#43;
                                                                    &#39;,&#39; &#43;
                                                                    ((val * rgbstart[1] &#43; (1 - val) * rgbend[1]) | math : &#39;floor&#39;) &#43;
                                                                    &#39;,&#39; &#43;
                                                                    ((val * rgbstart[2] &#43; (1 - val) * rgbend[2]) | math : &#39;floor&#39;) &#43;
                                                                    &#39;)&#39; }};
                                               grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};
                                               grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};&#34;&gt;
                        {{e.count | number}}
                    &lt;/div&gt;
                &lt;/div&gt;

                &lt;div class=&#34;heatmap-sub row&#34;&gt;
                    &lt;div class=&#34;col-xs-6&#34;&gt;
                        &lt;div class=&#34;heatmap-switch&#34;&gt;
                            &lt;p&gt;Display values: &lt;/p&gt;
                            &lt;label class=&#34;switch&#34;&gt;
                                &lt;input class=&#34;switch-input&#34;
                                       ng-model=&#34;variables.displayvalues&#34;
                                       type=&#34;checkbox&#34;&gt;
                                &lt;div class=&#34;switch-button&#34;&gt;
                                    &lt;span class=&#34;switch-button-left&#34;&gt;OFF&lt;/span&gt;
                                    &lt;span class=&#34;switch-button-right&#34;&gt;ON&lt;/span&gt;
                                &lt;/div&gt;
                            &lt;/label&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&#34;col-xs-6&#34;&gt;
                        &lt;div class=&#34;heatmap-legend&#34;&gt;
                            &lt;div class=&#34;heatmap-legend__min-value&#34;&gt;{{ variables.min | number }}&lt;/div&gt;
                            &lt;div class=&#34;heatmap-legend__gradient&#34;
                                 style=&#34;background: linear-gradient(270deg,
                                                                        {{ &#39;rgb(&#39;&#43;rgbstart[0]&#43;&#39;,&#39;&#43;rgbstart[1]&#43;&#39;,&#39;&#43;rgbstart[2]&#43;&#39;)&#39; }},
                                                                        {{ &#39;rgb(&#39;&#43;rgbend[0]&#43;&#39;,&#39;&#43;rgbend[1]&#43;&#39;,&#39;&#43;rgbend[2]&#43;&#39;)&#39; }}
                                     )&#34;&gt;&lt;/div&gt;
                            &lt;div class=&#34;heatmap-legend__max-value&#34;&gt;{{ variables.max | number }}&lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/ods-dataset-context&gt;
&lt;/div&gt;

</code></pre>
                </div>
            </div>
            
            <div class="js-tabcontent"
                 id="code-heatmap-with-dynamic-color-scale-css-content"
                 data-clipboard=":root {
    --values-color: white;
}

.heatmap {
    display: grid;
    grid-auto-columns: 1fr;
    grid-auto-flow: column;
    grid-auto-rows: auto;
    /* full auto, adapt to the content, ie the font size */
}
.heatmap &gt; * {
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    font-size: 0.7rem;
}
.heatmap.display-values .cell {
    font-size: 0.5rem;
}
.heatmap .cell {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    color: var(--values-color);
    font-size: 0;
}
.heatmap .cell:hover {
    border: 1px solid var(--values-color);
    transform: scale(2);
    font-size: 0.4rem;
    z-index: 1;
}
.heatmap .cell.square:before {
    content: &#34;&#34;;
    display: block;
    padding-bottom: 100%;
}
.heatmap .cell .round {
    border-radius: 100%;
    border: 1px solid black;
    display: flex;
    justify-content: center;
    align-items: center;
}

.x-axis-centered {
    text-align: center;
}
.x-axis-rotate {
    transform: rotate(-60deg);
    padding: 35% 0;
}

.heatmap-sub {
    margin-top: 13px;
}

.heatmap-legend {
    display: flex;
    width: 100%;
    justify-content: space-between;
    align-items: center;
}
.heatmap-legend .heatmap-legend__gradient {
    display: block;
    height: 25px;
    width: 100%;
    margin: 0 6px;
    border: 1px solid darkgray;
}

.heatmap-switch {
    display: flex;
    align-items: baseline;
}
.heatmap-switch .switch {
    margin-left: 6px;
}

/* Button Group Switch
   ========================================================================== */
.switch {
    display: inline-block;
}

.switch-button {
    /* background and border when in &#34;off&#34; state */
    background: var(--highlight);
    border: 2px solid var(--highlight);
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-radius: 6px;
    color: #FFFFFF;
    position: relative;
    cursor: pointer;
    outline: 0;
    user-select: none;
}

.switch-input:not(:checked) &#43; .switch-button .switch-button-left {
    /* text color when in &#34;off&#34; state */
    color: var(--highlight);
}

.switch-input {
    display: none;
}

.switch-button span {
    font-size: 0.8rem;
    padding: 0.2rem 0.7rem;
    text-align: center;
    z-index: 2;
    color: #FFFFFF;
    transition: color 0.2s;
}

.switch-button::before {
    content: &#34;&#34;;
    position: absolute;
    background-color: #FFFFFF;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    border-radius: 4px;
    top: 0;
    left: 0;
    height: 100%;
    width: 50%;
    z-index: 1;
    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;
}

.switch-button:hover::before {
    will-change: padding;
}

.switch-button:active::before {
    padding-right: 0.4rem;
}

/* &#34;On&#34; state
   ========================== */
.switch-input:checked &#43; .switch-button {
    /* background and border when in &#34;on&#34; state */
    background-color: var(--links);
    border-color: var(--links);
}

.switch-input:checked &#43; .switch-button .switch-button-right {
    /* text color when in &#34;on&#34; state */
    color: var(--links);
}

.switch-input:checked &#43; .switch-button::before {
    left: 50%;
}

.switch-input:checked &#43; .switch-button:active::before {
    margin-left: -0.4rem;
}

/* Checkbox in disabled state
   ========================== */
.switch-input[type=checkbox]:disabled &#43; .switch-button {
    opacity: 0.6;
    cursor: not-allowed;
}">
                <div class="highlight">
                    <pre class="language-css" data-lang="css"><code>:root {
    --values-color: white;
}

.heatmap {
    display: grid;
    grid-auto-columns: 1fr;
    grid-auto-flow: column;
    grid-auto-rows: auto;
    /* full auto, adapt to the content, ie the font size */
}
.heatmap &gt; * {
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    font-size: 0.7rem;
}
.heatmap.display-values .cell {
    font-size: 0.5rem;
}
.heatmap .cell {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    color: var(--values-color);
    font-size: 0;
}
.heatmap .cell:hover {
    border: 1px solid var(--values-color);
    transform: scale(2);
    font-size: 0.4rem;
    z-index: 1;
}
.heatmap .cell.square:before {
    content: &#34;&#34;;
    display: block;
    padding-bottom: 100%;
}
.heatmap .cell .round {
    border-radius: 100%;
    border: 1px solid black;
    display: flex;
    justify-content: center;
    align-items: center;
}

.x-axis-centered {
    text-align: center;
}
.x-axis-rotate {
    transform: rotate(-60deg);
    padding: 35% 0;
}

.heatmap-sub {
    margin-top: 13px;
}

.heatmap-legend {
    display: flex;
    width: 100%;
    justify-content: space-between;
    align-items: center;
}
.heatmap-legend .heatmap-legend__gradient {
    display: block;
    height: 25px;
    width: 100%;
    margin: 0 6px;
    border: 1px solid darkgray;
}

.heatmap-switch {
    display: flex;
    align-items: baseline;
}
.heatmap-switch .switch {
    margin-left: 6px;
}

/* Button Group Switch
   ========================================================================== */
.switch {
    display: inline-block;
}

.switch-button {
    /* background and border when in &#34;off&#34; state */
    background: var(--highlight);
    border: 2px solid var(--highlight);
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-radius: 6px;
    color: #FFFFFF;
    position: relative;
    cursor: pointer;
    outline: 0;
    user-select: none;
}

.switch-input:not(:checked) &#43; .switch-button .switch-button-left {
    /* text color when in &#34;off&#34; state */
    color: var(--highlight);
}

.switch-input {
    display: none;
}

.switch-button span {
    font-size: 0.8rem;
    padding: 0.2rem 0.7rem;
    text-align: center;
    z-index: 2;
    color: #FFFFFF;
    transition: color 0.2s;
}

.switch-button::before {
    content: &#34;&#34;;
    position: absolute;
    background-color: #FFFFFF;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    border-radius: 4px;
    top: 0;
    left: 0;
    height: 100%;
    width: 50%;
    z-index: 1;
    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;
}

.switch-button:hover::before {
    will-change: padding;
}

.switch-button:active::before {
    padding-right: 0.4rem;
}

/* &#34;On&#34; state
   ========================== */
.switch-input:checked &#43; .switch-button {
    /* background and border when in &#34;on&#34; state */
    background-color: var(--links);
    border-color: var(--links);
}

.switch-input:checked &#43; .switch-button .switch-button-right {
    /* text color when in &#34;on&#34; state */
    color: var(--links);
}

.switch-input:checked &#43; .switch-button::before {
    left: 50%;
}

.switch-input:checked &#43; .switch-button:active::before {
    margin-left: -0.4rem;
}

/* Checkbox in disabled state
   ========================== */
.switch-input[type=checkbox]:disabled &#43; .switch-button {
    opacity: 0.6;
    cursor: not-allowed;
}</code></pre>
                </div>
            </div>
            
        </div>
    </div>
</div>

      </div>
    </article>
    
    <article class="block">
      <h2 class="title is-2" id="bubblemap-with-dynamic-color-scale">
        Bubblemap with dynamic color scale 
        <a class="is-link anchor" href="#bubblemap-with-dynamic-color-scale">
          <span class="icon">
            <img src="/img/fas-link.svg" />
          </span>
        </a>
      </h2>
      <div class="content">
        <p>Same analysis and display as before. Only cells get an extra style with expression to compute the size of the cells based on the aggregation value within the range of all values.</p>

      </div>
      
      <div class="box">
        






    




<div class="codepen">
    <form id="form-bubblemap-with-dynamic-color-scale"
          action="https://codepen.io/pen/define"
          method="POST"
          target="_blank">
        <input type="hidden"
               name="data"
               value='{
                 "title": "New Pen!",
                 "head": &#34;\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css\&#34;\n/\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\&#34;\n/\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.css\&#34;\n/\u003e\n\n\u003c!-- ODS Platform CSS - must be hosted on static : WIP --\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://s3-us-west-2.amazonaws.com/s.cdpn.io/4124551/ods.css\&#34;\n/\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://codelibrary.opendatasoft.com/css/theme.css\&#34;\n/\u003e\n\n\u003cscript src=\&#34;//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js\&#34;\u003e\u003c/script\u003e\n\u003cscript src=\&#34;//cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.js\&#34;\u003e\u003c/script\u003e\n\u003cscript src=\&#34;//cdnjs.cloudflare.com/ajax/libs/angular-sanitize/1.8.2/angular-sanitize.min.js\&#34;\u003e\u003c/script\u003e\n\u003cscript\n  type=\&#34;text/javascript\&#34;\n  src=\&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.js\&#34;\n\u003e\u003c/script\u003e\n\n\u003cscript\n  type=\&#34;text/javascript\&#34;\n  src=\&#34;https://codelibrary.opendatasoft.com/js/platform-filters.js\&#34;\n\u003e\u003c/script\u003e\n\u003cscript\n  type=\&#34;text/javascript\&#34;\n  src=\&#34;https://codelibrary.opendatasoft.com/js/ods-catalog-card.js\&#34;\n\u003e\u003c/script\u003e\n\n\u003cscript type=\&#34;text/javascript\&#34;\u003e\n  const sourceMonitoringInterceptor = $q =\u003e {\n    return {\n      request: config =\u003e {\n        if (config.params)\n          if (config.params.source) delete config.params.source;\n\n        config.url = config.url.replace(\n          \&#34;ods-api-monitoring\&#34;,\n          \&#34;monitoring-copy\&#34;\n        );\n        return config;\n      }\n    };\n  };\n\n  angular\n    .module(\&#34;ods-widgets\&#34;)\n    .config(function(ODSWidgetsConfigProvider, $httpProvider) {\n      ODSWidgetsConfigProvider.setConfig({\n        defaultDomain: \&#34;https://userclub.opendatasoft.com/\&#34;,\n        basemaps: [\n          {\n            provider: \&#34;jawg.light\&#34;,\n            label: \&#34;Jawg Light\&#34;,\n            jawg_apikey: \&#34;opendatasoft-community\&#34;\n          },\n          {\n            provider: \&#34;jawg.streets\&#34;,\n            label: \&#34;Jawg Streets\&#34;,\n            jawg_apikey: \&#34;opendatasoft-community\&#34;,\n            id: \&#34;streets\&#34;\n          }\n        ],\n        themes: {\n          default: {\n            url: \&#34;/img/ods.svg\&#34;\n          },\n          Santé: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/doctors.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Culture, Patrimoine\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/culture.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Éducation, Formation, Recherche, Enseignement\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/college.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          Environment: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/leaf.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Transports, Déplacements\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/train_station.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Aménagement du territoire, Urbanisme, Bâtiments, Équipements, Logement\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/townplanning.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Économie, Business, PME, Développement économique, Emploi\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/economy.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Administration, Gouvernement, Finances publiques, Citoyenneté\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/administration.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Justice, Sécurité, Police, Crime\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/court.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Sport, Loisirs\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/soccer.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Hébergement, Restauration\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/accommodation.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Services, Social\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/social.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          Checklist: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/copyshop.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          Usages: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/bike.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          }\n        },\n        mapPrependAttribution: \&#34;Jawg apikey NOT suitable for production\&#34;\n      });\n      $httpProvider.interceptors.push(sourceMonitoringInterceptor);\n    });\n\u003c/script\u003e\n&#34;,
                 "editors": 110,
                 "html": &#34;\u003cdiv ng-app=\&#34;ods-widgets\&#34;\u003e\n\u003cdiv class=\&#34;container\&#34;\u003e\n    \u003cods-dataset-context context=\&#34;datum\&#34;\n                         datum-dataset=\&#34;comptage-velo-donnees-compteurs\&#34;\u003e\n        \u003cdiv ng-init=\&#34;variables = {&#39;min&#39;:undefined, &#39;max&#39;:undefined};\n                                  rgbstart = [0,55,237];\n                                  rgbend = [180,197,241];\n                                  xaxis = &#39;day&#39;;\n                                  yaxis = &#39;month&#39;;\n                                  yLegendWidth = 1\&#34;\u003e\n\n            \u003ch3\u003e# of cyclists, by month and day, with bubbles\u003c/h3\u003e\n\n            \u003cdiv ods-adv-analysis=\&#34;results\&#34;\n                 ods-adv-analysis-context=\&#34;datum\&#34;\n                 ods-adv-analysis-select=\&#34;sum(sum_counts) as count\&#34;\n                 ods-adv-analysis-group-by=\&#34;month(date) as {{ yaxis }}, day(date) as {{ xaxis }}\&#34;\n                 ods-adv-analysis-limit=\&#34;-1\&#34;\n                 ods-adv-analysis-order-by=\&#34;month asc, day asc\&#34;\u003e\n                {{\n                variables.numrow = (results | toObject:yaxis | numKeys) ;\n                variables.numcol = (results | toObject:xaxis | numKeys) ;\n                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;\n                variables.listcol = (results | toObject:xaxis | keys | orderBy) ; \&#34;\&#34;}}\n\n                \u003c!--\n                    To compute color ranges and bubble size lateron, you need to get the min and max values from the analysis\n                    this block list all values, and store the min and max in variables each time it finds a new one.\n                --\u003e\n                \u003cspan ng-repeat=\&#34;res in results\&#34;\u003e\n                    {{ variables.min = (!variables.min || res.count \u003c variables.min ? res.count : variables.min); &#39;&#39; }}\n                    {{ variables.max = (!variables.max || res.count \u003e variables.max ? res.count : variables.max); &#39;&#39; }}\n                \u003c/span\u003e\n\n                \u003c!-- the grid --\u003e\n                \u003cdiv class=\&#34;bubblemap\&#34;\n                     ng-class=\&#34;{&#39;display-values&#39;: variables.displayvalues}\&#34;\n                     ng-if=\&#34;variables.min \u0026\u0026 variables.max\&#34;\u003e\n\n                    \u003c!-- X axis : (bottom horizontal) list all values and set the correct position --\u003e\n                    \u003cdiv ng-repeat=\&#34;(i,e) in variables.listcol\&#34;\n                         style=\&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;\n                                grid-row: {{variables.numrow &#43; 1}};\&#34;\u003e\n                        \u003cstrong\u003e{{e}}\u003c/strong\u003e\n                    \u003c/div\u003e\n\n                    \u003c!-- Y axis : (left vertical) list all values and set the correct position --\u003e\n                    \u003cdiv ng-repeat=\&#34;(i,e) in variables.listrow\&#34;\n                         class=\&#34;y-axis\&#34;\n                         style=\&#34;grid-column: 1 / span {{ yLegendWidth }};\n                                grid-row: {{ i &#43; 1 }};\&#34;\u003e\n                        \u003cstrong\u003e{{e}}\u003c/strong\u003e\n                    \u003c/div\u003e\n\n                    \u003c!-- Grid content --\u003e\n                    \u003cdiv class=\&#34;cell square\&#34;\n                         ng-repeat=\&#34;e in results\&#34;\n                         ng-init=\&#34;val = ((e.count - variables.min) / (variables.max - variables.min))\&#34;\n                         style=\&#34;grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};\n                                grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};\&#34;\u003e\n                        \u003cdiv class=\&#34;round\&#34;\n                             style=\&#34;width : {{ ((e.count | math : &#39;sqrt&#39;)/(variables.max|math:&#39;sqrt&#39;))*100 }}%;\n                                    height : {{ ((e.count | math : &#39;sqrt&#39;)/(variables.max|math:&#39;sqrt&#39;))*100 }}%;\n                                    background-color: {{ &#39;rgb(&#39; &#43;\n                                                        ((val * rgbstart[0] &#43; (1 - val) * rgbend[0]) | math : &#39;floor&#39;) &#43;\n                                                        &#39;,&#39; &#43;\n                                                        ((val * rgbstart[1] &#43; (1 - val) * rgbend[1]) | math : &#39;floor&#39;) &#43;\n                                                        &#39;,&#39; &#43;\n                                                        ((val * rgbstart[2] &#43; (1 - val) * rgbend[2]) | math : &#39;floor&#39;) &#43;\n                                                        &#39;)&#39; }};\&#34;\n                             ods-tooltip=\&#34;{{e.count | number}}\&#34;\u003e\n                        \u003c/div\u003e\n                    \u003c/div\u003e\n                \u003c/div\u003e\n\n                \u003cdiv class=\&#34;bubblemap-sub row\&#34;\u003e\n                    \u003cdiv class=\&#34;col-sm-6\&#34;\u003e\n\n                    \u003c/div\u003e\n                    \u003cdiv class=\&#34;col-sm-6\&#34;\u003e\n                        \u003cdiv class=\&#34;bubblemap-legend\&#34;\u003e\n                            \u003cdiv class=\&#34;bubblemap-legend__min-value\&#34;\u003e{{ variables.min | number }}\u003c/div\u003e\n                            \u003cdiv class=\&#34;bubblemap-legend__gradient\&#34;\n                                 style=\&#34;background: linear-gradient(270deg,\n                                                                {{ &#39;rgb(&#39;&#43;rgbstart[0]&#43;&#39;,&#39;&#43;rgbstart[1]&#43;&#39;,&#39;&#43;rgbstart[2]&#43;&#39;)&#39; }},\n                                                                {{ &#39;rgb(&#39;&#43;rgbend[0]&#43;&#39;,&#39;&#43;rgbend[1]&#43;&#39;,&#39;&#43;rgbend[2]&#43;&#39;)&#39; }}\n                                     )\&#34;\u003e\u003c/div\u003e\n                            \u003cdiv class=\&#34;bubblemap-legend__max-value\&#34;\u003e{{ variables.max | number }}\u003c/div\u003e\n                        \u003c/div\u003e\n                    \u003c/div\u003e\n                \u003c/div\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n    \u003c/ods-dataset-context\u003e\n\u003c/div\u003e\n\n\u003c/div\u003e&#34;,
                 "css": &#34;:root {\n    --values-color: white;\n}\n\n.bubblemap {\n    display: grid;\n    gap: 2px;\n    grid-auto-columns: 1fr;\n    grid-auto-flow: column;\n    grid-auto-rows: auto;\n    /* full auto, adapt to the content, ie the font size */\n}\n.bubblemap \u003e * {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    overflow: hidden;\n    font-size: 0.8rem;\n}\n.bubblemap.display-values .cell {\n    font-size: 0.6rem;\n}\n.bubblemap .cell {\n    position: relative;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    overflow: hidden;\n    color: var(--values-color);\n    font-size: 0;\n}\n.bubblemap .cell:hover {\n    transform: scale(1.5);\n    font-size: 0.6rem;\n    z-index: 1;\n}\n.bubblemap .cell.square:before {\n    content: \&#34;\&#34;;\n    display: block;\n    padding-bottom: 100%;\n}\n.bubblemap .cell .round {\n    border-radius: 100%;\n    border: 1px solid black;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.x-axis-centered {\n    text-align: center;\n}\n.x-axis-rotate {\n    transform: rotate(-60deg);\n    padding: 35% 0;\n}\n\n.bubblemap-sub {\n    margin-top: 13px;\n}\n\n.bubblemap-legend {\n    display: flex;\n    width: 100%;\n    justify-content: space-between;\n    align-items: center;\n}\n.bubblemap-legend .bubblemap-legend__gradient {\n    display: block;\n    height: 25px;\n    width: 100%;\n    margin: 0 6px;\n    border: 1px solid darkgray;\n}\n\n.bubblemap-switch {\n    display: flex;\n    align-items: baseline;\n}\n.bubblemap-switch .switch {\n    margin-left: 6px;\n}\n\n/* Button Group Switch\n   ========================================================================== */\n.switch {\n    display: inline-block;\n}\n\n.switch-button {\n    /* background and border when in \&#34;off\&#34; state */\n    background: var(--highlight);\n    border: 2px solid var(--highlight);\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    border-radius: 6px;\n    color: #FFFFFF;\n    position: relative;\n    cursor: pointer;\n    outline: 0;\n    user-select: none;\n}\n\n.switch-input:not(:checked) &#43; .switch-button .switch-button-left {\n    /* text color when in \&#34;off\&#34; state */\n    color: var(--highlight);\n}\n\n.switch-input {\n    display: none;\n}\n\n.switch-button span {\n    font-size: 0.8rem;\n    padding: 0.2rem 0.7rem;\n    text-align: center;\n    z-index: 2;\n    color: #FFFFFF;\n    transition: color 0.2s;\n}\n\n.switch-button::before {\n    content: \&#34;\&#34;;\n    position: absolute;\n    background-color: #FFFFFF;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);\n    border-radius: 4px;\n    top: 0;\n    left: 0;\n    height: 100%;\n    width: 50%;\n    z-index: 1;\n    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;\n}\n\n.switch-button:hover::before {\n    will-change: padding;\n}\n\n.switch-button:active::before {\n    padding-right: 0.4rem;\n}\n\n/* \&#34;On\&#34; state\n   ========================== */\n.switch-input:checked &#43; .switch-button {\n    /* background and border when in \&#34;on\&#34; state */\n    background-color: var(--links);\n    border-color: var(--links);\n}\n\n.switch-input:checked &#43; .switch-button .switch-button-right {\n    /* text color when in \&#34;on\&#34; state */\n    color: var(--links);\n}\n\n.switch-input:checked &#43; .switch-button::before {\n    left: 50%;\n}\n\n.switch-input:checked &#43; .switch-button:active::before {\n    margin-left: -0.4rem;\n}\n\n/* Checkbox in disabled state\n   ========================== */\n.switch-input[type=checkbox]:disabled &#43; .switch-button {\n    opacity: 0.6;\n    cursor: not-allowed;\n}&#34;
               }'>
    </form>
</div>
<div class="ods-content">
    <div class="box-live-example"
      style="height: 550px;">
      <iframe id="iframe-bubblemap-with-dynamic-color-scale"
              width="100%" height="100%"
              src="about:blank"
              srcdoc="
                <head>&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css&#34;
/&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css&#34;
/&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.css&#34;
/&gt;

&lt;!-- ODS Platform CSS - must be hosted on static : WIP --&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://s3-us-west-2.amazonaws.com/s.cdpn.io/4124551/ods.css&#34;
/&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://codelibrary.opendatasoft.com/css/theme.css&#34;
/&gt;

&lt;script src=&#34;//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;//cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;//cdnjs.cloudflare.com/ajax/libs/angular-sanitize/1.8.2/angular-sanitize.min.js&#34;&gt;&lt;/script&gt;
&lt;script
  type=&#34;text/javascript&#34;
  src=&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.js&#34;
&gt;&lt;/script&gt;

&lt;script
  type=&#34;text/javascript&#34;
  src=&#34;https://codelibrary.opendatasoft.com/js/platform-filters.js&#34;
&gt;&lt;/script&gt;
&lt;script
  type=&#34;text/javascript&#34;
  src=&#34;https://codelibrary.opendatasoft.com/js/ods-catalog-card.js&#34;
&gt;&lt;/script&gt;

&lt;script type=&#34;text/javascript&#34;&gt;
  const sourceMonitoringInterceptor = $q =&gt; {
    return {
      request: config =&gt; {
        if (config.params)
          if (config.params.source) delete config.params.source;

        config.url = config.url.replace(
          &#34;ods-api-monitoring&#34;,
          &#34;monitoring-copy&#34;
        );
        return config;
      }
    };
  };

  angular
    .module(&#34;ods-widgets&#34;)
    .config(function(ODSWidgetsConfigProvider, $httpProvider) {
      ODSWidgetsConfigProvider.setConfig({
        defaultDomain: &#34;https://userclub.opendatasoft.com/&#34;,
        basemaps: [
          {
            provider: &#34;jawg.light&#34;,
            label: &#34;Jawg Light&#34;,
            jawg_apikey: &#34;opendatasoft-community&#34;
          },
          {
            provider: &#34;jawg.streets&#34;,
            label: &#34;Jawg Streets&#34;,
            jawg_apikey: &#34;opendatasoft-community&#34;,
            id: &#34;streets&#34;
          }
        ],
        themes: {
          default: {
            url: &#34;/img/ods.svg&#34;
          },
          Santé: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/doctors.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Culture, Patrimoine&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/culture.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Éducation, Formation, Recherche, Enseignement&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/college.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          Environment: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/leaf.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Transports, Déplacements&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/train_station.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Aménagement du territoire, Urbanisme, Bâtiments, Équipements, Logement&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/townplanning.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Économie, Business, PME, Développement économique, Emploi&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/economy.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Administration, Gouvernement, Finances publiques, Citoyenneté&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/administration.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Justice, Sécurité, Police, Crime&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/court.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Sport, Loisirs&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/soccer.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Hébergement, Restauration&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/accommodation.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Services, Social&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/social.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          Checklist: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/copyshop.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          Usages: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/bike.svg&#34;,
            color: &#34;#1446A0&#34;
          }
        },
        mapPrependAttribution: &#34;Jawg apikey NOT suitable for production&#34;
      });
      $httpProvider.interceptors.push(sourceMonitoringInterceptor);
    });
&lt;/script&gt;
</head>
                <base href='https://userclub.opendatasoft.com/'>
                <body>
                <div ng-app='ods-widgets'>&lt;div ng-app=&#34;ods-widgets&#34;&gt;
&lt;div class=&#34;container&#34;&gt;
    &lt;ods-dataset-context context=&#34;datum&#34;
                         datum-dataset=&#34;comptage-velo-donnees-compteurs&#34;&gt;
        &lt;div ng-init=&#34;variables = {&#39;min&#39;:undefined, &#39;max&#39;:undefined};
                                  rgbstart = [0,55,237];
                                  rgbend = [180,197,241];
                                  xaxis = &#39;day&#39;;
                                  yaxis = &#39;month&#39;;
                                  yLegendWidth = 1&#34;&gt;

            &lt;h3&gt;# of cyclists, by month and day, with bubbles&lt;/h3&gt;

            &lt;div ods-adv-analysis=&#34;results&#34;
                 ods-adv-analysis-context=&#34;datum&#34;
                 ods-adv-analysis-select=&#34;sum(sum_counts) as count&#34;
                 ods-adv-analysis-group-by=&#34;month(date) as {{ yaxis }}, day(date) as {{ xaxis }}&#34;
                 ods-adv-analysis-limit=&#34;-1&#34;
                 ods-adv-analysis-order-by=&#34;month asc, day asc&#34;&gt;
                {{
                variables.numrow = (results | toObject:yaxis | numKeys) ;
                variables.numcol = (results | toObject:xaxis | numKeys) ;
                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;
                variables.listcol = (results | toObject:xaxis | keys | orderBy) ; &#34;&#34;}}

                &lt;!--
                    To compute color ranges and bubble size lateron, you need to get the min and max values from the analysis
                    this block list all values, and store the min and max in variables each time it finds a new one.
                --&gt;
                &lt;span ng-repeat=&#34;res in results&#34;&gt;
                    {{ variables.min = (!variables.min || res.count &lt; variables.min ? res.count : variables.min); &#39;&#39; }}
                    {{ variables.max = (!variables.max || res.count &gt; variables.max ? res.count : variables.max); &#39;&#39; }}
                &lt;/span&gt;

                &lt;!-- the grid --&gt;
                &lt;div class=&#34;bubblemap&#34;
                     ng-class=&#34;{&#39;display-values&#39;: variables.displayvalues}&#34;
                     ng-if=&#34;variables.min &amp;&amp; variables.max&#34;&gt;

                    &lt;!-- X axis : (bottom horizontal) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listcol&#34;
                         style=&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;
                                grid-row: {{variables.numrow &#43; 1}};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Y axis : (left vertical) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listrow&#34;
                         class=&#34;y-axis&#34;
                         style=&#34;grid-column: 1 / span {{ yLegendWidth }};
                                grid-row: {{ i &#43; 1 }};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Grid content --&gt;
                    &lt;div class=&#34;cell square&#34;
                         ng-repeat=&#34;e in results&#34;
                         ng-init=&#34;val = ((e.count - variables.min) / (variables.max - variables.min))&#34;
                         style=&#34;grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};
                                grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};&#34;&gt;
                        &lt;div class=&#34;round&#34;
                             style=&#34;width : {{ ((e.count | math : &#39;sqrt&#39;)/(variables.max|math:&#39;sqrt&#39;))*100 }}%;
                                    height : {{ ((e.count | math : &#39;sqrt&#39;)/(variables.max|math:&#39;sqrt&#39;))*100 }}%;
                                    background-color: {{ &#39;rgb(&#39; &#43;
                                                        ((val * rgbstart[0] &#43; (1 - val) * rgbend[0]) | math : &#39;floor&#39;) &#43;
                                                        &#39;,&#39; &#43;
                                                        ((val * rgbstart[1] &#43; (1 - val) * rgbend[1]) | math : &#39;floor&#39;) &#43;
                                                        &#39;,&#39; &#43;
                                                        ((val * rgbstart[2] &#43; (1 - val) * rgbend[2]) | math : &#39;floor&#39;) &#43;
                                                        &#39;)&#39; }};&#34;
                             ods-tooltip=&#34;{{e.count | number}}&#34;&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;

                &lt;div class=&#34;bubblemap-sub row&#34;&gt;
                    &lt;div class=&#34;col-sm-6&#34;&gt;

                    &lt;/div&gt;
                    &lt;div class=&#34;col-sm-6&#34;&gt;
                        &lt;div class=&#34;bubblemap-legend&#34;&gt;
                            &lt;div class=&#34;bubblemap-legend__min-value&#34;&gt;{{ variables.min | number }}&lt;/div&gt;
                            &lt;div class=&#34;bubblemap-legend__gradient&#34;
                                 style=&#34;background: linear-gradient(270deg,
                                                                {{ &#39;rgb(&#39;&#43;rgbstart[0]&#43;&#39;,&#39;&#43;rgbstart[1]&#43;&#39;,&#39;&#43;rgbstart[2]&#43;&#39;)&#39; }},
                                                                {{ &#39;rgb(&#39;&#43;rgbend[0]&#43;&#39;,&#39;&#43;rgbend[1]&#43;&#39;,&#39;&#43;rgbend[2]&#43;&#39;)&#39; }}
                                     )&#34;&gt;&lt;/div&gt;
                            &lt;div class=&#34;bubblemap-legend__max-value&#34;&gt;{{ variables.max | number }}&lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/ods-dataset-context&gt;
&lt;/div&gt;

&lt;/div&gt;</div>
                <style type='text/css'>
                    :root {
    --values-color: white;
}

.bubblemap {
    display: grid;
    gap: 2px;
    grid-auto-columns: 1fr;
    grid-auto-flow: column;
    grid-auto-rows: auto;
    /* full auto, adapt to the content, ie the font size */
}
.bubblemap &gt; * {
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    font-size: 0.8rem;
}
.bubblemap.display-values .cell {
    font-size: 0.6rem;
}
.bubblemap .cell {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    color: var(--values-color);
    font-size: 0;
}
.bubblemap .cell:hover {
    transform: scale(1.5);
    font-size: 0.6rem;
    z-index: 1;
}
.bubblemap .cell.square:before {
    content: &#34;&#34;;
    display: block;
    padding-bottom: 100%;
}
.bubblemap .cell .round {
    border-radius: 100%;
    border: 1px solid black;
    display: flex;
    justify-content: center;
    align-items: center;
}

.x-axis-centered {
    text-align: center;
}
.x-axis-rotate {
    transform: rotate(-60deg);
    padding: 35% 0;
}

.bubblemap-sub {
    margin-top: 13px;
}

.bubblemap-legend {
    display: flex;
    width: 100%;
    justify-content: space-between;
    align-items: center;
}
.bubblemap-legend .bubblemap-legend__gradient {
    display: block;
    height: 25px;
    width: 100%;
    margin: 0 6px;
    border: 1px solid darkgray;
}

.bubblemap-switch {
    display: flex;
    align-items: baseline;
}
.bubblemap-switch .switch {
    margin-left: 6px;
}

/* Button Group Switch
   ========================================================================== */
.switch {
    display: inline-block;
}

.switch-button {
    /* background and border when in &#34;off&#34; state */
    background: var(--highlight);
    border: 2px solid var(--highlight);
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-radius: 6px;
    color: #FFFFFF;
    position: relative;
    cursor: pointer;
    outline: 0;
    user-select: none;
}

.switch-input:not(:checked) &#43; .switch-button .switch-button-left {
    /* text color when in &#34;off&#34; state */
    color: var(--highlight);
}

.switch-input {
    display: none;
}

.switch-button span {
    font-size: 0.8rem;
    padding: 0.2rem 0.7rem;
    text-align: center;
    z-index: 2;
    color: #FFFFFF;
    transition: color 0.2s;
}

.switch-button::before {
    content: &#34;&#34;;
    position: absolute;
    background-color: #FFFFFF;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    border-radius: 4px;
    top: 0;
    left: 0;
    height: 100%;
    width: 50%;
    z-index: 1;
    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;
}

.switch-button:hover::before {
    will-change: padding;
}

.switch-button:active::before {
    padding-right: 0.4rem;
}

/* &#34;On&#34; state
   ========================== */
.switch-input:checked &#43; .switch-button {
    /* background and border when in &#34;on&#34; state */
    background-color: var(--links);
    border-color: var(--links);
}

.switch-input:checked &#43; .switch-button .switch-button-right {
    /* text color when in &#34;on&#34; state */
    color: var(--links);
}

.switch-input:checked &#43; .switch-button::before {
    left: 50%;
}

.switch-input:checked &#43; .switch-button:active::before {
    margin-left: -0.4rem;
}

/* Checkbox in disabled state
   ========================== */
.switch-input[type=checkbox]:disabled &#43; .switch-button {
    opacity: 0.6;
    cursor: not-allowed;
}
                </style>
                </body>
              ">
      </iframe>
      <div class="show-code buttons has-addons">
          <button class="button is-light">
            <span>Show code</span>
          </button>
          <button class="button is-light"
             target="_blank"
             aria-role="link"
             rel="noopener"
             title="Edit on CodePen, open a new tab"
             onclick="document.getElementById('form-bubblemap-with-dynamic-color-scale').submit()">
              <span>Edit on Codepen</span>
              <span class="icon is-small">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                  <use xlink:href="#external"></use>
                </svg>
              </span>
          </button>
      </div>
    </div>
    <div class="box-code js-tabs is-hidden">
        <nav class="level is-mobile">
            <div class="level-left">
                <div class="level-item">
                    <div class="buttons has-addons js-tablist">
                        <a
                          class="button is-primary is-outlined js-tablist__item js-tablist__link"
                          href="#code-bubblemap-with-dynamic-color-scale-html-content"
                        >
                          HTML
                        </a>
                        
                        <a
                          class="button is-primary is-outlined js-tablist__item js-tablist__link"
                          href="#code-bubblemap-with-dynamic-color-scale-css-content"
                        >
                          CSS
                        </a>
                        
                    </div>
                </div>
            </div>
            <div class="level-right">
                <button class="copy-to-cc button is-primary is-outlined is-rounded has-tooltip-left"
                  data-tooltip="Copy to clipboard"
                  aria-role="button"
                  title="Edit on CodePen, open a new tab"
                >
                  <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                      <use xlink:href="#copy"></use>
                    </svg>
                  </span>
                </button>
                <button class="copied-to-cc button is-success is-outlined is-rounded has-tooltip-left is-hidden"
                  data-tooltip="Copied"
                  aria-role="button"
                  title="Copied"
                >
                  <figure class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                      <use xlink:href="#check"></use>
                    </svg>
                  </figure>
                </button>
            </div>
        </nav>
        <div class="tab-content">
            <div class="js-tabcontent"
                 id="code-bubblemap-with-dynamic-color-scale-html-content"
                 data-clipboard="&lt;div class=&#34;container&#34;&gt;
    &lt;ods-dataset-context context=&#34;datum&#34;
                         datum-dataset=&#34;comptage-velo-donnees-compteurs&#34;&gt;
        &lt;div ng-init=&#34;variables = {&#39;min&#39;:undefined, &#39;max&#39;:undefined};
                                  rgbstart = [0,55,237];
                                  rgbend = [180,197,241];
                                  xaxis = &#39;day&#39;;
                                  yaxis = &#39;month&#39;;
                                  yLegendWidth = 1&#34;&gt;

            &lt;h3&gt;# of cyclists, by month and day, with bubbles&lt;/h3&gt;

            &lt;div ods-adv-analysis=&#34;results&#34;
                 ods-adv-analysis-context=&#34;datum&#34;
                 ods-adv-analysis-select=&#34;sum(sum_counts) as count&#34;
                 ods-adv-analysis-group-by=&#34;month(date) as {{ yaxis }}, day(date) as {{ xaxis }}&#34;
                 ods-adv-analysis-limit=&#34;-1&#34;
                 ods-adv-analysis-order-by=&#34;month asc, day asc&#34;&gt;
                {{
                variables.numrow = (results | toObject:yaxis | numKeys) ;
                variables.numcol = (results | toObject:xaxis | numKeys) ;
                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;
                variables.listcol = (results | toObject:xaxis | keys | orderBy) ; &#34;&#34;}}

                &lt;!--
                    To compute color ranges and bubble size lateron, you need to get the min and max values from the analysis
                    this block list all values, and store the min and max in variables each time it finds a new one.
                --&gt;
                &lt;span ng-repeat=&#34;res in results&#34;&gt;
                    {{ variables.min = (!variables.min || res.count &lt; variables.min ? res.count : variables.min); &#39;&#39; }}
                    {{ variables.max = (!variables.max || res.count &gt; variables.max ? res.count : variables.max); &#39;&#39; }}
                &lt;/span&gt;

                &lt;!-- the grid --&gt;
                &lt;div class=&#34;bubblemap&#34;
                     ng-class=&#34;{&#39;display-values&#39;: variables.displayvalues}&#34;
                     ng-if=&#34;variables.min &amp;&amp; variables.max&#34;&gt;

                    &lt;!-- X axis : (bottom horizontal) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listcol&#34;
                         style=&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;
                                grid-row: {{variables.numrow &#43; 1}};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Y axis : (left vertical) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listrow&#34;
                         class=&#34;y-axis&#34;
                         style=&#34;grid-column: 1 / span {{ yLegendWidth }};
                                grid-row: {{ i &#43; 1 }};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Grid content --&gt;
                    &lt;div class=&#34;cell square&#34;
                         ng-repeat=&#34;e in results&#34;
                         ng-init=&#34;val = ((e.count - variables.min) / (variables.max - variables.min))&#34;
                         style=&#34;grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};
                                grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};&#34;&gt;
                        &lt;div class=&#34;round&#34;
                             style=&#34;width : {{ ((e.count | math : &#39;sqrt&#39;)/(variables.max|math:&#39;sqrt&#39;))*100 }}%;
                                    height : {{ ((e.count | math : &#39;sqrt&#39;)/(variables.max|math:&#39;sqrt&#39;))*100 }}%;
                                    background-color: {{ &#39;rgb(&#39; &#43;
                                                        ((val * rgbstart[0] &#43; (1 - val) * rgbend[0]) | math : &#39;floor&#39;) &#43;
                                                        &#39;,&#39; &#43;
                                                        ((val * rgbstart[1] &#43; (1 - val) * rgbend[1]) | math : &#39;floor&#39;) &#43;
                                                        &#39;,&#39; &#43;
                                                        ((val * rgbstart[2] &#43; (1 - val) * rgbend[2]) | math : &#39;floor&#39;) &#43;
                                                        &#39;)&#39; }};&#34;
                             ods-tooltip=&#34;{{e.count | number}}&#34;&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;

                &lt;div class=&#34;bubblemap-sub row&#34;&gt;
                    &lt;div class=&#34;col-sm-6&#34;&gt;

                    &lt;/div&gt;
                    &lt;div class=&#34;col-sm-6&#34;&gt;
                        &lt;div class=&#34;bubblemap-legend&#34;&gt;
                            &lt;div class=&#34;bubblemap-legend__min-value&#34;&gt;{{ variables.min | number }}&lt;/div&gt;
                            &lt;div class=&#34;bubblemap-legend__gradient&#34;
                                 style=&#34;background: linear-gradient(270deg,
                                                                {{ &#39;rgb(&#39;&#43;rgbstart[0]&#43;&#39;,&#39;&#43;rgbstart[1]&#43;&#39;,&#39;&#43;rgbstart[2]&#43;&#39;)&#39; }},
                                                                {{ &#39;rgb(&#39;&#43;rgbend[0]&#43;&#39;,&#39;&#43;rgbend[1]&#43;&#39;,&#39;&#43;rgbend[2]&#43;&#39;)&#39; }}
                                     )&#34;&gt;&lt;/div&gt;
                            &lt;div class=&#34;bubblemap-legend__max-value&#34;&gt;{{ variables.max | number }}&lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/ods-dataset-context&gt;
&lt;/div&gt;

"
                 role="tabpanel">
                <div class="highlight">
                    <pre class="language-html" data-lang="html"><code>&lt;div class=&#34;container&#34;&gt;
    &lt;ods-dataset-context context=&#34;datum&#34;
                         datum-dataset=&#34;comptage-velo-donnees-compteurs&#34;&gt;
        &lt;div ng-init=&#34;variables = {&#39;min&#39;:undefined, &#39;max&#39;:undefined};
                                  rgbstart = [0,55,237];
                                  rgbend = [180,197,241];
                                  xaxis = &#39;day&#39;;
                                  yaxis = &#39;month&#39;;
                                  yLegendWidth = 1&#34;&gt;

            &lt;h3&gt;# of cyclists, by month and day, with bubbles&lt;/h3&gt;

            &lt;div ods-adv-analysis=&#34;results&#34;
                 ods-adv-analysis-context=&#34;datum&#34;
                 ods-adv-analysis-select=&#34;sum(sum_counts) as count&#34;
                 ods-adv-analysis-group-by=&#34;month(date) as {{ yaxis }}, day(date) as {{ xaxis }}&#34;
                 ods-adv-analysis-limit=&#34;-1&#34;
                 ods-adv-analysis-order-by=&#34;month asc, day asc&#34;&gt;
                {{
                variables.numrow = (results | toObject:yaxis | numKeys) ;
                variables.numcol = (results | toObject:xaxis | numKeys) ;
                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;
                variables.listcol = (results | toObject:xaxis | keys | orderBy) ; &#34;&#34;}}

                &lt;!--
                    To compute color ranges and bubble size lateron, you need to get the min and max values from the analysis
                    this block list all values, and store the min and max in variables each time it finds a new one.
                --&gt;
                &lt;span ng-repeat=&#34;res in results&#34;&gt;
                    {{ variables.min = (!variables.min || res.count &lt; variables.min ? res.count : variables.min); &#39;&#39; }}
                    {{ variables.max = (!variables.max || res.count &gt; variables.max ? res.count : variables.max); &#39;&#39; }}
                &lt;/span&gt;

                &lt;!-- the grid --&gt;
                &lt;div class=&#34;bubblemap&#34;
                     ng-class=&#34;{&#39;display-values&#39;: variables.displayvalues}&#34;
                     ng-if=&#34;variables.min &amp;&amp; variables.max&#34;&gt;

                    &lt;!-- X axis : (bottom horizontal) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listcol&#34;
                         style=&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;
                                grid-row: {{variables.numrow &#43; 1}};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Y axis : (left vertical) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listrow&#34;
                         class=&#34;y-axis&#34;
                         style=&#34;grid-column: 1 / span {{ yLegendWidth }};
                                grid-row: {{ i &#43; 1 }};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Grid content --&gt;
                    &lt;div class=&#34;cell square&#34;
                         ng-repeat=&#34;e in results&#34;
                         ng-init=&#34;val = ((e.count - variables.min) / (variables.max - variables.min))&#34;
                         style=&#34;grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};
                                grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};&#34;&gt;
                        &lt;div class=&#34;round&#34;
                             style=&#34;width : {{ ((e.count | math : &#39;sqrt&#39;)/(variables.max|math:&#39;sqrt&#39;))*100 }}%;
                                    height : {{ ((e.count | math : &#39;sqrt&#39;)/(variables.max|math:&#39;sqrt&#39;))*100 }}%;
                                    background-color: {{ &#39;rgb(&#39; &#43;
                                                        ((val * rgbstart[0] &#43; (1 - val) * rgbend[0]) | math : &#39;floor&#39;) &#43;
                                                        &#39;,&#39; &#43;
                                                        ((val * rgbstart[1] &#43; (1 - val) * rgbend[1]) | math : &#39;floor&#39;) &#43;
                                                        &#39;,&#39; &#43;
                                                        ((val * rgbstart[2] &#43; (1 - val) * rgbend[2]) | math : &#39;floor&#39;) &#43;
                                                        &#39;)&#39; }};&#34;
                             ods-tooltip=&#34;{{e.count | number}}&#34;&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;

                &lt;div class=&#34;bubblemap-sub row&#34;&gt;
                    &lt;div class=&#34;col-sm-6&#34;&gt;

                    &lt;/div&gt;
                    &lt;div class=&#34;col-sm-6&#34;&gt;
                        &lt;div class=&#34;bubblemap-legend&#34;&gt;
                            &lt;div class=&#34;bubblemap-legend__min-value&#34;&gt;{{ variables.min | number }}&lt;/div&gt;
                            &lt;div class=&#34;bubblemap-legend__gradient&#34;
                                 style=&#34;background: linear-gradient(270deg,
                                                                {{ &#39;rgb(&#39;&#43;rgbstart[0]&#43;&#39;,&#39;&#43;rgbstart[1]&#43;&#39;,&#39;&#43;rgbstart[2]&#43;&#39;)&#39; }},
                                                                {{ &#39;rgb(&#39;&#43;rgbend[0]&#43;&#39;,&#39;&#43;rgbend[1]&#43;&#39;,&#39;&#43;rgbend[2]&#43;&#39;)&#39; }}
                                     )&#34;&gt;&lt;/div&gt;
                            &lt;div class=&#34;bubblemap-legend__max-value&#34;&gt;{{ variables.max | number }}&lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/ods-dataset-context&gt;
&lt;/div&gt;

</code></pre>
                </div>
            </div>
            
            <div class="js-tabcontent"
                 id="code-bubblemap-with-dynamic-color-scale-css-content"
                 data-clipboard=":root {
    --values-color: white;
}

.bubblemap {
    display: grid;
    gap: 2px;
    grid-auto-columns: 1fr;
    grid-auto-flow: column;
    grid-auto-rows: auto;
    /* full auto, adapt to the content, ie the font size */
}
.bubblemap &gt; * {
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    font-size: 0.8rem;
}
.bubblemap.display-values .cell {
    font-size: 0.6rem;
}
.bubblemap .cell {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    color: var(--values-color);
    font-size: 0;
}
.bubblemap .cell:hover {
    transform: scale(1.5);
    font-size: 0.6rem;
    z-index: 1;
}
.bubblemap .cell.square:before {
    content: &#34;&#34;;
    display: block;
    padding-bottom: 100%;
}
.bubblemap .cell .round {
    border-radius: 100%;
    border: 1px solid black;
    display: flex;
    justify-content: center;
    align-items: center;
}

.x-axis-centered {
    text-align: center;
}
.x-axis-rotate {
    transform: rotate(-60deg);
    padding: 35% 0;
}

.bubblemap-sub {
    margin-top: 13px;
}

.bubblemap-legend {
    display: flex;
    width: 100%;
    justify-content: space-between;
    align-items: center;
}
.bubblemap-legend .bubblemap-legend__gradient {
    display: block;
    height: 25px;
    width: 100%;
    margin: 0 6px;
    border: 1px solid darkgray;
}

.bubblemap-switch {
    display: flex;
    align-items: baseline;
}
.bubblemap-switch .switch {
    margin-left: 6px;
}

/* Button Group Switch
   ========================================================================== */
.switch {
    display: inline-block;
}

.switch-button {
    /* background and border when in &#34;off&#34; state */
    background: var(--highlight);
    border: 2px solid var(--highlight);
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-radius: 6px;
    color: #FFFFFF;
    position: relative;
    cursor: pointer;
    outline: 0;
    user-select: none;
}

.switch-input:not(:checked) &#43; .switch-button .switch-button-left {
    /* text color when in &#34;off&#34; state */
    color: var(--highlight);
}

.switch-input {
    display: none;
}

.switch-button span {
    font-size: 0.8rem;
    padding: 0.2rem 0.7rem;
    text-align: center;
    z-index: 2;
    color: #FFFFFF;
    transition: color 0.2s;
}

.switch-button::before {
    content: &#34;&#34;;
    position: absolute;
    background-color: #FFFFFF;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    border-radius: 4px;
    top: 0;
    left: 0;
    height: 100%;
    width: 50%;
    z-index: 1;
    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;
}

.switch-button:hover::before {
    will-change: padding;
}

.switch-button:active::before {
    padding-right: 0.4rem;
}

/* &#34;On&#34; state
   ========================== */
.switch-input:checked &#43; .switch-button {
    /* background and border when in &#34;on&#34; state */
    background-color: var(--links);
    border-color: var(--links);
}

.switch-input:checked &#43; .switch-button .switch-button-right {
    /* text color when in &#34;on&#34; state */
    color: var(--links);
}

.switch-input:checked &#43; .switch-button::before {
    left: 50%;
}

.switch-input:checked &#43; .switch-button:active::before {
    margin-left: -0.4rem;
}

/* Checkbox in disabled state
   ========================== */
.switch-input[type=checkbox]:disabled &#43; .switch-button {
    opacity: 0.6;
    cursor: not-allowed;
}">
                <div class="highlight">
                    <pre class="language-css" data-lang="css"><code>:root {
    --values-color: white;
}

.bubblemap {
    display: grid;
    gap: 2px;
    grid-auto-columns: 1fr;
    grid-auto-flow: column;
    grid-auto-rows: auto;
    /* full auto, adapt to the content, ie the font size */
}
.bubblemap &gt; * {
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    font-size: 0.8rem;
}
.bubblemap.display-values .cell {
    font-size: 0.6rem;
}
.bubblemap .cell {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    color: var(--values-color);
    font-size: 0;
}
.bubblemap .cell:hover {
    transform: scale(1.5);
    font-size: 0.6rem;
    z-index: 1;
}
.bubblemap .cell.square:before {
    content: &#34;&#34;;
    display: block;
    padding-bottom: 100%;
}
.bubblemap .cell .round {
    border-radius: 100%;
    border: 1px solid black;
    display: flex;
    justify-content: center;
    align-items: center;
}

.x-axis-centered {
    text-align: center;
}
.x-axis-rotate {
    transform: rotate(-60deg);
    padding: 35% 0;
}

.bubblemap-sub {
    margin-top: 13px;
}

.bubblemap-legend {
    display: flex;
    width: 100%;
    justify-content: space-between;
    align-items: center;
}
.bubblemap-legend .bubblemap-legend__gradient {
    display: block;
    height: 25px;
    width: 100%;
    margin: 0 6px;
    border: 1px solid darkgray;
}

.bubblemap-switch {
    display: flex;
    align-items: baseline;
}
.bubblemap-switch .switch {
    margin-left: 6px;
}

/* Button Group Switch
   ========================================================================== */
.switch {
    display: inline-block;
}

.switch-button {
    /* background and border when in &#34;off&#34; state */
    background: var(--highlight);
    border: 2px solid var(--highlight);
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-radius: 6px;
    color: #FFFFFF;
    position: relative;
    cursor: pointer;
    outline: 0;
    user-select: none;
}

.switch-input:not(:checked) &#43; .switch-button .switch-button-left {
    /* text color when in &#34;off&#34; state */
    color: var(--highlight);
}

.switch-input {
    display: none;
}

.switch-button span {
    font-size: 0.8rem;
    padding: 0.2rem 0.7rem;
    text-align: center;
    z-index: 2;
    color: #FFFFFF;
    transition: color 0.2s;
}

.switch-button::before {
    content: &#34;&#34;;
    position: absolute;
    background-color: #FFFFFF;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    border-radius: 4px;
    top: 0;
    left: 0;
    height: 100%;
    width: 50%;
    z-index: 1;
    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;
}

.switch-button:hover::before {
    will-change: padding;
}

.switch-button:active::before {
    padding-right: 0.4rem;
}

/* &#34;On&#34; state
   ========================== */
.switch-input:checked &#43; .switch-button {
    /* background and border when in &#34;on&#34; state */
    background-color: var(--links);
    border-color: var(--links);
}

.switch-input:checked &#43; .switch-button .switch-button-right {
    /* text color when in &#34;on&#34; state */
    color: var(--links);
}

.switch-input:checked &#43; .switch-button::before {
    left: 50%;
}

.switch-input:checked &#43; .switch-button:active::before {
    margin-left: -0.4rem;
}

/* Checkbox in disabled state
   ========================== */
.switch-input[type=checkbox]:disabled &#43; .switch-button {
    opacity: 0.6;
    cursor: not-allowed;
}</code></pre>
                </div>
            </div>
            
        </div>
    </div>
</div>

      </div>
    </article>
    
    <article class="block">
      <h2 class="title is-2" id="heatmap-with-larger-text-in-legends">
        Heatmap with larger text in legends 
        <a class="is-link anchor" href="#heatmap-with-larger-text-in-legends">
          <span class="icon">
            <img src="/img/fas-link.svg" />
          </span>
        </a>
      </h2>
      <div class="content">
        <p>Sometimes, the Y legend will need more than 1 column in the grid to display correctly.
The <code>yLegendWidth = 2</code> option in this example set 2 column width for Y legend values.</p>
<p>The X legend can be centered, and a slight rotation can give some space and visibility.
Two CSS classes are proposed to achieve this : <code>x-axis-centered</code> and <code>x-axis-rotate</code> to set on the X axis loop (HTML side).</p>

      </div>
      
      <div class="box">
        






    




<div class="codepen">
    <form id="form-heatmap-with-larger-text-in-legends"
          action="https://codepen.io/pen/define"
          method="POST"
          target="_blank">
        <input type="hidden"
               name="data"
               value='{
                 "title": "New Pen!",
                 "head": &#34;\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css\&#34;\n/\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\&#34;\n/\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.css\&#34;\n/\u003e\n\n\u003c!-- ODS Platform CSS - must be hosted on static : WIP --\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://s3-us-west-2.amazonaws.com/s.cdpn.io/4124551/ods.css\&#34;\n/\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://codelibrary.opendatasoft.com/css/theme.css\&#34;\n/\u003e\n\n\u003cscript src=\&#34;//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js\&#34;\u003e\u003c/script\u003e\n\u003cscript src=\&#34;//cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.js\&#34;\u003e\u003c/script\u003e\n\u003cscript src=\&#34;//cdnjs.cloudflare.com/ajax/libs/angular-sanitize/1.8.2/angular-sanitize.min.js\&#34;\u003e\u003c/script\u003e\n\u003cscript\n  type=\&#34;text/javascript\&#34;\n  src=\&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.js\&#34;\n\u003e\u003c/script\u003e\n\n\u003cscript\n  type=\&#34;text/javascript\&#34;\n  src=\&#34;https://codelibrary.opendatasoft.com/js/platform-filters.js\&#34;\n\u003e\u003c/script\u003e\n\u003cscript\n  type=\&#34;text/javascript\&#34;\n  src=\&#34;https://codelibrary.opendatasoft.com/js/ods-catalog-card.js\&#34;\n\u003e\u003c/script\u003e\n\n\u003cscript type=\&#34;text/javascript\&#34;\u003e\n  const sourceMonitoringInterceptor = $q =\u003e {\n    return {\n      request: config =\u003e {\n        if (config.params)\n          if (config.params.source) delete config.params.source;\n\n        config.url = config.url.replace(\n          \&#34;ods-api-monitoring\&#34;,\n          \&#34;monitoring-copy\&#34;\n        );\n        return config;\n      }\n    };\n  };\n\n  angular\n    .module(\&#34;ods-widgets\&#34;)\n    .config(function(ODSWidgetsConfigProvider, $httpProvider) {\n      ODSWidgetsConfigProvider.setConfig({\n        defaultDomain: \&#34;https://userclub.opendatasoft.com/\&#34;,\n        basemaps: [\n          {\n            provider: \&#34;jawg.light\&#34;,\n            label: \&#34;Jawg Light\&#34;,\n            jawg_apikey: \&#34;opendatasoft-community\&#34;\n          },\n          {\n            provider: \&#34;jawg.streets\&#34;,\n            label: \&#34;Jawg Streets\&#34;,\n            jawg_apikey: \&#34;opendatasoft-community\&#34;,\n            id: \&#34;streets\&#34;\n          }\n        ],\n        themes: {\n          default: {\n            url: \&#34;/img/ods.svg\&#34;\n          },\n          Santé: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/doctors.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Culture, Patrimoine\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/culture.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Éducation, Formation, Recherche, Enseignement\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/college.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          Environment: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/leaf.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Transports, Déplacements\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/train_station.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Aménagement du territoire, Urbanisme, Bâtiments, Équipements, Logement\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/townplanning.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Économie, Business, PME, Développement économique, Emploi\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/economy.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Administration, Gouvernement, Finances publiques, Citoyenneté\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/administration.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Justice, Sécurité, Police, Crime\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/court.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Sport, Loisirs\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/soccer.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Hébergement, Restauration\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/accommodation.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Services, Social\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/social.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          Checklist: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/copyshop.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          Usages: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/bike.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          }\n        },\n        mapPrependAttribution: \&#34;Jawg apikey NOT suitable for production\&#34;\n      });\n      $httpProvider.interceptors.push(sourceMonitoringInterceptor);\n    });\n\u003c/script\u003e\n&#34;,
                 "editors": 110,
                 "html": &#34;\u003cdiv ng-app=\&#34;ods-widgets\&#34;\u003e\n\u003cdiv class=\&#34;container\&#34;\u003e\n    \u003cods-dataset-context context=\&#34;datum\&#34;\n                         datum-dataset=\&#34;base-nationale-des-lieux-de-covoiturage-en-france\&#34;\u003e\n\n        \u003cdiv ng-init=\&#34;variables = {&#39;min&#39;:undefined, &#39;max&#39;:undefined};\n                                  rgbstart = [0,55,237];\n                                  rgbend = [180,197,241];\n                                  xaxis = &#39;type&#39;;\n                                  yaxis = &#39;region&#39;;\n                                  yLegendWidth = 2\&#34;\u003e\n\n            \u003ch3\u003e# of car parks by region and by type\u003c/h3\u003e\n            \u003c!--\n                group-by month and day, then for each group by dimension, with toObject and keys filter we get the list of all values.\n                it constructs the x and y axis by listing all different values for each axis.\n\n                xaxis and yaxis variables are here to avoid using specific id at several places in the code.\n                therefore, be sure to name your adv-analysis group-by accordingly.\n            --\u003e\n            \u003cdiv ods-adv-analysis=\&#34;results\&#34;\n                 ods-adv-analysis-context=\&#34;datum\&#34;\n                 ods-adv-analysis-select=\&#34;sum(spot_size) as count\&#34;\n                 ods-adv-analysis-group-by=\&#34;reg_name as {{ yaxis }}, spot_type as {{ xaxis }}\&#34;\u003e\n                {{\n                variables.numrow = (results | toObject:yaxis | numKeys) ;\n                variables.numcol = (results | toObject:xaxis | numKeys) ;\n                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;\n                variables.listcol = (results | toObject:xaxis | keys | orderBy) ;\n                \&#34;\&#34;\n                }}\n\n                \u003c!--\n                    To compute color ranges lateron, you need to get the min and max values from the analysis\n                    this block list all values, and store the min and max in variables each time it finds a new one.\n                --\u003e\n                \u003cspan ng-repeat=\&#34;res in results\&#34;\u003e\n                    {{ variables.min = (!variables.min || res.count \u003c variables.min ? res.count : variables.min); &#39;&#39; }}\n                    {{ variables.max = (!variables.max || res.count \u003e variables.max ? res.count : variables.max); &#39;&#39; }}\n                \u003c/span\u003e\n\n                \u003c!-- The grid --\u003e\n                \u003cdiv class=\&#34;heatmap\&#34;\n                     ng-class=\&#34;{&#39;display-values&#39;: variables.displayvalues}\&#34;\n                     ng-if=\&#34;variables.min \u0026\u0026 variables.max\&#34;\u003e\n\n                    \u003c!-- X axis : (bottom horizontal) list all values and set the correct position --\u003e\n                    \u003cdiv ng-repeat=\&#34;(i,e) in variables.listcol\&#34;\n                         class=\&#34;x-axis-centered x-axis-rotate\&#34;\n                         style=\&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;\n                                grid-row: {{variables.numrow &#43; 1}};\&#34;\u003e\n                        \u003cstrong\u003e{{e}}\u003c/strong\u003e\n                    \u003c/div\u003e\n\n                    \u003c!-- Y axis : (left vertical) list all values and set the correct position --\u003e\n                    \u003cdiv ng-repeat=\&#34;(i,e) in variables.listrow\&#34;\n                         class=\&#34;y-axis\&#34;\n                         style=\&#34;grid-column: 1 / span {{ yLegendWidth }};\n                                grid-row: {{ i &#43; 1 }};\&#34;\u003e\n                        \u003cstrong\u003e{{e}}\u003c/strong\u003e\n                    \u003c/div\u003e\n\n                    \u003c!-- Grid content --\u003e\n                    \u003cdiv class=\&#34;cell\&#34;\n                         ng-repeat=\&#34;e in results\&#34;\n                         ng-init=\&#34;val = ((e.count - variables.min) / (variables.max - variables.min))\&#34;\n                         style=\&#34;background-color: {{ &#39;rgb(&#39; &#43;\n                                                    ((val * rgbstart[0] &#43; (1 - val) * rgbend[0]) | math : &#39;floor&#39;) &#43;\n                                                    &#39;,&#39; &#43;\n                                                    ((val * rgbstart[1] &#43; (1 - val) * rgbend[1]) | math : &#39;floor&#39;) &#43;\n                                                    &#39;,&#39; &#43;\n                                                    ((val * rgbstart[2] &#43; (1 - val) * rgbend[2]) | math : &#39;floor&#39;) &#43;\n                                                    &#39;)&#39; }};\n                                               grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};\n                                               grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};\&#34;\u003e\n                        {{e.count | number}}\n                    \u003c/div\u003e\n                \u003c/div\u003e\n\n                \u003cdiv class=\&#34;heatmap-sub row\&#34;\u003e\n                    \u003cdiv class=\&#34;col-xs-6\&#34;\u003e\n                        \u003cdiv class=\&#34;heatmap-switch\&#34;\u003e\n                            \u003cp\u003eDisplay values: \u003c/p\u003e\n                            \u003clabel class=\&#34;switch\&#34;\u003e\n                                \u003cinput class=\&#34;switch-input\&#34;\n                                       ng-model=\&#34;variables.displayvalues\&#34;\n                                       type=\&#34;checkbox\&#34;\u003e\n                                \u003cdiv class=\&#34;switch-button\&#34;\u003e\n                                    \u003cspan class=\&#34;switch-button-left\&#34;\u003eOFF\u003c/span\u003e\n                                    \u003cspan class=\&#34;switch-button-right\&#34;\u003eON\u003c/span\u003e\n                                \u003c/div\u003e\n                            \u003c/label\u003e\n                        \u003c/div\u003e\n                    \u003c/div\u003e\n                    \u003cdiv class=\&#34;col-xs-6\&#34;\u003e\n                        \u003cdiv class=\&#34;heatmap-legend\&#34;\u003e\n                            \u003cdiv class=\&#34;heatmap-legend__min-value\&#34;\u003e{{ variables.min | number }}\u003c/div\u003e\n                            \u003cdiv class=\&#34;heatmap-legend__gradient\&#34;\n                                 style=\&#34;background: linear-gradient(270deg,\n                                                                        {{ &#39;rgb(&#39;&#43;rgbstart[0]&#43;&#39;,&#39;&#43;rgbstart[1]&#43;&#39;,&#39;&#43;rgbstart[2]&#43;&#39;)&#39; }},\n                                                                        {{ &#39;rgb(&#39;&#43;rgbend[0]&#43;&#39;,&#39;&#43;rgbend[1]&#43;&#39;,&#39;&#43;rgbend[2]&#43;&#39;)&#39; }}\n                                     )\&#34;\u003e\u003c/div\u003e\n                            \u003cdiv class=\&#34;heatmap-legend__max-value\&#34;\u003e{{ variables.max | number }}\u003c/div\u003e\n                        \u003c/div\u003e\n                    \u003c/div\u003e\n                \u003c/div\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n    \u003c/ods-dataset-context\u003e\n\u003c/div\u003e\n\n\u003c/div\u003e&#34;,
                 "css": &#34;:root {\n    --values-color: white;\n}\n\n.heatmap {\n    display: grid;\n    grid-auto-columns: 1fr;\n    grid-auto-flow: column;\n    grid-auto-rows: auto;\n    /* full auto, adapt to the content, ie the font size */\n}\n.heatmap \u003e * {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    overflow: hidden;\n    font-size: 0.7rem;\n}\n.heatmap.display-values .cell {\n    font-size: 0.5rem;\n}\n.heatmap .cell {\n    position: relative;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    overflow: hidden;\n    color: var(--values-color);\n    font-size: 0;\n}\n.heatmap .cell:hover {\n    border: 1px solid var(--values-color);\n    transform: scale(1.5);\n    font-size: 0.6rem;\n    z-index: 1;\n}\n.heatmap .cell.square:before {\n    content: \&#34;\&#34;;\n    display: block;\n    padding-bottom: 100%;\n}\n.heatmap .cell .round {\n    border-radius: 100%;\n    border: 1px solid black;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.x-axis-centered {\n    text-align: center;\n}\n.x-axis-rotate {\n    transform: rotate(-60deg);\n    padding: 35% 0;\n}\n\n.heatmap-sub {\n    margin-top: 13px;\n}\n\n.heatmap-legend {\n    display: flex;\n    width: 100%;\n    justify-content: space-between;\n    align-items: center;\n}\n.heatmap-legend .heatmap-legend__gradient {\n    display: block;\n    height: 25px;\n    width: 100%;\n    margin: 0 6px;\n    border: 1px solid darkgray;\n}\n\n.heatmap-switch {\n    display: flex;\n    align-items: baseline;\n}\n.heatmap-switch .switch {\n    margin-left: 6px;\n}\n\n/* Button Group Switch\n   ========================================================================== */\n.switch {\n    display: inline-block;\n}\n\n.switch-button {\n    /* background and border when in \&#34;off\&#34; state */\n    background: var(--highlight);\n    border: 2px solid var(--highlight);\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    border-radius: 6px;\n    color: #FFFFFF;\n    position: relative;\n    cursor: pointer;\n    outline: 0;\n    user-select: none;\n}\n\n.switch-input:not(:checked) &#43; .switch-button .switch-button-left {\n    /* text color when in \&#34;off\&#34; state */\n    color: var(--highlight);\n}\n\n.switch-input {\n    display: none;\n}\n\n.switch-button span {\n    font-size: 0.8rem;\n    padding: 0.2rem 0.7rem;\n    text-align: center;\n    z-index: 2;\n    color: #FFFFFF;\n    transition: color 0.2s;\n}\n\n.switch-button::before {\n    content: \&#34;\&#34;;\n    position: absolute;\n    background-color: #FFFFFF;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);\n    border-radius: 4px;\n    top: 0;\n    left: 0;\n    height: 100%;\n    width: 50%;\n    z-index: 1;\n    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;\n}\n\n.switch-button:hover::before {\n    will-change: padding;\n}\n\n.switch-button:active::before {\n    padding-right: 0.4rem;\n}\n\n/* \&#34;On\&#34; state\n   ========================== */\n.switch-input:checked &#43; .switch-button {\n    /* background and border when in \&#34;on\&#34; state */\n    background-color: var(--links);\n    border-color: var(--links);\n}\n\n.switch-input:checked &#43; .switch-button .switch-button-right {\n    /* text color when in \&#34;on\&#34; state */\n    color: var(--links);\n}\n\n.switch-input:checked &#43; .switch-button::before {\n    left: 50%;\n}\n\n.switch-input:checked &#43; .switch-button:active::before {\n    margin-left: -0.4rem;\n}\n\n/* Checkbox in disabled state\n   ========================== */\n.switch-input[type=checkbox]:disabled &#43; .switch-button {\n    opacity: 0.6;\n    cursor: not-allowed;\n}&#34;
               }'>
    </form>
</div>
<div class="ods-content">
    <div class="box-live-example"
      style="height: 550px;">
      <iframe id="iframe-heatmap-with-larger-text-in-legends"
              width="100%" height="100%"
              src="about:blank"
              srcdoc="
                <head>&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css&#34;
/&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css&#34;
/&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.css&#34;
/&gt;

&lt;!-- ODS Platform CSS - must be hosted on static : WIP --&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://s3-us-west-2.amazonaws.com/s.cdpn.io/4124551/ods.css&#34;
/&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://codelibrary.opendatasoft.com/css/theme.css&#34;
/&gt;

&lt;script src=&#34;//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;//cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;//cdnjs.cloudflare.com/ajax/libs/angular-sanitize/1.8.2/angular-sanitize.min.js&#34;&gt;&lt;/script&gt;
&lt;script
  type=&#34;text/javascript&#34;
  src=&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.js&#34;
&gt;&lt;/script&gt;

&lt;script
  type=&#34;text/javascript&#34;
  src=&#34;https://codelibrary.opendatasoft.com/js/platform-filters.js&#34;
&gt;&lt;/script&gt;
&lt;script
  type=&#34;text/javascript&#34;
  src=&#34;https://codelibrary.opendatasoft.com/js/ods-catalog-card.js&#34;
&gt;&lt;/script&gt;

&lt;script type=&#34;text/javascript&#34;&gt;
  const sourceMonitoringInterceptor = $q =&gt; {
    return {
      request: config =&gt; {
        if (config.params)
          if (config.params.source) delete config.params.source;

        config.url = config.url.replace(
          &#34;ods-api-monitoring&#34;,
          &#34;monitoring-copy&#34;
        );
        return config;
      }
    };
  };

  angular
    .module(&#34;ods-widgets&#34;)
    .config(function(ODSWidgetsConfigProvider, $httpProvider) {
      ODSWidgetsConfigProvider.setConfig({
        defaultDomain: &#34;https://userclub.opendatasoft.com/&#34;,
        basemaps: [
          {
            provider: &#34;jawg.light&#34;,
            label: &#34;Jawg Light&#34;,
            jawg_apikey: &#34;opendatasoft-community&#34;
          },
          {
            provider: &#34;jawg.streets&#34;,
            label: &#34;Jawg Streets&#34;,
            jawg_apikey: &#34;opendatasoft-community&#34;,
            id: &#34;streets&#34;
          }
        ],
        themes: {
          default: {
            url: &#34;/img/ods.svg&#34;
          },
          Santé: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/doctors.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Culture, Patrimoine&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/culture.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Éducation, Formation, Recherche, Enseignement&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/college.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          Environment: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/leaf.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Transports, Déplacements&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/train_station.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Aménagement du territoire, Urbanisme, Bâtiments, Équipements, Logement&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/townplanning.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Économie, Business, PME, Développement économique, Emploi&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/economy.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Administration, Gouvernement, Finances publiques, Citoyenneté&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/administration.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Justice, Sécurité, Police, Crime&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/court.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Sport, Loisirs&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/soccer.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Hébergement, Restauration&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/accommodation.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Services, Social&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/social.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          Checklist: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/copyshop.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          Usages: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/bike.svg&#34;,
            color: &#34;#1446A0&#34;
          }
        },
        mapPrependAttribution: &#34;Jawg apikey NOT suitable for production&#34;
      });
      $httpProvider.interceptors.push(sourceMonitoringInterceptor);
    });
&lt;/script&gt;
</head>
                <base href='https://userclub.opendatasoft.com/'>
                <body>
                <div ng-app='ods-widgets'>&lt;div ng-app=&#34;ods-widgets&#34;&gt;
&lt;div class=&#34;container&#34;&gt;
    &lt;ods-dataset-context context=&#34;datum&#34;
                         datum-dataset=&#34;base-nationale-des-lieux-de-covoiturage-en-france&#34;&gt;

        &lt;div ng-init=&#34;variables = {&#39;min&#39;:undefined, &#39;max&#39;:undefined};
                                  rgbstart = [0,55,237];
                                  rgbend = [180,197,241];
                                  xaxis = &#39;type&#39;;
                                  yaxis = &#39;region&#39;;
                                  yLegendWidth = 2&#34;&gt;

            &lt;h3&gt;# of car parks by region and by type&lt;/h3&gt;
            &lt;!--
                group-by month and day, then for each group by dimension, with toObject and keys filter we get the list of all values.
                it constructs the x and y axis by listing all different values for each axis.

                xaxis and yaxis variables are here to avoid using specific id at several places in the code.
                therefore, be sure to name your adv-analysis group-by accordingly.
            --&gt;
            &lt;div ods-adv-analysis=&#34;results&#34;
                 ods-adv-analysis-context=&#34;datum&#34;
                 ods-adv-analysis-select=&#34;sum(spot_size) as count&#34;
                 ods-adv-analysis-group-by=&#34;reg_name as {{ yaxis }}, spot_type as {{ xaxis }}&#34;&gt;
                {{
                variables.numrow = (results | toObject:yaxis | numKeys) ;
                variables.numcol = (results | toObject:xaxis | numKeys) ;
                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;
                variables.listcol = (results | toObject:xaxis | keys | orderBy) ;
                &#34;&#34;
                }}

                &lt;!--
                    To compute color ranges lateron, you need to get the min and max values from the analysis
                    this block list all values, and store the min and max in variables each time it finds a new one.
                --&gt;
                &lt;span ng-repeat=&#34;res in results&#34;&gt;
                    {{ variables.min = (!variables.min || res.count &lt; variables.min ? res.count : variables.min); &#39;&#39; }}
                    {{ variables.max = (!variables.max || res.count &gt; variables.max ? res.count : variables.max); &#39;&#39; }}
                &lt;/span&gt;

                &lt;!-- The grid --&gt;
                &lt;div class=&#34;heatmap&#34;
                     ng-class=&#34;{&#39;display-values&#39;: variables.displayvalues}&#34;
                     ng-if=&#34;variables.min &amp;&amp; variables.max&#34;&gt;

                    &lt;!-- X axis : (bottom horizontal) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listcol&#34;
                         class=&#34;x-axis-centered x-axis-rotate&#34;
                         style=&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;
                                grid-row: {{variables.numrow &#43; 1}};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Y axis : (left vertical) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listrow&#34;
                         class=&#34;y-axis&#34;
                         style=&#34;grid-column: 1 / span {{ yLegendWidth }};
                                grid-row: {{ i &#43; 1 }};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Grid content --&gt;
                    &lt;div class=&#34;cell&#34;
                         ng-repeat=&#34;e in results&#34;
                         ng-init=&#34;val = ((e.count - variables.min) / (variables.max - variables.min))&#34;
                         style=&#34;background-color: {{ &#39;rgb(&#39; &#43;
                                                    ((val * rgbstart[0] &#43; (1 - val) * rgbend[0]) | math : &#39;floor&#39;) &#43;
                                                    &#39;,&#39; &#43;
                                                    ((val * rgbstart[1] &#43; (1 - val) * rgbend[1]) | math : &#39;floor&#39;) &#43;
                                                    &#39;,&#39; &#43;
                                                    ((val * rgbstart[2] &#43; (1 - val) * rgbend[2]) | math : &#39;floor&#39;) &#43;
                                                    &#39;)&#39; }};
                                               grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};
                                               grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};&#34;&gt;
                        {{e.count | number}}
                    &lt;/div&gt;
                &lt;/div&gt;

                &lt;div class=&#34;heatmap-sub row&#34;&gt;
                    &lt;div class=&#34;col-xs-6&#34;&gt;
                        &lt;div class=&#34;heatmap-switch&#34;&gt;
                            &lt;p&gt;Display values: &lt;/p&gt;
                            &lt;label class=&#34;switch&#34;&gt;
                                &lt;input class=&#34;switch-input&#34;
                                       ng-model=&#34;variables.displayvalues&#34;
                                       type=&#34;checkbox&#34;&gt;
                                &lt;div class=&#34;switch-button&#34;&gt;
                                    &lt;span class=&#34;switch-button-left&#34;&gt;OFF&lt;/span&gt;
                                    &lt;span class=&#34;switch-button-right&#34;&gt;ON&lt;/span&gt;
                                &lt;/div&gt;
                            &lt;/label&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&#34;col-xs-6&#34;&gt;
                        &lt;div class=&#34;heatmap-legend&#34;&gt;
                            &lt;div class=&#34;heatmap-legend__min-value&#34;&gt;{{ variables.min | number }}&lt;/div&gt;
                            &lt;div class=&#34;heatmap-legend__gradient&#34;
                                 style=&#34;background: linear-gradient(270deg,
                                                                        {{ &#39;rgb(&#39;&#43;rgbstart[0]&#43;&#39;,&#39;&#43;rgbstart[1]&#43;&#39;,&#39;&#43;rgbstart[2]&#43;&#39;)&#39; }},
                                                                        {{ &#39;rgb(&#39;&#43;rgbend[0]&#43;&#39;,&#39;&#43;rgbend[1]&#43;&#39;,&#39;&#43;rgbend[2]&#43;&#39;)&#39; }}
                                     )&#34;&gt;&lt;/div&gt;
                            &lt;div class=&#34;heatmap-legend__max-value&#34;&gt;{{ variables.max | number }}&lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/ods-dataset-context&gt;
&lt;/div&gt;

&lt;/div&gt;</div>
                <style type='text/css'>
                    :root {
    --values-color: white;
}

.heatmap {
    display: grid;
    grid-auto-columns: 1fr;
    grid-auto-flow: column;
    grid-auto-rows: auto;
    /* full auto, adapt to the content, ie the font size */
}
.heatmap &gt; * {
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    font-size: 0.7rem;
}
.heatmap.display-values .cell {
    font-size: 0.5rem;
}
.heatmap .cell {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    color: var(--values-color);
    font-size: 0;
}
.heatmap .cell:hover {
    border: 1px solid var(--values-color);
    transform: scale(1.5);
    font-size: 0.6rem;
    z-index: 1;
}
.heatmap .cell.square:before {
    content: &#34;&#34;;
    display: block;
    padding-bottom: 100%;
}
.heatmap .cell .round {
    border-radius: 100%;
    border: 1px solid black;
    display: flex;
    justify-content: center;
    align-items: center;
}

.x-axis-centered {
    text-align: center;
}
.x-axis-rotate {
    transform: rotate(-60deg);
    padding: 35% 0;
}

.heatmap-sub {
    margin-top: 13px;
}

.heatmap-legend {
    display: flex;
    width: 100%;
    justify-content: space-between;
    align-items: center;
}
.heatmap-legend .heatmap-legend__gradient {
    display: block;
    height: 25px;
    width: 100%;
    margin: 0 6px;
    border: 1px solid darkgray;
}

.heatmap-switch {
    display: flex;
    align-items: baseline;
}
.heatmap-switch .switch {
    margin-left: 6px;
}

/* Button Group Switch
   ========================================================================== */
.switch {
    display: inline-block;
}

.switch-button {
    /* background and border when in &#34;off&#34; state */
    background: var(--highlight);
    border: 2px solid var(--highlight);
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-radius: 6px;
    color: #FFFFFF;
    position: relative;
    cursor: pointer;
    outline: 0;
    user-select: none;
}

.switch-input:not(:checked) &#43; .switch-button .switch-button-left {
    /* text color when in &#34;off&#34; state */
    color: var(--highlight);
}

.switch-input {
    display: none;
}

.switch-button span {
    font-size: 0.8rem;
    padding: 0.2rem 0.7rem;
    text-align: center;
    z-index: 2;
    color: #FFFFFF;
    transition: color 0.2s;
}

.switch-button::before {
    content: &#34;&#34;;
    position: absolute;
    background-color: #FFFFFF;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    border-radius: 4px;
    top: 0;
    left: 0;
    height: 100%;
    width: 50%;
    z-index: 1;
    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;
}

.switch-button:hover::before {
    will-change: padding;
}

.switch-button:active::before {
    padding-right: 0.4rem;
}

/* &#34;On&#34; state
   ========================== */
.switch-input:checked &#43; .switch-button {
    /* background and border when in &#34;on&#34; state */
    background-color: var(--links);
    border-color: var(--links);
}

.switch-input:checked &#43; .switch-button .switch-button-right {
    /* text color when in &#34;on&#34; state */
    color: var(--links);
}

.switch-input:checked &#43; .switch-button::before {
    left: 50%;
}

.switch-input:checked &#43; .switch-button:active::before {
    margin-left: -0.4rem;
}

/* Checkbox in disabled state
   ========================== */
.switch-input[type=checkbox]:disabled &#43; .switch-button {
    opacity: 0.6;
    cursor: not-allowed;
}
                </style>
                </body>
              ">
      </iframe>
      <div class="show-code buttons has-addons">
          <button class="button is-light">
            <span>Show code</span>
          </button>
          <button class="button is-light"
             target="_blank"
             aria-role="link"
             rel="noopener"
             title="Edit on CodePen, open a new tab"
             onclick="document.getElementById('form-heatmap-with-larger-text-in-legends').submit()">
              <span>Edit on Codepen</span>
              <span class="icon is-small">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                  <use xlink:href="#external"></use>
                </svg>
              </span>
          </button>
      </div>
    </div>
    <div class="box-code js-tabs is-hidden">
        <nav class="level is-mobile">
            <div class="level-left">
                <div class="level-item">
                    <div class="buttons has-addons js-tablist">
                        <a
                          class="button is-primary is-outlined js-tablist__item js-tablist__link"
                          href="#code-heatmap-with-larger-text-in-legends-html-content"
                        >
                          HTML
                        </a>
                        
                        <a
                          class="button is-primary is-outlined js-tablist__item js-tablist__link"
                          href="#code-heatmap-with-larger-text-in-legends-css-content"
                        >
                          CSS
                        </a>
                        
                    </div>
                </div>
            </div>
            <div class="level-right">
                <button class="copy-to-cc button is-primary is-outlined is-rounded has-tooltip-left"
                  data-tooltip="Copy to clipboard"
                  aria-role="button"
                  title="Edit on CodePen, open a new tab"
                >
                  <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                      <use xlink:href="#copy"></use>
                    </svg>
                  </span>
                </button>
                <button class="copied-to-cc button is-success is-outlined is-rounded has-tooltip-left is-hidden"
                  data-tooltip="Copied"
                  aria-role="button"
                  title="Copied"
                >
                  <figure class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                      <use xlink:href="#check"></use>
                    </svg>
                  </figure>
                </button>
            </div>
        </nav>
        <div class="tab-content">
            <div class="js-tabcontent"
                 id="code-heatmap-with-larger-text-in-legends-html-content"
                 data-clipboard="&lt;div class=&#34;container&#34;&gt;
    &lt;ods-dataset-context context=&#34;datum&#34;
                         datum-dataset=&#34;base-nationale-des-lieux-de-covoiturage-en-france&#34;&gt;

        &lt;div ng-init=&#34;variables = {&#39;min&#39;:undefined, &#39;max&#39;:undefined};
                                  rgbstart = [0,55,237];
                                  rgbend = [180,197,241];
                                  xaxis = &#39;type&#39;;
                                  yaxis = &#39;region&#39;;
                                  yLegendWidth = 2&#34;&gt;

            &lt;h3&gt;# of car parks by region and by type&lt;/h3&gt;
            &lt;!--
                group-by month and day, then for each group by dimension, with toObject and keys filter we get the list of all values.
                it constructs the x and y axis by listing all different values for each axis.

                xaxis and yaxis variables are here to avoid using specific id at several places in the code.
                therefore, be sure to name your adv-analysis group-by accordingly.
            --&gt;
            &lt;div ods-adv-analysis=&#34;results&#34;
                 ods-adv-analysis-context=&#34;datum&#34;
                 ods-adv-analysis-select=&#34;sum(spot_size) as count&#34;
                 ods-adv-analysis-group-by=&#34;reg_name as {{ yaxis }}, spot_type as {{ xaxis }}&#34;&gt;
                {{
                variables.numrow = (results | toObject:yaxis | numKeys) ;
                variables.numcol = (results | toObject:xaxis | numKeys) ;
                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;
                variables.listcol = (results | toObject:xaxis | keys | orderBy) ;
                &#34;&#34;
                }}

                &lt;!--
                    To compute color ranges lateron, you need to get the min and max values from the analysis
                    this block list all values, and store the min and max in variables each time it finds a new one.
                --&gt;
                &lt;span ng-repeat=&#34;res in results&#34;&gt;
                    {{ variables.min = (!variables.min || res.count &lt; variables.min ? res.count : variables.min); &#39;&#39; }}
                    {{ variables.max = (!variables.max || res.count &gt; variables.max ? res.count : variables.max); &#39;&#39; }}
                &lt;/span&gt;

                &lt;!-- The grid --&gt;
                &lt;div class=&#34;heatmap&#34;
                     ng-class=&#34;{&#39;display-values&#39;: variables.displayvalues}&#34;
                     ng-if=&#34;variables.min &amp;&amp; variables.max&#34;&gt;

                    &lt;!-- X axis : (bottom horizontal) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listcol&#34;
                         class=&#34;x-axis-centered x-axis-rotate&#34;
                         style=&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;
                                grid-row: {{variables.numrow &#43; 1}};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Y axis : (left vertical) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listrow&#34;
                         class=&#34;y-axis&#34;
                         style=&#34;grid-column: 1 / span {{ yLegendWidth }};
                                grid-row: {{ i &#43; 1 }};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Grid content --&gt;
                    &lt;div class=&#34;cell&#34;
                         ng-repeat=&#34;e in results&#34;
                         ng-init=&#34;val = ((e.count - variables.min) / (variables.max - variables.min))&#34;
                         style=&#34;background-color: {{ &#39;rgb(&#39; &#43;
                                                    ((val * rgbstart[0] &#43; (1 - val) * rgbend[0]) | math : &#39;floor&#39;) &#43;
                                                    &#39;,&#39; &#43;
                                                    ((val * rgbstart[1] &#43; (1 - val) * rgbend[1]) | math : &#39;floor&#39;) &#43;
                                                    &#39;,&#39; &#43;
                                                    ((val * rgbstart[2] &#43; (1 - val) * rgbend[2]) | math : &#39;floor&#39;) &#43;
                                                    &#39;)&#39; }};
                                               grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};
                                               grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};&#34;&gt;
                        {{e.count | number}}
                    &lt;/div&gt;
                &lt;/div&gt;

                &lt;div class=&#34;heatmap-sub row&#34;&gt;
                    &lt;div class=&#34;col-xs-6&#34;&gt;
                        &lt;div class=&#34;heatmap-switch&#34;&gt;
                            &lt;p&gt;Display values: &lt;/p&gt;
                            &lt;label class=&#34;switch&#34;&gt;
                                &lt;input class=&#34;switch-input&#34;
                                       ng-model=&#34;variables.displayvalues&#34;
                                       type=&#34;checkbox&#34;&gt;
                                &lt;div class=&#34;switch-button&#34;&gt;
                                    &lt;span class=&#34;switch-button-left&#34;&gt;OFF&lt;/span&gt;
                                    &lt;span class=&#34;switch-button-right&#34;&gt;ON&lt;/span&gt;
                                &lt;/div&gt;
                            &lt;/label&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&#34;col-xs-6&#34;&gt;
                        &lt;div class=&#34;heatmap-legend&#34;&gt;
                            &lt;div class=&#34;heatmap-legend__min-value&#34;&gt;{{ variables.min | number }}&lt;/div&gt;
                            &lt;div class=&#34;heatmap-legend__gradient&#34;
                                 style=&#34;background: linear-gradient(270deg,
                                                                        {{ &#39;rgb(&#39;&#43;rgbstart[0]&#43;&#39;,&#39;&#43;rgbstart[1]&#43;&#39;,&#39;&#43;rgbstart[2]&#43;&#39;)&#39; }},
                                                                        {{ &#39;rgb(&#39;&#43;rgbend[0]&#43;&#39;,&#39;&#43;rgbend[1]&#43;&#39;,&#39;&#43;rgbend[2]&#43;&#39;)&#39; }}
                                     )&#34;&gt;&lt;/div&gt;
                            &lt;div class=&#34;heatmap-legend__max-value&#34;&gt;{{ variables.max | number }}&lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/ods-dataset-context&gt;
&lt;/div&gt;

"
                 role="tabpanel">
                <div class="highlight">
                    <pre class="language-html" data-lang="html"><code>&lt;div class=&#34;container&#34;&gt;
    &lt;ods-dataset-context context=&#34;datum&#34;
                         datum-dataset=&#34;base-nationale-des-lieux-de-covoiturage-en-france&#34;&gt;

        &lt;div ng-init=&#34;variables = {&#39;min&#39;:undefined, &#39;max&#39;:undefined};
                                  rgbstart = [0,55,237];
                                  rgbend = [180,197,241];
                                  xaxis = &#39;type&#39;;
                                  yaxis = &#39;region&#39;;
                                  yLegendWidth = 2&#34;&gt;

            &lt;h3&gt;# of car parks by region and by type&lt;/h3&gt;
            &lt;!--
                group-by month and day, then for each group by dimension, with toObject and keys filter we get the list of all values.
                it constructs the x and y axis by listing all different values for each axis.

                xaxis and yaxis variables are here to avoid using specific id at several places in the code.
                therefore, be sure to name your adv-analysis group-by accordingly.
            --&gt;
            &lt;div ods-adv-analysis=&#34;results&#34;
                 ods-adv-analysis-context=&#34;datum&#34;
                 ods-adv-analysis-select=&#34;sum(spot_size) as count&#34;
                 ods-adv-analysis-group-by=&#34;reg_name as {{ yaxis }}, spot_type as {{ xaxis }}&#34;&gt;
                {{
                variables.numrow = (results | toObject:yaxis | numKeys) ;
                variables.numcol = (results | toObject:xaxis | numKeys) ;
                variables.listrow = (results | toObject:yaxis | keys | orderBy) ;
                variables.listcol = (results | toObject:xaxis | keys | orderBy) ;
                &#34;&#34;
                }}

                &lt;!--
                    To compute color ranges lateron, you need to get the min and max values from the analysis
                    this block list all values, and store the min and max in variables each time it finds a new one.
                --&gt;
                &lt;span ng-repeat=&#34;res in results&#34;&gt;
                    {{ variables.min = (!variables.min || res.count &lt; variables.min ? res.count : variables.min); &#39;&#39; }}
                    {{ variables.max = (!variables.max || res.count &gt; variables.max ? res.count : variables.max); &#39;&#39; }}
                &lt;/span&gt;

                &lt;!-- The grid --&gt;
                &lt;div class=&#34;heatmap&#34;
                     ng-class=&#34;{&#39;display-values&#39;: variables.displayvalues}&#34;
                     ng-if=&#34;variables.min &amp;&amp; variables.max&#34;&gt;

                    &lt;!-- X axis : (bottom horizontal) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listcol&#34;
                         class=&#34;x-axis-centered x-axis-rotate&#34;
                         style=&#34;grid-column: {{ i &#43; 1 &#43; yLegendWidth }} ;
                                grid-row: {{variables.numrow &#43; 1}};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Y axis : (left vertical) list all values and set the correct position --&gt;
                    &lt;div ng-repeat=&#34;(i,e) in variables.listrow&#34;
                         class=&#34;y-axis&#34;
                         style=&#34;grid-column: 1 / span {{ yLegendWidth }};
                                grid-row: {{ i &#43; 1 }};&#34;&gt;
                        &lt;strong&gt;{{e}}&lt;/strong&gt;
                    &lt;/div&gt;

                    &lt;!-- Grid content --&gt;
                    &lt;div class=&#34;cell&#34;
                         ng-repeat=&#34;e in results&#34;
                         ng-init=&#34;val = ((e.count - variables.min) / (variables.max - variables.min))&#34;
                         style=&#34;background-color: {{ &#39;rgb(&#39; &#43;
                                                    ((val * rgbstart[0] &#43; (1 - val) * rgbend[0]) | math : &#39;floor&#39;) &#43;
                                                    &#39;,&#39; &#43;
                                                    ((val * rgbstart[1] &#43; (1 - val) * rgbend[1]) | math : &#39;floor&#39;) &#43;
                                                    &#39;,&#39; &#43;
                                                    ((val * rgbstart[2] &#43; (1 - val) * rgbend[2]) | math : &#39;floor&#39;) &#43;
                                                    &#39;)&#39; }};
                                               grid-column: {{variables.listcol.indexOf(e[xaxis]) &#43; 1 &#43; yLegendWidth}};
                                               grid-row: {{variables.listrow.indexOf(e[yaxis]) &#43; 1}};&#34;&gt;
                        {{e.count | number}}
                    &lt;/div&gt;
                &lt;/div&gt;

                &lt;div class=&#34;heatmap-sub row&#34;&gt;
                    &lt;div class=&#34;col-xs-6&#34;&gt;
                        &lt;div class=&#34;heatmap-switch&#34;&gt;
                            &lt;p&gt;Display values: &lt;/p&gt;
                            &lt;label class=&#34;switch&#34;&gt;
                                &lt;input class=&#34;switch-input&#34;
                                       ng-model=&#34;variables.displayvalues&#34;
                                       type=&#34;checkbox&#34;&gt;
                                &lt;div class=&#34;switch-button&#34;&gt;
                                    &lt;span class=&#34;switch-button-left&#34;&gt;OFF&lt;/span&gt;
                                    &lt;span class=&#34;switch-button-right&#34;&gt;ON&lt;/span&gt;
                                &lt;/div&gt;
                            &lt;/label&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&#34;col-xs-6&#34;&gt;
                        &lt;div class=&#34;heatmap-legend&#34;&gt;
                            &lt;div class=&#34;heatmap-legend__min-value&#34;&gt;{{ variables.min | number }}&lt;/div&gt;
                            &lt;div class=&#34;heatmap-legend__gradient&#34;
                                 style=&#34;background: linear-gradient(270deg,
                                                                        {{ &#39;rgb(&#39;&#43;rgbstart[0]&#43;&#39;,&#39;&#43;rgbstart[1]&#43;&#39;,&#39;&#43;rgbstart[2]&#43;&#39;)&#39; }},
                                                                        {{ &#39;rgb(&#39;&#43;rgbend[0]&#43;&#39;,&#39;&#43;rgbend[1]&#43;&#39;,&#39;&#43;rgbend[2]&#43;&#39;)&#39; }}
                                     )&#34;&gt;&lt;/div&gt;
                            &lt;div class=&#34;heatmap-legend__max-value&#34;&gt;{{ variables.max | number }}&lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/ods-dataset-context&gt;
&lt;/div&gt;

</code></pre>
                </div>
            </div>
            
            <div class="js-tabcontent"
                 id="code-heatmap-with-larger-text-in-legends-css-content"
                 data-clipboard=":root {
    --values-color: white;
}

.heatmap {
    display: grid;
    grid-auto-columns: 1fr;
    grid-auto-flow: column;
    grid-auto-rows: auto;
    /* full auto, adapt to the content, ie the font size */
}
.heatmap &gt; * {
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    font-size: 0.7rem;
}
.heatmap.display-values .cell {
    font-size: 0.5rem;
}
.heatmap .cell {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    color: var(--values-color);
    font-size: 0;
}
.heatmap .cell:hover {
    border: 1px solid var(--values-color);
    transform: scale(1.5);
    font-size: 0.6rem;
    z-index: 1;
}
.heatmap .cell.square:before {
    content: &#34;&#34;;
    display: block;
    padding-bottom: 100%;
}
.heatmap .cell .round {
    border-radius: 100%;
    border: 1px solid black;
    display: flex;
    justify-content: center;
    align-items: center;
}

.x-axis-centered {
    text-align: center;
}
.x-axis-rotate {
    transform: rotate(-60deg);
    padding: 35% 0;
}

.heatmap-sub {
    margin-top: 13px;
}

.heatmap-legend {
    display: flex;
    width: 100%;
    justify-content: space-between;
    align-items: center;
}
.heatmap-legend .heatmap-legend__gradient {
    display: block;
    height: 25px;
    width: 100%;
    margin: 0 6px;
    border: 1px solid darkgray;
}

.heatmap-switch {
    display: flex;
    align-items: baseline;
}
.heatmap-switch .switch {
    margin-left: 6px;
}

/* Button Group Switch
   ========================================================================== */
.switch {
    display: inline-block;
}

.switch-button {
    /* background and border when in &#34;off&#34; state */
    background: var(--highlight);
    border: 2px solid var(--highlight);
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-radius: 6px;
    color: #FFFFFF;
    position: relative;
    cursor: pointer;
    outline: 0;
    user-select: none;
}

.switch-input:not(:checked) &#43; .switch-button .switch-button-left {
    /* text color when in &#34;off&#34; state */
    color: var(--highlight);
}

.switch-input {
    display: none;
}

.switch-button span {
    font-size: 0.8rem;
    padding: 0.2rem 0.7rem;
    text-align: center;
    z-index: 2;
    color: #FFFFFF;
    transition: color 0.2s;
}

.switch-button::before {
    content: &#34;&#34;;
    position: absolute;
    background-color: #FFFFFF;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    border-radius: 4px;
    top: 0;
    left: 0;
    height: 100%;
    width: 50%;
    z-index: 1;
    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;
}

.switch-button:hover::before {
    will-change: padding;
}

.switch-button:active::before {
    padding-right: 0.4rem;
}

/* &#34;On&#34; state
   ========================== */
.switch-input:checked &#43; .switch-button {
    /* background and border when in &#34;on&#34; state */
    background-color: var(--links);
    border-color: var(--links);
}

.switch-input:checked &#43; .switch-button .switch-button-right {
    /* text color when in &#34;on&#34; state */
    color: var(--links);
}

.switch-input:checked &#43; .switch-button::before {
    left: 50%;
}

.switch-input:checked &#43; .switch-button:active::before {
    margin-left: -0.4rem;
}

/* Checkbox in disabled state
   ========================== */
.switch-input[type=checkbox]:disabled &#43; .switch-button {
    opacity: 0.6;
    cursor: not-allowed;
}">
                <div class="highlight">
                    <pre class="language-css" data-lang="css"><code>:root {
    --values-color: white;
}

.heatmap {
    display: grid;
    grid-auto-columns: 1fr;
    grid-auto-flow: column;
    grid-auto-rows: auto;
    /* full auto, adapt to the content, ie the font size */
}
.heatmap &gt; * {
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    font-size: 0.7rem;
}
.heatmap.display-values .cell {
    font-size: 0.5rem;
}
.heatmap .cell {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    color: var(--values-color);
    font-size: 0;
}
.heatmap .cell:hover {
    border: 1px solid var(--values-color);
    transform: scale(1.5);
    font-size: 0.6rem;
    z-index: 1;
}
.heatmap .cell.square:before {
    content: &#34;&#34;;
    display: block;
    padding-bottom: 100%;
}
.heatmap .cell .round {
    border-radius: 100%;
    border: 1px solid black;
    display: flex;
    justify-content: center;
    align-items: center;
}

.x-axis-centered {
    text-align: center;
}
.x-axis-rotate {
    transform: rotate(-60deg);
    padding: 35% 0;
}

.heatmap-sub {
    margin-top: 13px;
}

.heatmap-legend {
    display: flex;
    width: 100%;
    justify-content: space-between;
    align-items: center;
}
.heatmap-legend .heatmap-legend__gradient {
    display: block;
    height: 25px;
    width: 100%;
    margin: 0 6px;
    border: 1px solid darkgray;
}

.heatmap-switch {
    display: flex;
    align-items: baseline;
}
.heatmap-switch .switch {
    margin-left: 6px;
}

/* Button Group Switch
   ========================================================================== */
.switch {
    display: inline-block;
}

.switch-button {
    /* background and border when in &#34;off&#34; state */
    background: var(--highlight);
    border: 2px solid var(--highlight);
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-radius: 6px;
    color: #FFFFFF;
    position: relative;
    cursor: pointer;
    outline: 0;
    user-select: none;
}

.switch-input:not(:checked) &#43; .switch-button .switch-button-left {
    /* text color when in &#34;off&#34; state */
    color: var(--highlight);
}

.switch-input {
    display: none;
}

.switch-button span {
    font-size: 0.8rem;
    padding: 0.2rem 0.7rem;
    text-align: center;
    z-index: 2;
    color: #FFFFFF;
    transition: color 0.2s;
}

.switch-button::before {
    content: &#34;&#34;;
    position: absolute;
    background-color: #FFFFFF;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    border-radius: 4px;
    top: 0;
    left: 0;
    height: 100%;
    width: 50%;
    z-index: 1;
    transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1), padding 0.2s ease, margin 0.2s ease;
}

.switch-button:hover::before {
    will-change: padding;
}

.switch-button:active::before {
    padding-right: 0.4rem;
}

/* &#34;On&#34; state
   ========================== */
.switch-input:checked &#43; .switch-button {
    /* background and border when in &#34;on&#34; state */
    background-color: var(--links);
    border-color: var(--links);
}

.switch-input:checked &#43; .switch-button .switch-button-right {
    /* text color when in &#34;on&#34; state */
    color: var(--links);
}

.switch-input:checked &#43; .switch-button::before {
    left: 50%;
}

.switch-input:checked &#43; .switch-button:active::before {
    margin-left: -0.4rem;
}

/* Checkbox in disabled state
   ========================== */
.switch-input[type=checkbox]:disabled &#43; .switch-button {
    opacity: 0.6;
    cursor: not-allowed;
}</code></pre>
                </div>
            </div>
            
        </div>
    </div>
</div>

      </div>
    </article>
    
  </div>
</section>

      </div>
    </div>

    <footer class="footer">
    <a href="https://www.opendatasoft.com"
       class="footer-link"
       title="Opendatasoft website">
        <img src="/img/ods-logo.svg"
             class="footer-logo"
             alt="Opendatasoft logo"
        />
    </a>
    <span class="footer-copyright">
        &copy; Copyright 2020
    </span>
</footer>
    
    
    

    <script>
      var process = { env: { NODE_ENV: "production" } };
    </script>
    <script
      type="text/javascript"
      src="/index.min.41a0b740435101dbd6098d0ea4b23b1e8342e67f62ab209d186b7c77fc0ce1de.js"
      defer
    ></script>
  </body>
</html>
