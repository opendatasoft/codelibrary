<!DOCTYPE html>
<html class="has-navbar-fixed-top">
  <head>
    <meta charset="utf-8" />
    <title>
       Comparison Generator &ndash; Codelibrary 
    </title>

    
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-41201218-21"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "UA-41201218-21");
    </script>

    
    

    
    
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.0/themes/prism.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/instantsearch.css@7.3.1/themes/algolia-min.css"
      integrity="sha256-HB49n/BZjuqiCtQQf49OdZn63XuKFaxcIHWf0HNKte8="
      crossorigin="anonymous"
    />

    
    <link rel="stylesheet" type="text/css" href="/scss/main.css" />
    
    
    <link rel="shortcut icon" href="/ods-favicon.ico" />
  </head>

  <body>
    <div class="is-hidden">
      <svg>
  <defs>
    <g id="link-2">
      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
    </g>

    <g id="check">
      <polyline points="20 6 9 17 4 12"></polyline>
    </g>

    <g id="copy">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
    </g>

    <g id="external">
      <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
      <polyline points="15 3 21 3 21 9"></polyline>
      <line x1="10" y1="14" x2="21" y2="3"></line>
    </g>

  </defs>
</svg>

    </div>

    <nav class="ods-header navbar is-fixed-top"
     role="navigation"
     aria-label="Main navigation">

   <button type="button"
           class="menu-button navbar-burger burger"
           id="nav-button"
           data-target="sidebarNavbar"
           aria-controls="sidebarNavbar"
           aria-expanded="false"
           aria-label="Main menu">
        <img class="ods-header__menu-toggle__openlogo" src="/img/menu-fill.svg" alt="Open documentation menu">
    </button>

    <a class="ods-header-logo ods-header-logo-link"
       href="https://help.opendatasoft.com/">
        <img src="/img/ods-logo-noir.svg" alt="Opendatasoft logo">
        <span class="ods-header__brandname">
           Help Center
        </span>
    </a>

    <div class="ods-header__nav">
        <a class="ods-header__nav-item-link"
           href="https://userguide.opendatasoft.com/">
            User guide
        </a>
        <a class="ods-header__nav-item-link"
           href="https://academy.opendatasoft.com/page/homepage">
            Academy
        </a>
        <a class="ods-header__nav-item-link is-active"
           href="https://codelibrary.opendatasoft.com">
            Code Library
        </a>
        <a class="ods-header__nav-item-link"
           href="https://help.opendatasoft.com/widgets/">
            Widgets
        </a>
        <a class="ods-header__nav-item-link"
           href="https://help.opendatasoft.com/en/apis/">
            APIs
        </a>
        <a class="ods-header__nav-item-link"
           href="https://changes.opendatasoft.com/en">
            Release Notes
        </a>
    </div>
    <button type="button"
            class="menu-button navbar-burger burger"
            id="nav-button"
            data-target="helphubNavbar"
            aria-controls="helphubNavbar"
            aria-expanded="false"
            aria-label="Main menu">
        <img class="ods-header__menu-toggle__openlogo" src="/img/apps-custo.svg" alt="Open documentation menu">
    </button>
    <div class="navbar-menu" id="helphubNavbar">
        <a class="ods-header__nav-item-link"
           href="https://userguide.opendatasoft.com/">
            User guide
        </a>
        <a class="ods-header__nav-item-link"
           href="https://academy.opendatasoft.com/page/homepage">
            Academy
        </a>
        <a class="ods-header__nav-item-link is-active"
           href="https://codelibrary.opendatasoft.com">
            Code Library
        </a>
        <a class="ods-header__nav-item-link"
           href="https://help.opendatasoft.com/widgets/">
            Widgets
        </a>
        <a class="ods-header__nav-item-link"
           href="https://help.opendatasoft.com/en/apis/">
            APIs
        </a>
        <a class="ods-header__nav-item-link"
           href="https://changes.opendatasoft.com/en">
            Release Notes
        </a>
    </div>
</nav>


    <div class="columns is-desktop codelibrary mb-0">
      <div class="column is-narrow pb-0">
        <div class="sidebar-search is-hidden-touch">
  <div class="block search-wrapper">
    <div id="algolia-box"></div>
    <div class="search-results-wrapper">
      <div id="algolia-results"></div>
    </div>
  </div>
</div>
<aside class="sidebar"
       id="sidebarNavbar">
  
  <div class="sidebar-header">
    <div class="block">
      <ul class="menu-list">
        <p class="menu-label">On this page</p>
        <li>
          <a href="#">
            Top
          </a>
        </li>
        
        <li>
          <a href="#automated-comparison-dashboard">
            Automated comparison dashboard
          </a>
        </li>
        
      </ul>
    </div>
  </div>
  
  <div class="sidebar-body">
    
    
    <ul class="menu-list">
      <li>
        <a class="sidebar-subtitle"
          href="https://codelibrary.opendatasoft.com">
          Home
        </a>
      </li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <li>
        <a href="/apps/"
        class="sidebar-subtitle">
        Apps
        
      </a>
    </li>
    
    
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <li>
        <a href="/components/"
        class="sidebar-subtitle">
        Components
        
      </a>
    </li>
    
    
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <li>
        <a href="/custom-views/"
        class="sidebar-subtitle">
        Custom views
        
      </a>
    </li>
    
    
      
      <li>
        <a class="sidebar-subtitle " href="/generators/">
          Generators
        </a>
        <ul>
          
          <li>
            <a class="is-active" href="/generators/comparison-generator/">
              <div>
                Comparison Generator
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/generators/custom-view-generator/">
              <div>
                Custom view Generator
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/generators/fullscreen-map/">
              <div>
                Full screen Map Generator
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/generators/kpi-generator/">
              <div>
                KPI Generator
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/generators/listing-generator/">
              <div>
                Listing Generator
                
                
              </div>
            </a>
          </li>
          
          <li>
            <a class="" href="/generators/map-listing/">
              <div>
                Map Listing Generator
                
                
              </div>
            </a>
          </li>
          
        </ul>
      </li>
      
    
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <li>
        <a href="/page-templates/"
        class="sidebar-subtitle">
        Page templates
        
      </a>
    </li>
    
    
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <li>
        <a href="/portal-themes/"
        class="sidebar-subtitle">
        Portal themes
        
      </a>
    </li>
    
    
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <li>
        <a href="/widget-tricks/"
        class="sidebar-subtitle">
        Widget tricks
        
      </a>
    </li>
    
    
  </ul>
  <p class="menu-label">
    Tags
  </p>
  <div class="tags">
    
    <a class="tag" href="/tags/aggregation/">
      aggregation
    </a>
    
    <a class="tag" href="/tags/card/">
      card
    </a>
    
    <a class="tag" href="/tags/chart/">
      chart
    </a>
    
    <a class="tag" href="/tags/date/">
      date
    </a>
    
    <a class="tag" href="/tags/display/">
      display
    </a>
    
    <a class="tag" href="/tags/filter/">
      filter
    </a>
    
    <a class="tag" href="/tags/geo/">
      geo
    </a>
    
    <a class="tag" href="/tags/list/">
      list
    </a>
    
    <a class="tag" href="/tags/map/">
      map
    </a>
    
    <a class="tag" href="/tags/navigation/">
      navigation
    </a>
    
    <a class="tag" href="/tags/ods-adv-analysis/">
      ods-adv-analysis
    </a>
    
    <a class="tag" href="/tags/ods-aggregation/">
      ods-aggregation
    </a>
    
    <a class="tag" href="/tags/ods-analysis/">
      ods-analysis
    </a>
    
    <a class="tag" href="/tags/ods-maps/">
      ods-maps
    </a>
    
    <a class="tag" href="/tags/ods-subaggregation/">
      ods-subaggregation
    </a>
    
    <a class="tag" href="/tags/redirection/">
      redirection
    </a>
    
  </div>
</div>
</aside>

      </div>
      <div class="column codelibrary-content">
        
<section class="section resources">
    <div class="container is-max-widescreen">
        <h1 class="title is-1">Generators - Comparison Generator</h1>
        <div class="content">
            
        </div>
        
        <article class="block">
            <h2 class="title is-2" id="automated-comparison-dashboard">
                Automated comparison dashboard 
                <a class="is-link anchor" href="#automated-comparison-dashboard">
            <span class="icon">
              <img src="/img/fas-link.svg"/>
            </span>
                </a>
            </h2>
            <div class="content">
                <p>Inspired by the listing generator, this version will help you build a comparison dashboard.
Customize it by editing a few settings in the code, and decide to compare 2 values from one field, or from a serie of fields, such as territory-subterritory or category-subcategory.</p>

            </div>
            
            
                <div class="box">
                    








    
    








<div class="codepen">
    <form id="form-automated-comparison-dashboard"
          action="https://codepen.io/pen/define"
          method="POST"
          target="_blank">
        <input type="hidden"
               name="data"
               value='{
                 "title": "New Pen!",
                 "head": &#34;\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css\&#34;\n/\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\&#34;\n/\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.css\&#34;\n/\u003e\n\n\u003c!-- ODS Platform CSS - must be hosted on static : WIP --\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://s3-us-west-2.amazonaws.com/s.cdpn.io/4124551/ods.css\&#34;\n/\u003e\n\u003clink\n  rel=\&#34;stylesheet\&#34;\n  href=\&#34;https://codelibrary.opendatasoft.com/css/theme.css\&#34;\n/\u003e\n\n\u003cscript src=\&#34;//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js\&#34;\u003e\u003c/script\u003e\n\u003cscript src=\&#34;//cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.js\&#34;\u003e\u003c/script\u003e\n\u003cscript src=\&#34;//cdnjs.cloudflare.com/ajax/libs/angular-sanitize/1.8.2/angular-sanitize.min.js\&#34;\u003e\u003c/script\u003e\n\u003cscript\n  type=\&#34;text/javascript\&#34;\n  src=\&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.js\&#34;\n\u003e\u003c/script\u003e\n\n\u003cscript\n  type=\&#34;text/javascript\&#34;\n  src=\&#34;https://codelibrary.opendatasoft.com/js/platform-filters.js\&#34;\n\u003e\u003c/script\u003e\n\u003cscript\n  type=\&#34;text/javascript\&#34;\n  src=\&#34;https://codelibrary.opendatasoft.com/js/ods-catalog-card.js\&#34;\n\u003e\u003c/script\u003e\n\n\u003cscript type=\&#34;text/javascript\&#34;\u003e\n  const sourceMonitoringInterceptor = $q =\u003e {\n    return {\n      request: config =\u003e {\n        console.log(config.url);\n        if (config.params)\n          if (config.params.source) delete config.params.source;\n\n        config.url = config.url.replace(\n          \&#34;ods-api-monitoring\&#34;,\n          \&#34;monitoring-copy\&#34;\n        );\n        return config;\n      }\n    };\n  };\n\n  angular\n    .module(\&#34;ods-widgets\&#34;)\n    .config(function(ODSWidgetsConfigProvider, $httpProvider) {\n      ODSWidgetsConfigProvider.setConfig({\n        defaultDomain: \&#34;https://userclub.opendatasoft.com/\&#34;,\n        basemaps: [\n          {\n            provider: \&#34;jawg.light\&#34;,\n            label: \&#34;Jawg Light\&#34;,\n            jawg_apikey: \&#34;opendatasoft-community\&#34;\n          },\n          {\n            provider: \&#34;jawg.streets\&#34;,\n            label: \&#34;Jawg Streets\&#34;,\n            jawg_apikey: \&#34;opendatasoft-community\&#34;,\n            id: \&#34;streets\&#34;\n          }\n        ],\n        themes: {\n          default: {\n            url: \&#34;/img/ods.svg\&#34;\n          },\n          Santé: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/doctors.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Culture, Patrimoine\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/culture.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Éducation, Formation, Recherche, Enseignement\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/college.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          Environment: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/leaf.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Transports, Déplacements\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/train_station.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Aménagement du territoire, Urbanisme, Bâtiments, Équipements, Logement\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/townplanning.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Économie, Business, PME, Développement économique, Emploi\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/economy.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Administration, Gouvernement, Finances publiques, Citoyenneté\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/administration.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Justice, Sécurité, Police, Crime\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/court.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Sport, Loisirs\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/soccer.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Hébergement, Restauration\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/accommodation.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          \&#34;Services, Social\&#34;: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/social.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          Checklist: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/copyshop.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          },\n          Usages: {\n            url:\n              \&#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/bike.svg\&#34;,\n            color: \&#34;#1446A0\&#34;\n          }\n        },\n        mapPrependAttribution: \&#34;Jawg apikey NOT suitable for production\&#34;\n      });\n      $httpProvider.interceptors.push(sourceMonitoringInterceptor);\n    });\n\u003c/script\u003e\n&#34;,
                 "editors": 110,
                 "html": &#34;\u003cdiv ng-app=\&#34;ods-widgets\&#34;\u003e\n\u003cods-dataset-context context=\&#34;ctx\&#34;\n ctx-dataset=\&#34;healthref-france-finess\&#34;\n ctx-domain=\&#34;userclub\&#34;\u003e\n\u003c!-- IMPORTANT ******** MUST READ !\n\n    In the following settings declaration :\n\n    A common error is forget to escape (protect) apostrophe with a leading backslash\n    As apostrophes are used to declare values of variable it will break the settings\n\n    Ex:\n    wrongVariable = &#39;I&#39;ll be freed from apostrophes&#39;\n    correctVariable = &#39;I\\&#39;ll be freed from apostrophes&#39;\n--\u003e\n\n\u003c!-- SETTINGS START HERE --\u003e\n\u003cdiv class=\&#34;container\&#34;\nng-init=\&#34;domain = &#39;userclub.opendatasoft.com&#39;;\n                datasetid = &#39;healthref-france-finess&#39;;\n                \n                refineField = &#39;&#39;;\n                refineValue = &#39;&#39;;\n\n                pageTitle = &#39;Analyse : Etablissements du domaine sanitaire et social en France&#39;;\n                pageSubtitle = &#39;Cette page permet de comparer la répartition des établissements du domaine sanitaire et social en France. Sélectionnez les territoires à comparer et parcourez les différents indicateurs et graphiques pour dresser votre analyse.&#39;;\n\n                compareType = &#39;multiFields&#39;;\n                \n                filterTitle = &#39;Sélectionnez les catégories à comparer&#39;;\n                referenceFitlerTitle = &#39;Catégorie de référence&#39;;\n                compareFilterTitle = &#39;Catégorie à comparer&#39;;\n\n                defaultLevel = &#39;France entière&#39;;\n\n                IF_COMPARE_BY_MULTIFIELDS;\n\n                fields = [\n                {name:&#39;Région&#39;,idField:&#39;code_officiel_region&#39;,labelField:&#39;nom_officiel_region&#39;, placeholder:&#39;Toutes régions&#39;},\n                {name:&#39;Département&#39;, idField:&#39;departement&#39;,labelField:&#39;libelle_departement&#39;, placeholder:&#39;Tous départements&#39;},\n                {name:&#39;EPCI&#39;, idField:&#39;code_officiel_epci&#39;,labelField:&#39;nom_officiel_epci&#39;, placeholder:&#39;Tous EPCIs&#39;},\n                {name:&#39;Commune&#39;, idField:&#39;code_commune&#39;,labelField:&#39;nom_officiel_commune&#39;, placeholder:&#39;Toutes communes&#39;}\n                ];\n\n                resetFiltersButtonLabel = &#39;Supprimer tous les filtres&#39;;\n\n                IF_COMPARE_BY_SINGLEFIELD;\n\n                filterFieldId = &#39;alert_country&#39;;\n                filterFieldLabel = &#39;alert_country&#39;;\n\n                defaultValue = &#39;&#39;;\n\n                filterPlaceholder = &#39;Sélectionnez une valeur&#39;;\n\n                kpis = [ \n                {\n                &#39;title&#39;: &#39;Nombre d\\&#39;établissements&#39;,\n                &#39;select&#39;: &#39;count(*)&#39;,\n                &#39;precision&#39;: 0,\n                &#39;unit&#39;: &#39;&#39;,\n                &#39;faicon&#39;: &#39;square-o&#39;\n                }\n                ];\n\n                charts = [\n                { \n                &#39;disposition&#39;:&#39;pyramid&#39;,\n                &#39;title&#39;:&#39;Répartition par mode de fixation des tarifs&#39;,\n                &#39;xAxis&#39;:&#39;libelle_mft&#39;,\n                &#39;label&#39;:&#39;Nombre d\\&#39;établissements&#39;,\n                &#39;select&#39;:&#39;count(*)&#39;\n                },\n                { \n                &#39;disposition&#39;:&#39;pyramid&#39;,\n                &#39;title&#39;:&#39;Répartition par catégorie d\\’établissement&#39;,\n                &#39;xAxis&#39;:&#39;libelle_categorie_d_etablissement&#39;,\n                &#39;label&#39;:&#39;Nombre d\\&#39;établissements&#39;,\n                &#39;select&#39;:&#39;count(*)&#39;\n                },\n                { \n                &#39;disposition&#39;:&#39;classic&#39;,\n                &#39;title&#39;:&#39;Participation au service public hospitalier&#39;,\n                &#39;xAxis&#39;:&#39;libelle_sph&#39;,\n                &#39;type&#39;:&#39;line&#39;,\n                &#39;function&#39;:&#39;COUNT&#39;,\n                &#39;maxPoints&#39;:&#39;20&#39;,\n                &#39;displayValues&#39;:&#39;true&#39;,\n                &#39;label&#39;:&#39;Nombre d\\&#39;établissements&#39;,\n                &#39;sort&#39;:&#39;serie1-1&#39;,\n                &#39;expression&#39;:&#39;&#39;\n                },\n                { \n                &#39;disposition&#39;:&#39;classic&#39;,\n                &#39;title&#39;:&#39;Date d\\&#39;ouverture&#39;,\n                &#39;xAxis&#39;:&#39;date_d_ouverture&#39;,\n                &#39;label&#39;:&#39;Nombre d\\&#39;établissements&#39;,\n                &#39;type&#39;:&#39;line&#39;,\n                &#39;function&#39;:&#39;COUNT&#39;,\n                &#39;expression&#39;:&#39;&#39;,\n                &#39;sort&#39;:&#39;&#39;,\n                &#39;maxPoints&#39;:&#39;&#39;,\n                &#39;displayValues&#39;:&#39;true&#39;\n                }\n                ];\n\n\n\n                DO_NOT_MODIFY_BELOW;\n\n                selected1 = {};\n                selected2 = {};\n                selectionRefFinale = &#39;&#39;;\n                selectionCompareFinale = {};\n                \&#34;\u003e\n    \u003c!--\n\n    --\u003e\n\n    \u003c!-- ### GENERAL SETTINGS ### --\u003e\n    \u003c!-- domain (Domain URL): Must contain the URL of the domain where the dataset is published.\n     ex: &#39;public.opendatasoft.com&#39;\n    --\u003e\n    \u003c!-- datasetid (Dataset ID): Must contain the ID of the dataset\n     ex: &#39;healthref-france-finess&#39;\n    --\u003e\n    \u003c!-- compareType: Must contain the type of comparison you want to do. \n            Can be multiFields (to do a comparison based on a serie of fields, for example geographical levels or category and sub-category) or singleField (to do a comparison based on a single field).\n     ex: &#39;multiFields&#39;\n    --\u003e\n\n    \u003c!-- defaultLevel: the title you want to display when no filter is selected --\u003e\n\n\n    \u003c!-- ### FILTERS SETTINGS ### --\u003e\n    \u003c!-- IF_COMPARE_BY_MULTIFIELDS --\u003e\n    \u003c!-- fields : List of fields available on the comparison filters, and their corresponding field id in the dataset.\n        You can put as many fields as you have available on your dataset.\n        List of parameters are :\n        - name (label of the filter to be display on the filter list) ex: &#39;Region&#39;\n        - idField (id of the field containing the id of the filter) ex: &#39;reg_code&#39;. can be the same as the labelField.\n        - labelField (id of the field containing the label of the filter) ex: &#39;reg_name&#39;\n        NB: the field must be a facet in the dataset\n        NB: alphanumerical sort is applied in the filter view\n        ex: \n        fields = [\n                        {\n                            name:&#39;Région&#39;,idField:&#39;reg_code&#39;,labelField:&#39;reg_name&#39;\n                        },\n                        {\n                            name:&#39;Département&#39;,idField:&#39;dep_code&#39;,labelField:&#39;dep_name&#39;\n                        },\n                        {\n                            name:&#39;EPCI&#39;,idField:&#39;epci_code&#39;,labelField:&#39;epci_name&#39;\n                        },\n                        {\n                            name:&#39;Commune&#39;,idField:&#39;com_code&#39;,labelField:&#39;com_name&#39;\n                        }\n                ]\n    --\u003e\n\n        \u003c!-- resetFiltersButtonLabel (Label of the button) : test to display when a filter is selected\n         ex: &#39;Clear all filters&#39;\n    --\u003e\n\n    \u003c!-- IF_COMPARE_BY_SINGLEFIELD --\u003e\n    \u003c!--filterFieldId: id of the field containing the id of the filter field;\n        filterFieldLabel: id of the field containing the label of the filter field;\n        filterFieldId and filterFieldLabel can have the same id.\n        ex:  filterFieldId = &#39;categetab&#39;;\n             filterFieldLabel = &#39;libcategetab&#39;\n    --\u003e\n\n    \u003c!--defaultValue: default selected value you want to set up on the filter;\n       ex:  defaultValue = &#39;44&#39;;\n       WARNING: must be the value of the filterFieldId and NOT the filterFieldLabel, if they are different.\n   --\u003e\n\n    \u003c!-- filterPlaceholder: placeholder text for the filter --\u003e\n\n    \u003c!-- ### KPIS SETTINGS ### --\u003e\n    \u003c!-- KPIS settings is a list of object that describes each KPI\n    List of available keys are:\n    - title (string) : mandatory, name of the KPI, ex: ‘City population’\n    - select (string) : mandatory, API V2 select, containing the calculation to perform, ex: ‘sum(population)’ or ‘count(*)’\n    - precision (string) : optional, decimal precision of the KPI, ex: 2\n    - unit (string) : optional, KPI unit, ex: ‘citizens’\n    - faicon (string) : optional, FontAwesome icon id, ex: ‘square-o’ (omit the fa- prefix) \n\n    Please see the documentation for more information regarding the select\n    https://help.opendatasoft.com/apis/ods-explore-v2/#section/Opendatasoft-Query-Language-(ODSQL)\n\n    Please see all available icons here\n    https://fontawesome.com/v4/icons/\n\n    ex:\n    kpis = [\n              {\n                  &#39;title&#39;: &#39;Nombre d\\&#39;établissements&#39;,\n                  &#39;select&#39;: &#39;count(*)&#39;,\n                  &#39;precision&#39;: 0,\n                  &#39;unit&#39;: &#39;&#39;,\n                  &#39;faicon&#39;: &#39;square-o&#39;\n              },\n              {\n                  &#39;title&#39;: &#39;Taille moyenne&#39;,\n                  &#39;select&#39;: &#39;avg(surface)&#39;,\n                  &#39;precision&#39;: 2,\n                  &#39;unit&#39;: &#39;m2&#39;,\n                  &#39;faicon&#39;: &#39;square-o&#39;\n              }\n           ];\n--\u003e\n\n    \u003c!-- ### CHARTS SETTINGS ### --\u003e\n    \u003c!-- 2 dispositions are available: pyramid (custom css chart) and classic (ods-chart).\n         Each disposition has specific parameters--\u003e\n    \u003c!-- Pyramid disposition.\n     List of available parameters are :\n     - disposition (pyramid or classic) ex:&#39;pyramid&#39;\n     - title (title of the chart) ex: &#39;Répartition par mode de fixation des tarifs&#39;\n     - xAxis (id of the field for the X axis) ex: &#39;libmft&#39;\n     - label (label of the serie) ex:&#39;Nombre d\\&#39;établissements&#39;\n     - select (function for the serie) ex:&#39;COUNT(*)&#39;\n\n    disposition, title, xAxis, select are MANDATORY\n    label is optionnal\n\n    Available values for select are AVG, COUNT, MIN, MAX, STDDEV, SUM.\n    Please see the documentation for more information\n    https://help.opendatasoft.com/widgets/#/api/ods-widgets.directive:odsAnalysis\n\n    ex:\n    charts = [\n                { \n                &#39;disposition&#39;:&#39;pyramid&#39;,\n                &#39;title&#39;:&#39;Répartition par mode de fixation des tarifs&#39;,\n                &#39;xAxis&#39;:&#39;libmft&#39;,\n                &#39;label&#39;:&#39;Nombre d\\&#39;établissements&#39;,\n                &#39;select&#39;:&#39;COUNT(*)&#39;\n                }\n            ]\n    --\u003e\n    \u003c!-- Classic disposition.\n List of available parameters are :\n - disposition (pyramid or classic) ex:&#39;classic&#39;\n - title (title of the chart) ex: &#39;Date d\\ouverture&#39;\n - xAxis (id of the field for the X axis) ex: &#39;dateouv&#39;\n - label (label of the serie) ex:&#39;Nombre d\\&#39;établissements&#39;\n - type (type of chart) ex: &#39;line&#39;\n - function (function for the serie) ex:&#39;SUM&#39;\n - expression (field id that contains numerical values to use for the serie) ex: &#39;population&#39;\n - sort (rule to sort the data, empty for default order or serie1-1 to order by serie) ex:&#39;serie1-1&#39;\n - maxPoints (max number of points to display on the X axis) ex:&#39;20&#39;\n - displayValues (can be true or false, if true: values are displayed on the serie): ex:&#39;true&#39;\n\ndisposition, title, xAxis, select are MANDATORY\nlabel is optionnal\n\nAvailable values for type are line, spline, area, areaspline, column, bar, pie, scatter, polar, spiderweb, funnel, arearange, areasplinerange, columnrange\n\nAvailable values for function are COUNT, AVG, MIN, MAX, STDDEV, SUM, QUANTILES, CONSTANT\n\nPlease see the documentation for more information\nhttps://help.opendatasoft.com/widgets/#/api/ods-widgets.directive:odsChartSerie\n\nex:\ncharts = [\n            {\n            &#39;disposition&#39;:&#39;classic&#39;,\n            &#39;title&#39;:&#39;Participation au service public hospitalier&#39;,\n            &#39;xAxis&#39;:&#39;libsph&#39;,\n            &#39;type&#39;:&#39;bar&#39;,\n            &#39;function&#39;:&#39;COUNT&#39;,\n            &#39;maxPoints&#39;:&#39;20&#39;,\n            &#39;displayValues&#39;:&#39;true&#39;,\n            &#39;label&#39;:&#39;Nombre d\\&#39;établissements&#39;,\n            &#39;sort&#39;:&#39;serie1-1&#39;,\n            &#39;expression&#39;:&#39;&#39;\n            }\n        ]\n--\u003e\n\n    \u003c!-- DO NOT MODIFY --\u003e\n    \u003c!-- Technical fields, do not modify please --\u003e\n\n    \u003cods-dataset-context context=\&#34;ctxref,ctxcompare,ctx1,ctx2,context0,context1,context2,context3,contextcompare0,contextcompare1,contextcompare2,contextcompare3\&#34;\n                         ctxref-dataset=\&#34;{{datasetid}}\&#34;\n                         ctxref-domain=\&#34;{{domain}}\&#34;\n\n                         ctxcompare-dataset=\&#34;{{datasetid}}\&#34;\n                         ctxcompare-domain=\&#34;{{domain}}\&#34;\n\n                         ctx1-dataset=\&#34;{{datasetid}}\&#34;\n                         ctx1-domain=\&#34;{{domain}}\&#34;\n\n                         ctx2-dataset=\&#34;{{datasetid}}\&#34;\n                         ctx2-domain=\&#34;{{domain}}\&#34;\n\n                         context0-dataset=\&#34;{{datasetid}}\&#34;\n                         context0-domain=\&#34;{{domain}}\&#34;\n                         context1-dataset=\&#34;{{datasetid}}\&#34;\n                         context1-domain=\&#34;{{domain}}\&#34;\n                         context2-dataset=\&#34;{{datasetid}}\&#34;\n                         context2-domain=\&#34;{{domain}}\&#34;\n                         context3-dataset=\&#34;{{datasetid}}\&#34;\n                         context3-domain=\&#34;{{domain}}\&#34;\n\n                         contextcompare0-dataset=\&#34;{{datasetid}}\&#34;\n                         contextcompare0-domain=\&#34;{{domain}}\&#34;\n                         contextcompare1-dataset=\&#34;{{datasetid}}\&#34;\n                         contextcompare1-domain=\&#34;{{domain}}\&#34;\n                         contextcompare2-dataset=\&#34;{{datasetid}}\&#34;\n                         contextcompare2-domain=\&#34;{{domain}}\&#34;\n                         contextcompare3-dataset=\&#34;{{datasetid}}\&#34;\n                         contextcompare3-domain=\&#34;{{domain}}\&#34;\n    \u003e\n\n        \u003cspan ng-if=\&#34;refineField\&#34;\u003e\n            {{ctxref.parameters[&#39;refine.&#39; &#43; refineField] = refineValue; \n            ctxcompare.parameters[&#39;refine.&#39; &#43; refineField] = refineValue; \n            ctx1.parameters[&#39;refine.&#39; &#43; refineField] = refineValue; \n            ctx2.parameters[&#39;refine.&#39; &#43; refineField] = refineValue;  \&#34;\&#34;}}\n        \u003c/span\u003e\n\n        \u003cdiv ods-results=\&#34;results1\&#34; ods-results-context=\&#34;ctx1\&#34; ods-results-max=\&#34;10\&#34;\u003e\n            \u003cdiv ods-results=\&#34;results2\&#34; ods-results-context=\&#34;ctx2\&#34; ods-results-max=\&#34;10\&#34;\u003e\n                \u003ch1 class=\&#34;page-title\&#34;\u003e\n                    {{ pageTitle }}\n                \u003c/h1\u003e\n                \u003cp class=\&#34;page-subtitle\&#34;\u003e\n                    {{ pageSubtitle }}\n                \u003c/p\u003e\n                \u003csection class=\&#34;filterbloc\&#34;\u003e\n    \u003ch2 class=\&#34;filterbloc-title\&#34;\u003e{{filterTitle}}\u003c/h2\u003e\n    \u003cdiv class=\&#34;filter-list\&#34; ng-if=\&#34;compareType == &#39;multiFields&#39;\&#34;\u003e\n        \u003cdiv class=\&#34;filter-box select-left\&#34;\u003e\n            \u003ch4 class=\&#34;filter-title\&#34;\u003e\n                {{referenceFitlerTitle}}\n            \u003c/h4\u003e\n            \u003cdiv class=\&#34;ods-selects\&#34;\u003e\n                \u003cdiv ng-repeat=\&#34;(i, fieldname) in fields\&#34;\u003e\n                    \u003cdiv ods-adv-analysis=\&#34;list1\&#34;\n                         ods-adv-analysis-context=\&#34;{{ &#39;context&#39; &#43; i }}\&#34;\n                         ods-adv-analysis-select=\&#34;count(*)\&#34;\n                         ods-adv-analysis-group-by=\&#34;{{fieldname.idField}},{{fieldname.labelField}}\&#34;\n                         ods-adv-analysis-order-by=\&#34;{{fieldname.labelField}}\&#34; ods-adv-analysis-limit=\&#34;300\&#34;\u003e\n                        \u003cods-select selected-values=\&#34;selected1[fieldname.name]\&#34;\n                                    placeholder=\&#34;{{ fieldname.placeholder }}\&#34;\n                                    label-modifier=\&#34;{{fieldname.labelField}}\&#34;\n                                    value-modifier=\&#34;{&#39;code&#39;:{{fieldname.idField}},&#39;name&#39;:{{fieldname.labelField}}}\&#34;\n                                    options=\&#34;list1\&#34;\n                                    multiple=\&#34;false\&#34;\n                                    is-loading=\&#34;true\&#34;\u003e\u003c/ods-select\u003e\n\n                        \u003cspan ng-repeat=\&#34;(j, fake) in fields\&#34;\u003e\n                            \u003cspan ng-if=\&#34;i != j\&#34;\u003e\n                                {{\n                                $parent.$parent.$parent.$parent[&#39;context&#39; &#43; j].parameters[&#39;refine.&#39; &#43; fieldname.idField] =\n                                ctx1.parameters[&#39;refine.&#39; &#43;fieldname.idField] =\n                                (selected1[fieldname.name] | toObject:&#39;code&#39; | keys);\&#34;\&#34;\n                                }}\n                            \u003c/span\u003e\n                        \u003c/span\u003e\n                    \u003c/div\u003e\n                   \n                \u003c/div\u003e\n                \u003cdiv class=\&#34;clear-filters\&#34; ng-if=\&#34;selected1[fields[3].name].length \u003e 0 || \n                    selected1[fields[2].name].length \u003e 0 ||\n                    selected1[fields[1].name].length \u003e 0 ||\n                    selected1[fields[0].name].length \u003e 0\&#34;\u003e\n                \u003cbutton class=\&#34;clear-filters-button\&#34;\n                    ng-click=\&#34;\n                    selected1[fields[3].name].length = 0;\n                    selected1[fields[2].name].length = 0;\n                    selected1[fields[1].name].length = 0;\n                    selected1[fields[0].name].length = 0;\&#34;\u003e\n                        {{resetFiltersButtonLabel}}\n                    \u003c/button\u003e\n                    \u003ci class=\&#34;fa fa-times-circle\&#34; aria-hidden=\&#34;true\&#34;\u003e\u003c/i\u003e\n\n                \u003c/div\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n\n        \u003cdiv class=\&#34;filter-box select-right\&#34;\u003e\n            \u003ch4 class=\&#34;filter-title\&#34;\u003e\n                {{compareFilterTitle}}\n            \u003c/h4\u003e\n            \u003cdiv class=\&#34;ods-selects\&#34;\u003e\n                            \u003cdiv ng-repeat=\&#34;(i, fieldname) in fields\&#34;\u003e\n                    \u003cdiv ods-adv-analysis=\&#34;list2\&#34;\n                         ods-adv-analysis-context=\&#34;{{ &#39;contextcompare&#39; &#43; i }}\&#34;\n                         ods-adv-analysis-select=\&#34;count(*)\&#34;\n                         ods-adv-analysis-group-by=\&#34;{{fieldname.idField}},{{fieldname.labelField}}\&#34;\n                         ods-adv-analysis-order-by=\&#34;{{fieldname.labelField}}\&#34; ods-adv-analysis-limit=\&#34;300\&#34;\u003e\n                        \u003cods-select selected-values=\&#34;selected2[fieldname.name]\&#34;\n                                    placeholder=\&#34;{{  fieldname.placeholder }}\&#34;\n                                    label-modifier=\&#34;{{fieldname.labelField}}\&#34;\n                                    value-modifier=\&#34;{&#39;code&#39;:{{fieldname.idField}},&#39;name&#39;:{{fieldname.labelField}}}\&#34;\n                                    options=\&#34;list2\&#34;\n                                    multiple=\&#34;false\&#34;\n                                    is-loading=\&#34;true\&#34;\u003e\u003c/ods-select\u003e\n\n                        \u003cspan ng-repeat=\&#34;(j, fake) in fields\&#34;\u003e\n                            \u003cspan ng-if=\&#34;i != j\&#34;\u003e\n                                {{\n                                $parent.$parent.$parent.$parent[&#39;contextcompare&#39; &#43; j].parameters[&#39;refine.&#39; &#43; fieldname.idField] =\n                                ctx2.parameters[&#39;refine.&#39; &#43;fieldname.idField] =\n                                (selected2[fieldname.name] | toObject:&#39;code&#39; | keys );\&#34;\&#34;\n                                }}\n                            \u003c/span\u003e\n                        \u003c/span\u003e\n                    \u003c/div\u003e\n                \u003c/div\u003e\n                \u003cdiv class=\&#34;clear-filters\&#34; ng-if=\&#34;\n                selected2[fields[3].name].length \u003e 0 ||\n                selected2[fields[2].name].length \u003e 0 ||\n                selected2[fields[1].name].length \u003e 0 ||\n                selected2[fields[0].name].length \u003e 0\&#34;\u003e\n                \u003cbutton class=\&#34;clear-filters-button\&#34; \n                ng-click=\&#34;\n                selected2[fields[3].name].length = 0;\n                selected2[fields[2].name].length = 0;\n                selected2[fields[1].name].length = 0;\n                selected2[fields[0].name].length = 0;\&#34;\u003e\n                {{resetFiltersButtonLabel}}\n                \u003c/button\u003e\n                \u003ci class=\&#34;fa fa-times-circle\&#34; aria-hidden=\&#34;true\&#34;\u003e\u003c/i\u003e\n            \u003c/div\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n    \u003cdiv class=\&#34;filter-list\&#34; ng-if=\&#34;compareType == &#39;singleField&#39;\&#34;\u003e\n        \u003cdiv class=\&#34;filter-box\&#34;\u003e\n            \u003ch4 class=\&#34;filter-title\&#34;\u003e\n                {{referenceFitlerTitle}}\n            \u003c/h4\u003e\n            \u003cdiv ods-adv-analysis=\&#34;reflist\&#34; ods-adv-analysis-context=\&#34;ctxref\&#34;\n                 ods-adv-analysis-select=\&#34;count(*) as y_axis\&#34;\n                 ods-adv-analysis-group-by=\&#34;{{filterFieldId}} as x_axis_id, {{filterFieldLabel}} as x_axis_label\&#34;\n                 ods-adv-analysis-order-by=\&#34;y_axis\&#34;\u003e\n                \u003cspan ng-if=\&#34;!defaultValue\&#34;\u003e\n                    \u003cods-select options=\&#34;reflist\&#34; selected-values=\&#34;selectionRefFinale\&#34; label-modifier=\&#34;x_axis_label\&#34;\n                                value-modifier=\&#34;x_axis_id\&#34; placeholder=\&#34;{{filterPlaceholder}}\&#34;\u003e\n                    \u003c/ods-select\u003e\n                    {{ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId] = selectionRefFinale ; \&#34;\&#34;}}\n                \u003c/span\u003e\n                \u003cspan ng-if=\&#34;defaultValue\&#34;\u003e\n                    \u003cods-select options=\&#34;reflist\&#34; selected-values=\&#34;selectionRefFinale\&#34;\n                                label-modifier=\&#34;x_axis_label\&#34; value-modifier=\&#34;x_axis_id\&#34;\n                                placeholder=\&#34;{{filterPlaceholder}}\&#34;\u003e\n                    \u003c/ods-select\u003e\n                    {{selectionRefFinale == 0 ? selectionRefFinale = defaultValue : &#39;&#39; ; \&#34;\&#34;}}\n                    {{ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId] = selectionRefFinale ; \&#34;\&#34;}}\n                \u003c/span\u003e\n\n            \u003c/div\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\&#34;filter-box\&#34;\u003e\n            \u003ch4 class=\&#34;filter-title\&#34;\u003e\n                {{compareFilterTitle}}\n            \u003c/h4\u003e\n            \u003cdiv ods-adv-analysis=\&#34;comparelist\&#34; ods-adv-analysis-context=\&#34;ctxcompare\&#34;\n                 ods-adv-analysis-select=\&#34;count(*) as y_axis\&#34;\n                 ods-adv-analysis-group-by=\&#34;{{filterFieldId}} as x_axis_id, {{filterFieldLabel}} as x_axis_label\&#34;\n                 ods-adv-analysis-order-by=\&#34;y_axis\&#34;\u003e\n                \u003cspan ng-if=\&#34;!defaultValue\&#34;\u003e\n                    \u003cods-select options=\&#34;comparelist\&#34; selected-values=\&#34;selectionCompareFinale\&#34;\n                                label-modifier=\&#34;x_axis_label\&#34; value-modifier=\&#34;x_axis_id\&#34;\n                                placeholder=\&#34;{{filterPlaceholder}}\&#34;\u003e\n                    \u003c/ods-select\u003e\n                    {{ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId] = selectionCompareFinale ; \&#34;\&#34;}}\n                \u003c/span\u003e\n                \u003cspan ng-if=\&#34;defaultValue\&#34;\u003e\n                    \u003cods-select options=\&#34;comparelist\&#34; selected-values=\&#34;selectionCompareFinale\&#34;\n                                label-modifier=\&#34;x_axis_label\&#34; value-modifier=\&#34;x_axis_id\&#34;\n                                placeholder=\&#34;{{filterPlaceholder}}\&#34;\u003e\n                    \u003c/ods-select\u003e\n                    {{selectionCompareFinale == 0 ? selectionCompareFinale = defaultValue : &#39;&#39; ; \&#34;\&#34;}}\n                    {{ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId] = selectionCompareFinale ; \&#34;\&#34;}}\n                    {{ctx2.parameters}}\n                \u003c/span\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n\u003c/section\u003e\n\n\u003c!-- {{ctx1.parameters}} // {{ctx2.parameters}}  --\u003e                \u003cdiv ods-facet-results=\&#34;items1\&#34; ods-facet-results-context=\&#34;ctx1\&#34;\n                     ods-facet-results-facet-name=\&#34;{{filterFieldLabel}}\&#34;\u003e\n                    \u003cdiv ods-facet-results=\&#34;items2\&#34; ods-facet-results-context=\&#34;ctx2\&#34;\n                         ods-facet-results-facet-name=\&#34;{{filterFieldLabel}}\&#34;\u003e\n                        \u003csection class=\&#34;box-container\&#34; ng-repeat=\&#34;kpi in kpis\&#34;\u003e\n  \u003cdiv class=\&#34;row row-equal-height\&#34; ods-adv-analysis=\&#34;kpi1\&#34; ods-adv-analysis-context=\&#34;ctx1\&#34; ods-adv-analysis-select=\&#34;{{ kpi.select }} as x\&#34;\u003e\n    \u003cdiv class=\&#34;col-md-4\&#34;\u003e\n      \u003c!-- KPI box component --\u003e\n      \u003cdiv class=\&#34;kpi-card\&#34;\u003e\n        \u003ci ng-if=\&#34;kpi.faicon\&#34; class=\&#34;kpi-icon fa fa-{{ kpi.faicon }}\&#34; aria-hidden=\&#34;true\&#34;\u003e\u003c/i\u003e\n        \u003cp class=\&#34;kpi-title left\&#34;\u003e\n          {{ (kpi1[0].x || 0) | number : (kpi.precision || 0) }}         \n           \u003cspan ng-if=\&#34;kpi.unit\&#34; class=\&#34;kpi-unit left\&#34;\u003e{{ kpi.unit }}\u003c/span\u003e\n        \u003c/p\u003e\n        \u003cp class=\&#34;kpi-description\&#34;\u003e\n          {{ kpi.title }}\n        \u003c/p\u003e\n        \u003cp class=\&#34;kpi-subtitle\&#34;\n          ng-if=\&#34;compareType == &#39;multiFields&#39;\&#34;\u003e\n          {{ selected1[fields[3].name][0].name ||\n            selected1[fields[2].name][0].name ||\n            selected1[fields[1].name][0].name ||\n            selected1[fields[0].name][0].name || defaultLevel }}\u003c/p\u003e\n        \n        \u003cp class=\&#34;kpi-subtitle\&#34; ng-if=\&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length \u003e0\&#34;\u003e\n          {{results1[0].fields[filterFieldLabel]}}\u003c/p\u003e\n          \u003cp class=\&#34;kpi-subtitle\&#34; ng-if=\&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 \u0026\u0026 compareType==&#39;singleField&#39;\&#34;\u003e\n            {{defaultLevel}}\u003c/p\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n    \u003cdiv class=\&#34;col-md-4\&#34;  ods-adv-analysis=\&#34;kpi2\&#34; ods-adv-analysis-context=\&#34;ctx2\&#34; ods-adv-analysis-select=\&#34;{{ kpi.select }} as x\&#34;\u003e\n      \u003c!-- KPI box component --\u003e\n      \u003cdiv class=\&#34;kpi-card\&#34;\u003e\n        \u003ci ng-if=\&#34;kpi.faicon\&#34; class=\&#34;kpi-icon fa fa-{{ kpi.faicon }}\&#34; aria-hidden=\&#34;true\&#34;\u003e\u003c/i\u003e\n        \u003cp class=\&#34;kpi-title right\&#34;\u003e\n          {{ (kpi2[0].x || 0) | number : (kpi.precision || 0) }}         \n          \u003cspan ng-if=\&#34;kpi.unit\&#34; class=\&#34;kpi-unit right\&#34;\u003e{{ kpi.unit }}\u003c/span\u003e\n        \u003c/p\u003e\n        \u003cp class=\&#34;kpi-description\&#34;\u003e\n          {{ kpi.title }}\n        \u003c/p\u003e\n        \u003cp class=\&#34;kpi-subtitle\&#34;\n          ng-if=\&#34;compareType == &#39;multiFields&#39;\&#34;\u003e\n          {{ selected2[fields[3].name][0].name ||\n            selected2[fields[2].name][0].name ||\n            selected2[fields[1].name][0].name ||\n            selected2[fields[0].name][0].name || defaultLevel }}\u003c/p\u003e\n        \u003cp class=\&#34;kpi-subtitle\&#34; ng-if=\&#34;ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId].length \u003e0\&#34;\u003e\n          {{results2[0].fields[filterFieldLabel]}}\u003c/p\u003e\n          \u003cp class=\&#34;kpi-subtitle\&#34; ng-if=\&#34;ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 \u0026\u0026 compareType==&#39;singleField&#39;\&#34;\u003e\n            {{defaultLevel}}\u003c/p\u003e\n\n        \u003cp class=\&#34;kpi-compare right\&#34;\u003e\n          {{ ((kpi2[0].x - kpi1[0].x )/kpi1[0].x )*100 \u003e 0 ? &#39;&#43;&#39; : &#39;&#39; }}{{ (((kpi2[0].x -kpi1[0].x )/kpi1[0].x )*100|| 0) | number : 2 }}%\n        \u003c/p\u003e\n        \u003cspan style=\&#34;font-style: italic;\&#34;\u003epar rapport à \u003c/span\u003e\n        \u003cp class=\&#34;kpi-compare-subtitle\&#34; ng-if=\&#34;ctx1.parameters[&#39;refine.&#39; &#43; levelRefSelectedId].length \u003e0\&#34;\u003e\u003cspan\n            ng-repeat=\&#34;item1 in items1\&#34;\u003e {{item1.name}}{{$last ? &#39;&#39; : &#39; &#43; &#39;}} \u003c/span\u003e\u003c/p\u003e\n        \u003cp class=\&#34;kpi-compare-subtitle\&#34;\n          ng-if=\&#34;compareType == &#39;multiFields&#39;\&#34;\u003e\n          {{ selected1[fields[3].name][0].name ||\n            selected1[fields[2].name][0].name ||\n            selected1[fields[1].name][0].name ||\n            selected1[fields[0].name][0].name || defaultLevel }}\u003c/p\u003e\n        \u003cp class=\&#34;kpi-compare-subtitle\&#34; ng-if=\&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length \u003e0\&#34;\u003e\n          {{results1[0].fields[filterFieldLabel]}}\u003c/p\u003e\n          \u003cp class=\&#34;kpi-compare-subtitle\&#34; ng-if=\&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 \u0026\u0026 compareType==&#39;singleField&#39;\&#34;\u003e\n            {{defaultLevel}}\u003c/p\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n\u003c/section\u003e                        \u003cdiv style=\&#34;text-align: right; width: 100%\&#34;\u003e\n                            \u003ca href=\&#34;https://{{ domainid }}/explore/dataset/{{ datasetid }}/\&#34;\n                               target=\&#34;_blank\&#34;\u003eAccéder\n                                aux données sources\u003c/a\u003e\n                        \u003c/div\u003e\n                        \u003cspan ng-repeat=\&#34;chart in charts\&#34;\u003e\n                                    \u003cspan ng-if=\&#34;chart.disposition==&#39;pyramid&#39;\&#34;\u003e\n                                        \u003csection class=\&#34;page-section\&#34; ng-init=\&#34;pyramid = {&#39;analysisref&#39;:undefined,\n                            &#39;analysiscompare&#39;:undefined,\n                            &#39;orderref&#39;:{},\n                            &#39;ordercompare&#39;:{},\n                            &#39;defaultorder&#39;:&#39;orderref&#39;}\&#34;\u003e\n\n    \u003cdiv class=\&#34;box-container\&#34;\u003e\n        \u003cdiv class=\&#34;chart-card\&#34;\u003e\n            \u003ch2\u003e{{chart.title}}\u003c/h2\u003e\n            \u003cspan ods-adv-analysis=\&#34;analysisref\&#34; ods-adv-analysis-context=\&#34;ctx1\&#34;\n                ods-adv-analysis-group-by=\&#34;{{chart.xAxis}}\&#34; ods-adv-analysis-select=\&#34;{{chart.select}} as counttotal\&#34;\n                ods-adv-analysis-order-by=\&#34;{{chart.select}} DESC\&#34;\u003e\n                \u003cdiv ods-subaggregation=\&#34;analysisref\&#34; ods-subaggregation-serie-max=\&#34;MAX(counttotal)\&#34;\u003e\n\n                    {{ pyramid[&#39;maxref&#39;] = results[0].max; &#39;&#39; }}\n                \u003c/div\u003e\n\n                {{ pyramid.analysisref = analysisref ; &#39;&#39; }}\n            \u003c/span\u003e\n            \u003cspan ods-adv-analysis=\&#34;analysiscompare\&#34; ods-adv-analysis-context=\&#34;ctx2\&#34;\n                ods-adv-analysis-group-by=\&#34;{{chart.xAxis}}\&#34; ods-adv-analysis-select=\&#34;{{chart.select}} as counttotal\&#34;\n                ods-adv-analysis-order-by=\&#34;{{chart.select}} DESC\&#34;\u003e\n                \u003cdiv ods-subaggregation=\&#34;analysiscompare\&#34; ods-subaggregation-serie-max=\&#34;MAX(counttotal)\&#34;\u003e\n                    {{ pyramid[&#39;maxcompare&#39;] = results[0].max; &#39;&#39; }}\n                \u003c/div\u003e\n\n                {{ pyramid.analysiscompare = analysiscompare ; &#39;&#39; }}\n            \u003c/span\u003e\n            \u003cspan ng-if=\&#34;pyramid[&#39;maxref&#39;] \u0026\u0026 pyramid[&#39;maxcompare&#39;]\&#34;\u003e\n                {{ pyramid[&#39;max&#39;] =\n                (pyramid[&#39;maxcompare&#39;]\u003epyramid[&#39;maxref&#39;]?pyramid[&#39;maxcompare&#39;]:pyramid[&#39;maxref&#39;]); &#39;&#39; }}\n            \u003c/span\u003e\n\n            \u003cp ng-if=\&#34;pyramid.defaultorder == &#39;orderref&#39;\&#34; ng-repeat=\&#34;(i,item) in pyramid.analysisref\&#34;\u003e\n                {{ pyramid.order[item[chart.xAxis]] = i&#43;1; &#39;&#39; }}\n            \u003c/p\u003e\n            \u003cp ng-if=\&#34;pyramid.defaultorder == &#39;ordercompare&#39;\&#34; ng-repeat=\&#34;(i,item) in pyramid.analysiscompare\&#34;\u003e\n                {{ pyramid.order[item[chart.xAxis]] = i&#43;1; &#39;&#39; }}\n            \u003c/p\u003e\n\n            \u003c!--Custom Left/Right Graph here\n    ========================================================================== --\u003e\n\n            \u003cdiv class=\&#34;custom-graph\&#34;\u003e\n                \u003cdiv class=\&#34;custom-graph-body\&#34;\u003e\n                    \u003cdiv class=\&#34;custom-graph-block\&#34;\u003e\n                        \u003cdiv class=\&#34;custom-graph-header header-left left\&#34;\u003e\n                            \u003ch3 class=\&#34;custom-graph-title\&#34;\u003e\n                                \u003cspan ng-if=\&#34;compareType==&#39;multiFields&#39;\&#34;\u003e {{ selected1[fields[3].name][0].name ||\n                                    selected1[fields[2].name][0].name ||\n                                    selected1[fields[1].name][0].name ||\n                                    selected1[fields[0].name][0].name || defaultLevel }}\n                                \u003c/span\u003e\n                                \u003cspan ng-if=\&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length \u003e0\&#34;\u003e\n                                    {{results1[0].fields[filterFieldLabel]}}\u003c/span\u003e\n                                \u003cspan\n                                    ng-if=\&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 \u0026\u0026 compareType==&#39;singleField&#39;\&#34;\u003e\n                                    {{defaultLevel}}\u003c/span\u003e\n                            \u003c/h3\u003e\n                            \u003ch4\u003e{{chart.label}}\u003c/h4\u003e\n                        \u003c/div\u003e\n                        \u003cdiv class=\&#34;custom-graph-content-left\&#34;\u003e\n                            \u003cdiv class=\&#34;custom-graph-item\&#34; ng-repeat=\&#34;itemleft in pyramid.analysisref\&#34;\n                                ng-if=\&#34;pyramid.order[itemleft[chart.xAxis]]\u003c=10\&#34; style=\&#34;grid-row: {{ pyramid.order[itemleft[chart.xAxis]] }} ;\n                                    grid-column:1\&#34;\u003e\n                                \u003ch5 class=\&#34;custom-graph-item-title\&#34;\u003e\n                                    {{ itemleft[chart.xAxis] }}\n                                \u003c/h5\u003e\n                                \u003cdiv class=\&#34;custom-graph-progress-container\&#34;\u003e\n                                    \u003cdiv class=\&#34;custom-graph-progress background-left\&#34;\n                                        style=\&#34;width: {{ 100 * itemleft.counttotal / pyramid.max }}%\&#34;\u003e\n                                        \u003cspan class=\&#34;custom-graph-progress-value\&#34;\u003e\n                                            {{ itemleft.counttotal | number }}\n                                        \u003c/span\u003e\n                                    \u003c/div\u003e\n                                \u003c/div\u003e\n                            \u003c/div\u003e\n                        \u003c/div\u003e\n                    \u003c/div\u003e\n\n                    \u003cdiv class=\&#34;custom-graph-separator\&#34;\u003e\u003c/div\u003e\n                    \u003cdiv class=\&#34;custom-graph-block\&#34;\u003e\n                        \u003cdiv class=\&#34;custom-graph-header header-right right\&#34;\u003e\n                            \u003ch3 class=\&#34;custom-graph-title\&#34;\u003e\n                                \u003cspan ng-if=\&#34;compareType==&#39;multiFields&#39;\&#34;\u003e {{ selected2[fields[3].name][0].name ||\n                                    selected2[fields[2].name][0].name ||\n                                    selected2[fields[1].name][0].name ||\n                                    selected2[fields[0].name][0].name || defaultLevel }}\u003c/span\u003e\n                                \u003cspan ng-if=\&#34;ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId].length \u003e0\&#34;\u003e\n                                    {{results2[0].fields[filterFieldLabel]}}\u003c/span\u003e\n                                \u003cspan\n                                    ng-if=\&#34;ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 \u0026\u0026 compareType==&#39;singleField&#39;\&#34;\u003e\n                                    {{defaultLevel}}\u003c/span\u003e\n                            \u003c/h3\u003e\n                            \u003ch4\u003e{{chart.label}}\u003c/h4\u003e\n                        \u003c/div\u003e\n                        \u003cdiv class=\&#34;custom-graph-content-right\&#34;\u003e\n                            \u003cdiv class=\&#34;custom-graph-item\&#34; ng-repeat=\&#34;itemright in pyramid.analysiscompare\&#34;\n                                ng-if=\&#34;pyramid.order[itemright[chart.xAxis]]\u003c=10\&#34; style=\&#34;grid-row: {{ pyramid.order[itemright[chart.xAxis]] }} ;\n                                    grid-column:1\&#34;\u003e\n                                \u003ch5 class=\&#34;custom-graph-item-title\&#34;\u003e\n                                    {{ itemright[chart.xAxis] }}\n                                \u003c/h5\u003e\n                                \u003cdiv class=\&#34;custom-graph-progress-container\&#34;\u003e\n                                    \u003cdiv class=\&#34;custom-graph-progress background-right\&#34;\n                                        style=\&#34;width: {{ 100 * itemright.counttotal / pyramid.max }}%\&#34;\u003e\n                                        \u003cspan class=\&#34;custom-graph-progress-value\&#34;\u003e\n                                            {{ itemright.counttotal | number }}\n                                        \u003c/span\u003e\n                                    \u003c/div\u003e\n                                \u003c/div\u003e\n                            \u003c/div\u003e\n                        \u003c/div\u003e\n                    \u003c/div\u003e\n                \u003c/div\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n\u003c/section\u003e                                    \u003c/span\u003e\n                                    \u003cspan ng-if=\&#34;chart.disposition==&#39;classic&#39;\&#34;\u003e\n                                        \u003cdiv class=\&#34;box-container\&#34;\u003e\n    \u003cdiv class=\&#34;chart-card\&#34;\u003e\n        \u003ch2\u003e{{chart.title}}\u003c/h2\u003e\n        \u003cods-chart ng-if=\&#34;compareType==&#39;multiFields&#39;\&#34; align-month=\&#34;true\&#34; single-y-axis=\&#34;true\&#34; labels-x-length=\&#34;25\&#34;\u003e\n            \u003cods-chart-query context=\&#34;ctx1\&#34; field-x=\&#34;{{chart.xAxis}}\&#34; maxpoints=\&#34;{{chart.maxPoints}}\&#34;\n                sort=\&#34;{{chart.sort}}\&#34;\u003e\n                \u003cods-chart-serie label-y=\&#34;{{ chart.label &#43; &#39; - &#39; &#43; (selected1[fields[3].name][0].name ||\n                selected1[fields[2].name][0].name ||\n                selected1[fields[1].name][0].name ||\n                selected1[fields[0].name][0].name ||defaultLevel ) }}\&#34; expression-y=\&#34;{{chart.xAxis}}\&#34; chart-type=\&#34;{{chart.type}}\&#34;\n                    function-y=\&#34;{{chart.function}}\&#34; color=\&#34;#08A8AB\&#34; scientific-display=\&#34;true\&#34;\n                    display-values=\&#34;{{chart.displayValues}}\&#34; logarithmic=\&#34;true\&#34;\u003e\n                \u003c/ods-chart-serie\u003e\n            \u003c/ods-chart-query\u003e\n            \u003cods-chart-query context=\&#34;ctx2\&#34; field-x=\&#34;{{chart.xAxis}}\&#34; maxpoints=\&#34;{{chart.maxPoints}}\&#34; sort=\&#34;{{chart.sort}}\&#34;\u003e\n                \u003cods-chart-serie label-y=\&#34;{{ chart.label &#43; &#39; - &#39; &#43; (selected2[fields[3].name][0].name ||\n                selected2[fields[2].name][0].name ||\n                selected2[fields[1].name][0].name ||\n                selected2[fields[0].name][0].name || defaultLevel) }}\&#34; expression-y=\&#34;{{chart.xAxis}}\&#34; chart-type=\&#34;{{chart.type}}\&#34;\n                    function-y=\&#34;{{chart.function}}\&#34; color=\&#34;#D5AC00\&#34; scientific-display=\&#34;true\&#34;\n                    display-values=\&#34;{{chart.displayValues}}\&#34; logarithmic=\&#34;true\&#34;\u003e\n                \u003c/ods-chart-serie\u003e\n            \u003c/ods-chart-query\u003e\n        \u003c/ods-chart\u003e\n        \u003cods-chart ng-if=\&#34;compareType==&#39;singleField&#39;\&#34; align-month=\&#34;true\&#34; single-y-axis=\&#34;true\&#34; labels-x-length=\&#34;25\&#34;\u003e\n            \u003cods-chart-query context=\&#34;ctx1\&#34; field-x=\&#34;{{chart.xAxis}}\&#34; maxpoints=\&#34;{{chart.maxPoints}}\&#34;\n                sort=\&#34;{{chart.sort}}\&#34;\u003e\n                \u003cods-chart-serie label-y=\&#34;{{ chart.label &#43; &#39; - &#39; &#43; ((items1 | toObject : &#39;name&#39; | keys).length == 1 ? (items1 | toObject : &#39;name&#39; | keys) : defaultLevel) }}\&#34; expression-y=\&#34;{{chart.xAxis}}\&#34; chart-type=\&#34;{{chart.type}}\&#34;\n                    function-y=\&#34;{{chart.function}}\&#34; color=\&#34;#08A8AB\&#34; scientific-display=\&#34;true\&#34;\n                    display-values=\&#34;{{chart.displayValues}}\&#34; logarithmic=\&#34;true\&#34;\u003e\n                \u003c/ods-chart-serie\u003e\n            \u003c/ods-chart-query\u003e\n            \u003cods-chart-query context=\&#34;ctx2\&#34; field-x=\&#34;{{chart.xAxis}}\&#34; maxpoints=\&#34;{{chart.maxPoints}}\&#34; sort=\&#34;{{chart.sort}}\&#34;\u003e\n                \u003cods-chart-serie label-y=\&#34;{{ chart.label &#43; &#39; - &#39; &#43; ((items2 | toObject : &#39;name&#39; | keys).length == 1 ? (items2 | toObject : &#39;name&#39; | keys) : defaultLevel) }}\&#34; expression-y=\&#34;{{chart.xAxis}}\&#34; chart-type=\&#34;{{chart.type}}\&#34;\n                    function-y=\&#34;{{chart.function}}\&#34; color=\&#34;#D5AC00\&#34; scientific-display=\&#34;true\&#34;\n                    display-values=\&#34;{{chart.displayValues}}\&#34; logarithmic=\&#34;true\&#34;\u003e\n                \u003c/ods-chart-serie\u003e\n            \u003c/ods-chart-query\u003e\n        \u003c/ods-chart\u003e\n    \u003c/div\u003e\n\u003c/div\u003e                                    \u003c/span\u003e\n                                \u003c/span\u003e\n                    \u003c/div\u003e\n                \u003c/div\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n    \u003c/ods-dataset-context\u003e\n\u003c/div\u003e\u003c/ods-dataset-context\u003e\n\u003c/div\u003e&#34;,
                 "css": &#34;/* General Layout\n========================================================================== */\n:root {\n  --left-color: #08a8ab;\n  --right-color: #d5ac00;\n  --secondary-color: black;\n}\n\n.left {\n  color: var(--left-color);\n}\n\n.right {\n  color: var(--right-color);\n}\n\n.background-left {\n  background-color: var(--left-color);\n}\n\n.background-right {\n  background-color: var(--right-color);\n}\n\n@media screen and (min-width: 992px) {\n  .row-equal-height {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -ms-flex-wrap: wrap;\n    flex-wrap: wrap;\n    margin-bottom: 20px;\n    width: 100%;\n    justify-content: space-around;\n  }\n\n  /* Fix for early content wrapping in Safari*/\n  .row-equal-height:before,\n.row-equal-height:after {\n    content: normal;\n  }\n}\n\n\n.page-title {\n  font-size: 3rem;\n  font-weight: bold;\n  margin-top: 0;\n  margin-bottom: 1rem;\n}\n\n.page-subtitle {\n  font-size: 1.2rem;\n  line-height: 2;\n  margin-top: 0;\n  margin-bottom: 3rem;\n}\n\n.box-container {\n  padding: 10px 0px;\n}\n\n@media screen and (min-width: 992px) {\n  .box-container {\n    display: flex;\n    justify-content: center;\n  }\n}\n\n/* Filters\n========================================================================== */\n.ods-selects {\n  display: flex;\n  flex-direction: column;\n  gap: 5px;\n}\n\n.filterbloc {\n  background-color: var(--boxes-background);\n  height: 100%;\n  padding: 20px 0px;\n  border-radius: 4px;\n  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.13);\n  margin: 10px 0px;\n  width: 100%;\n}\n\n.filterbloc-title {\n  text-align: center;\n}\n\n.filter-list {\n  display: flex;\n  flex-wrap: wrap;\n  position: relative;\n  margin-bottom: 20px;\n  justify-content: space-around;\n}\n\n.filter-list \u003e * {\n  margin: 0 0 10px;\n  width: 100%;\n}\n\n.filter-box {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  align-items: center;\n}\n\n.filter-title {\n  margin-top: 15px;\n  margin-bottom: 0px;\n}\n\n.odswidget-select .odswidget-select-dropdown.open .odswidget-select-dropdown-menu {\n  width: 100%;\n}\n\n.odswidget-select,\n.odswidget-select .odswidget-select-dropdown {\n  width: 100%;\n}\n\n@media screen and (min-width: 500px) {\n  .filter-list \u003e * {\n    margin: 0 10px 10px 0;\n    width: inherit;\n  }\n\n  .odswidget-select .odswidget-select-dropdown.open .odswidget-select-dropdown-menu, .odswidget-select-input, .odswidget-select-dropdown {\n    width: max-content;\n    min-width: 266px;\n  }\n}\n.select-left .odswidget-select-dropdown-item-close-icon, .select-left .odswidget-select-dropdown-item-icon.fa-check-square,\n.select-left .odswidget-select-dropdown-item-icon.fa-minus-square,\n.select-left .odswidget-select-dropdown-menu-item:hover i.fa-square-o {\n  color: var(--left-color);\n}\n\n.select-right .odswidget-select-dropdown-item-close-icon, .select-right .odswidget-select-dropdown-item-icon.fa-check-square,\n.select-right .odswidget-select-dropdown-item-icon.fa-minus-square,\n.select-right .odswidget-select-dropdown-menu-item:hover i.fa-square-o {\n  color: var(--right-color);\n}\n\n.clear-filters {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-top: 5px;\n}\n\n.clear-filters-button {\n  background: none;\n  border: none;\n  color: var(--text);\n}\n\n.clear-filters-button:hover {\n  opacity: 0.65;\n}\n\n/* KPI Card\n========================================================================== */\n.kpi-card {\n  background-color: var(--boxes-background);\n  height: 100%;\n  padding: 39px;\n  border-radius: 4px;\n  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.13);\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -ms-flex-direction: column;\n  flex-direction: column;\n  -webkit-box-align: center;\n  -ms-flex-align: center;\n  align-items: center;\n  text-align: center;\n  -webkit-box-pack: center;\n  -ms-flex-pack: center;\n  justify-content: center;\n  text-align: center;\n  width: 100%;\n  margin-bottom: 5px;\n}\n\n.kpi-icon {\n  color: var(--secondary-color);\n  font-size: 4rem;\n  margin-top: 0;\n  margin-bottom: 13px;\n  max-width: 100%;\n}\n\n.kpi-title {\n  font-weight: normal;\n  font-size: 3.2rem;\n  margin-top: 0;\n  max-width: 100%;\n  margin-bottom: 5px;\n}\n\n.kpi-compare {\n  font-weight: normal;\n  font-size: 1.8rem;\n  margin-top: 0;\n  margin-bottom: 0px;\n  max-width: 100%;\n}\n\n.kpi-unit {\n  font-size: 0.8em;\n}\n\n.kpi-description {\n  color: var(--text);\n  font-size: 1rem;\n  line-height: 1.5;\n  font-weight: normal;\n  margin-top: 0;\n  margin-bottom: 0;\n  max-width: 100%;\n}\n\n.kpi-subtitle {\n  font-weight: bold;\n  text-transform: uppercase;\n  margin-bottom: 0;\n}\n\n.kpi-compare-subtitle {\n  text-transform: uppercase;\n  margin-bottom: 0;\n}\n\n/* Charts\n========================================================================== */\n.chart-card {\n  background-color: var(--boxes-background);\n  height: 100%;\n  padding: 39px;\n  border-radius: 4px;\n  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.13);\n  display: block;\n  width: 100%;\n  margin-bottom: 10px;\n}\n\n.chart-title:first-child {\n  margin-top: 20px;\n}\n\nrect.highcharts-background {\n  fill: transparent !important;\n}\n\n/* Custom Charts\n========================================================================== */\n.custom-graph {\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 4rem;\n  width: 100%;\n}\n\n.custom-graph-body {\n  display: flex;\n  align-items: stretch;\n}\n\n.custom-graph-block {\n  flex: 1 1 auto;\n}\n\n.custom-graph-separator {\n  width: 3px;\n  background-color: #232423;\n}\n\n.custom-graph-header {\n  display: block;\n  margin-bottom: 0.5rem;\n}\n.custom-graph-header h4 {\n  margin-top: 0;\n}\n\n.header-right {\n  text-align: right;\n}\n\n.custom-graph-title {\n  font-size: 1.43rem;\n  margin: 0;\n  text-transform: uppercase;\n  color: var(--titles);\n  font-weight: bold;\n}\n\n.custom-graph-content {\n  display: grid;\n}\n\n.custom-graph-item {\n  border-bottom: 1px solid #979797;\n  margin-top: 0.5rem;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  min-height: 50px;\n}\n\n.custom-graph-item-title {\n  font-size: 0.75rem;\n  color: var(--titles);\n  font-weight: normal;\n  margin: 0;\n  flex: 0 0 35%;\n}\n\n.custom-graph-progress-container {\n  align-self: end;\n  flex: 1 1 65%;\n}\n\n.custom-graph-progress {\n  height: 30px;\n  display: flex;\n  align-items: center;\n}\n\n.custom-graph-progress-value {\n  font-size: 0.625rem;\n  color: var(--titles);\n  margin: 0 9px;\n}\n\n.custom-graph-content-left .custom-graph-progress {\n  margin-left: auto;\n  border-radius: 8px 0 0 8px;\n  justify-content: flex-end;\n}\n\n.custom-graph-content-right .custom-graph-item-title {\n  order: 1;\n  text-align: right;\n}\n\n.custom-graph-content-right .custom-graph-progress {\n  order: 1;\n  margin-right: auto;\n  border-radius: 0 8px 8px 0;\n  justify-content: flex-start;\n}\n\n.custom-graph-inverted-text-color .custom-graph-progress-value,\n.custom-graph-inverted-text-color .custom-graph-item-title {\n  color: inherit;\n}&#34;
               }'>
    </form>
</div>
<div class="ods-content">
    <div class="box-live-example"
      style="height: 750px;">
      <iframe id="iframe-automated-comparison-dashboard"
              width="100%" height="100%"
              src="about:blank"
              srcdoc="
                <head>&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css&#34;
/&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css&#34;
/&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.css&#34;
/&gt;

&lt;!-- ODS Platform CSS - must be hosted on static : WIP --&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://s3-us-west-2.amazonaws.com/s.cdpn.io/4124551/ods.css&#34;
/&gt;
&lt;link
  rel=&#34;stylesheet&#34;
  href=&#34;https://codelibrary.opendatasoft.com/css/theme.css&#34;
/&gt;

&lt;script src=&#34;//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;//cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;//cdnjs.cloudflare.com/ajax/libs/angular-sanitize/1.8.2/angular-sanitize.min.js&#34;&gt;&lt;/script&gt;
&lt;script
  type=&#34;text/javascript&#34;
  src=&#34;https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.js&#34;
&gt;&lt;/script&gt;

&lt;script
  type=&#34;text/javascript&#34;
  src=&#34;https://codelibrary.opendatasoft.com/js/platform-filters.js&#34;
&gt;&lt;/script&gt;
&lt;script
  type=&#34;text/javascript&#34;
  src=&#34;https://codelibrary.opendatasoft.com/js/ods-catalog-card.js&#34;
&gt;&lt;/script&gt;

&lt;script type=&#34;text/javascript&#34;&gt;
  const sourceMonitoringInterceptor = $q =&gt; {
    return {
      request: config =&gt; {
        console.log(config.url);
        if (config.params)
          if (config.params.source) delete config.params.source;

        config.url = config.url.replace(
          &#34;ods-api-monitoring&#34;,
          &#34;monitoring-copy&#34;
        );
        return config;
      }
    };
  };

  angular
    .module(&#34;ods-widgets&#34;)
    .config(function(ODSWidgetsConfigProvider, $httpProvider) {
      ODSWidgetsConfigProvider.setConfig({
        defaultDomain: &#34;https://userclub.opendatasoft.com/&#34;,
        basemaps: [
          {
            provider: &#34;jawg.light&#34;,
            label: &#34;Jawg Light&#34;,
            jawg_apikey: &#34;opendatasoft-community&#34;
          },
          {
            provider: &#34;jawg.streets&#34;,
            label: &#34;Jawg Streets&#34;,
            jawg_apikey: &#34;opendatasoft-community&#34;,
            id: &#34;streets&#34;
          }
        ],
        themes: {
          default: {
            url: &#34;/img/ods.svg&#34;
          },
          Santé: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/doctors.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Culture, Patrimoine&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/culture.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Éducation, Formation, Recherche, Enseignement&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/college.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          Environment: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/leaf.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Transports, Déplacements&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/train_station.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Aménagement du territoire, Urbanisme, Bâtiments, Équipements, Logement&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/townplanning.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Économie, Business, PME, Développement économique, Emploi&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/economy.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Administration, Gouvernement, Finances publiques, Citoyenneté&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/administration.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Justice, Sécurité, Police, Crime&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/court.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Sport, Loisirs&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/soccer.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Hébergement, Restauration&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/accommodation.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          &#34;Services, Social&#34;: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/social.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          Checklist: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/copyshop.svg&#34;,
            color: &#34;#1446A0&#34;
          },
          Usages: {
            url:
              &#34;https://userclub.opendatasoft.com/static/pictos/img/set-v3/pictos/bike.svg&#34;,
            color: &#34;#1446A0&#34;
          }
        },
        mapPrependAttribution: &#34;Jawg apikey NOT suitable for production&#34;
      });
      $httpProvider.interceptors.push(sourceMonitoringInterceptor);
    });
&lt;/script&gt;
</head>
                <body>
                <div ng-app='ods-widgets'>&lt;div ng-app=&#34;ods-widgets&#34;&gt;
&lt;ods-dataset-context context=&#34;ctx&#34;
 ctx-dataset=&#34;healthref-france-finess&#34;
 ctx-domain=&#34;userclub&#34;&gt;
&lt;!-- IMPORTANT ******** MUST READ !

    In the following settings declaration :

    A common error is forget to escape (protect) apostrophe with a leading backslash
    As apostrophes are used to declare values of variable it will break the settings

    Ex:
    wrongVariable = &#39;I&#39;ll be freed from apostrophes&#39;
    correctVariable = &#39;I\&#39;ll be freed from apostrophes&#39;
--&gt;

&lt;!-- SETTINGS START HERE --&gt;
&lt;div class=&#34;container&#34;
ng-init=&#34;domain = &#39;userclub.opendatasoft.com&#39;;
                datasetid = &#39;healthref-france-finess&#39;;
                
                refineField = &#39;&#39;;
                refineValue = &#39;&#39;;

                pageTitle = &#39;Analyse : Etablissements du domaine sanitaire et social en France&#39;;
                pageSubtitle = &#39;Cette page permet de comparer la répartition des établissements du domaine sanitaire et social en France. Sélectionnez les territoires à comparer et parcourez les différents indicateurs et graphiques pour dresser votre analyse.&#39;;

                compareType = &#39;multiFields&#39;;
                
                filterTitle = &#39;Sélectionnez les catégories à comparer&#39;;
                referenceFitlerTitle = &#39;Catégorie de référence&#39;;
                compareFilterTitle = &#39;Catégorie à comparer&#39;;

                defaultLevel = &#39;France entière&#39;;

                IF_COMPARE_BY_MULTIFIELDS;

                fields = [
                {name:&#39;Région&#39;,idField:&#39;code_officiel_region&#39;,labelField:&#39;nom_officiel_region&#39;, placeholder:&#39;Toutes régions&#39;},
                {name:&#39;Département&#39;, idField:&#39;departement&#39;,labelField:&#39;libelle_departement&#39;, placeholder:&#39;Tous départements&#39;},
                {name:&#39;EPCI&#39;, idField:&#39;code_officiel_epci&#39;,labelField:&#39;nom_officiel_epci&#39;, placeholder:&#39;Tous EPCIs&#39;},
                {name:&#39;Commune&#39;, idField:&#39;code_commune&#39;,labelField:&#39;nom_officiel_commune&#39;, placeholder:&#39;Toutes communes&#39;}
                ];

                resetFiltersButtonLabel = &#39;Supprimer tous les filtres&#39;;

                IF_COMPARE_BY_SINGLEFIELD;

                filterFieldId = &#39;alert_country&#39;;
                filterFieldLabel = &#39;alert_country&#39;;

                defaultValue = &#39;&#39;;

                filterPlaceholder = &#39;Sélectionnez une valeur&#39;;

                kpis = [ 
                {
                &#39;title&#39;: &#39;Nombre d\&#39;établissements&#39;,
                &#39;select&#39;: &#39;count(*)&#39;,
                &#39;precision&#39;: 0,
                &#39;unit&#39;: &#39;&#39;,
                &#39;faicon&#39;: &#39;square-o&#39;
                }
                ];

                charts = [
                { 
                &#39;disposition&#39;:&#39;pyramid&#39;,
                &#39;title&#39;:&#39;Répartition par mode de fixation des tarifs&#39;,
                &#39;xAxis&#39;:&#39;libelle_mft&#39;,
                &#39;label&#39;:&#39;Nombre d\&#39;établissements&#39;,
                &#39;select&#39;:&#39;count(*)&#39;
                },
                { 
                &#39;disposition&#39;:&#39;pyramid&#39;,
                &#39;title&#39;:&#39;Répartition par catégorie d\’établissement&#39;,
                &#39;xAxis&#39;:&#39;libelle_categorie_d_etablissement&#39;,
                &#39;label&#39;:&#39;Nombre d\&#39;établissements&#39;,
                &#39;select&#39;:&#39;count(*)&#39;
                },
                { 
                &#39;disposition&#39;:&#39;classic&#39;,
                &#39;title&#39;:&#39;Participation au service public hospitalier&#39;,
                &#39;xAxis&#39;:&#39;libelle_sph&#39;,
                &#39;type&#39;:&#39;line&#39;,
                &#39;function&#39;:&#39;COUNT&#39;,
                &#39;maxPoints&#39;:&#39;20&#39;,
                &#39;displayValues&#39;:&#39;true&#39;,
                &#39;label&#39;:&#39;Nombre d\&#39;établissements&#39;,
                &#39;sort&#39;:&#39;serie1-1&#39;,
                &#39;expression&#39;:&#39;&#39;
                },
                { 
                &#39;disposition&#39;:&#39;classic&#39;,
                &#39;title&#39;:&#39;Date d\&#39;ouverture&#39;,
                &#39;xAxis&#39;:&#39;date_d_ouverture&#39;,
                &#39;label&#39;:&#39;Nombre d\&#39;établissements&#39;,
                &#39;type&#39;:&#39;line&#39;,
                &#39;function&#39;:&#39;COUNT&#39;,
                &#39;expression&#39;:&#39;&#39;,
                &#39;sort&#39;:&#39;&#39;,
                &#39;maxPoints&#39;:&#39;&#39;,
                &#39;displayValues&#39;:&#39;true&#39;
                }
                ];



                DO_NOT_MODIFY_BELOW;

                selected1 = {};
                selected2 = {};
                selectionRefFinale = &#39;&#39;;
                selectionCompareFinale = {};
                &#34;&gt;
    &lt;!--

    --&gt;

    &lt;!-- ### GENERAL SETTINGS ### --&gt;
    &lt;!-- domain (Domain URL): Must contain the URL of the domain where the dataset is published.
     ex: &#39;public.opendatasoft.com&#39;
    --&gt;
    &lt;!-- datasetid (Dataset ID): Must contain the ID of the dataset
     ex: &#39;healthref-france-finess&#39;
    --&gt;
    &lt;!-- compareType: Must contain the type of comparison you want to do. 
            Can be multiFields (to do a comparison based on a serie of fields, for example geographical levels or category and sub-category) or singleField (to do a comparison based on a single field).
     ex: &#39;multiFields&#39;
    --&gt;

    &lt;!-- defaultLevel: the title you want to display when no filter is selected --&gt;


    &lt;!-- ### FILTERS SETTINGS ### --&gt;
    &lt;!-- IF_COMPARE_BY_MULTIFIELDS --&gt;
    &lt;!-- fields : List of fields available on the comparison filters, and their corresponding field id in the dataset.
        You can put as many fields as you have available on your dataset.
        List of parameters are :
        - name (label of the filter to be display on the filter list) ex: &#39;Region&#39;
        - idField (id of the field containing the id of the filter) ex: &#39;reg_code&#39;. can be the same as the labelField.
        - labelField (id of the field containing the label of the filter) ex: &#39;reg_name&#39;
        NB: the field must be a facet in the dataset
        NB: alphanumerical sort is applied in the filter view
        ex: 
        fields = [
                        {
                            name:&#39;Région&#39;,idField:&#39;reg_code&#39;,labelField:&#39;reg_name&#39;
                        },
                        {
                            name:&#39;Département&#39;,idField:&#39;dep_code&#39;,labelField:&#39;dep_name&#39;
                        },
                        {
                            name:&#39;EPCI&#39;,idField:&#39;epci_code&#39;,labelField:&#39;epci_name&#39;
                        },
                        {
                            name:&#39;Commune&#39;,idField:&#39;com_code&#39;,labelField:&#39;com_name&#39;
                        }
                ]
    --&gt;

        &lt;!-- resetFiltersButtonLabel (Label of the button) : test to display when a filter is selected
         ex: &#39;Clear all filters&#39;
    --&gt;

    &lt;!-- IF_COMPARE_BY_SINGLEFIELD --&gt;
    &lt;!--filterFieldId: id of the field containing the id of the filter field;
        filterFieldLabel: id of the field containing the label of the filter field;
        filterFieldId and filterFieldLabel can have the same id.
        ex:  filterFieldId = &#39;categetab&#39;;
             filterFieldLabel = &#39;libcategetab&#39;
    --&gt;

    &lt;!--defaultValue: default selected value you want to set up on the filter;
       ex:  defaultValue = &#39;44&#39;;
       WARNING: must be the value of the filterFieldId and NOT the filterFieldLabel, if they are different.
   --&gt;

    &lt;!-- filterPlaceholder: placeholder text for the filter --&gt;

    &lt;!-- ### KPIS SETTINGS ### --&gt;
    &lt;!-- KPIS settings is a list of object that describes each KPI
    List of available keys are:
    - title (string) : mandatory, name of the KPI, ex: ‘City population’
    - select (string) : mandatory, API V2 select, containing the calculation to perform, ex: ‘sum(population)’ or ‘count(*)’
    - precision (string) : optional, decimal precision of the KPI, ex: 2
    - unit (string) : optional, KPI unit, ex: ‘citizens’
    - faicon (string) : optional, FontAwesome icon id, ex: ‘square-o’ (omit the fa- prefix) 

    Please see the documentation for more information regarding the select
    https://help.opendatasoft.com/apis/ods-explore-v2/#section/Opendatasoft-Query-Language-(ODSQL)

    Please see all available icons here
    https://fontawesome.com/v4/icons/

    ex:
    kpis = [
              {
                  &#39;title&#39;: &#39;Nombre d\&#39;établissements&#39;,
                  &#39;select&#39;: &#39;count(*)&#39;,
                  &#39;precision&#39;: 0,
                  &#39;unit&#39;: &#39;&#39;,
                  &#39;faicon&#39;: &#39;square-o&#39;
              },
              {
                  &#39;title&#39;: &#39;Taille moyenne&#39;,
                  &#39;select&#39;: &#39;avg(surface)&#39;,
                  &#39;precision&#39;: 2,
                  &#39;unit&#39;: &#39;m2&#39;,
                  &#39;faicon&#39;: &#39;square-o&#39;
              }
           ];
--&gt;

    &lt;!-- ### CHARTS SETTINGS ### --&gt;
    &lt;!-- 2 dispositions are available: pyramid (custom css chart) and classic (ods-chart).
         Each disposition has specific parameters--&gt;
    &lt;!-- Pyramid disposition.
     List of available parameters are :
     - disposition (pyramid or classic) ex:&#39;pyramid&#39;
     - title (title of the chart) ex: &#39;Répartition par mode de fixation des tarifs&#39;
     - xAxis (id of the field for the X axis) ex: &#39;libmft&#39;
     - label (label of the serie) ex:&#39;Nombre d\&#39;établissements&#39;
     - select (function for the serie) ex:&#39;COUNT(*)&#39;

    disposition, title, xAxis, select are MANDATORY
    label is optionnal

    Available values for select are AVG, COUNT, MIN, MAX, STDDEV, SUM.
    Please see the documentation for more information
    https://help.opendatasoft.com/widgets/#/api/ods-widgets.directive:odsAnalysis

    ex:
    charts = [
                { 
                &#39;disposition&#39;:&#39;pyramid&#39;,
                &#39;title&#39;:&#39;Répartition par mode de fixation des tarifs&#39;,
                &#39;xAxis&#39;:&#39;libmft&#39;,
                &#39;label&#39;:&#39;Nombre d\&#39;établissements&#39;,
                &#39;select&#39;:&#39;COUNT(*)&#39;
                }
            ]
    --&gt;
    &lt;!-- Classic disposition.
 List of available parameters are :
 - disposition (pyramid or classic) ex:&#39;classic&#39;
 - title (title of the chart) ex: &#39;Date d\ouverture&#39;
 - xAxis (id of the field for the X axis) ex: &#39;dateouv&#39;
 - label (label of the serie) ex:&#39;Nombre d\&#39;établissements&#39;
 - type (type of chart) ex: &#39;line&#39;
 - function (function for the serie) ex:&#39;SUM&#39;
 - expression (field id that contains numerical values to use for the serie) ex: &#39;population&#39;
 - sort (rule to sort the data, empty for default order or serie1-1 to order by serie) ex:&#39;serie1-1&#39;
 - maxPoints (max number of points to display on the X axis) ex:&#39;20&#39;
 - displayValues (can be true or false, if true: values are displayed on the serie): ex:&#39;true&#39;

disposition, title, xAxis, select are MANDATORY
label is optionnal

Available values for type are line, spline, area, areaspline, column, bar, pie, scatter, polar, spiderweb, funnel, arearange, areasplinerange, columnrange

Available values for function are COUNT, AVG, MIN, MAX, STDDEV, SUM, QUANTILES, CONSTANT

Please see the documentation for more information
https://help.opendatasoft.com/widgets/#/api/ods-widgets.directive:odsChartSerie

ex:
charts = [
            {
            &#39;disposition&#39;:&#39;classic&#39;,
            &#39;title&#39;:&#39;Participation au service public hospitalier&#39;,
            &#39;xAxis&#39;:&#39;libsph&#39;,
            &#39;type&#39;:&#39;bar&#39;,
            &#39;function&#39;:&#39;COUNT&#39;,
            &#39;maxPoints&#39;:&#39;20&#39;,
            &#39;displayValues&#39;:&#39;true&#39;,
            &#39;label&#39;:&#39;Nombre d\&#39;établissements&#39;,
            &#39;sort&#39;:&#39;serie1-1&#39;,
            &#39;expression&#39;:&#39;&#39;
            }
        ]
--&gt;

    &lt;!-- DO NOT MODIFY --&gt;
    &lt;!-- Technical fields, do not modify please --&gt;

    &lt;ods-dataset-context context=&#34;ctxref,ctxcompare,ctx1,ctx2,context0,context1,context2,context3,contextcompare0,contextcompare1,contextcompare2,contextcompare3&#34;
                         ctxref-dataset=&#34;{{datasetid}}&#34;
                         ctxref-domain=&#34;{{domain}}&#34;

                         ctxcompare-dataset=&#34;{{datasetid}}&#34;
                         ctxcompare-domain=&#34;{{domain}}&#34;

                         ctx1-dataset=&#34;{{datasetid}}&#34;
                         ctx1-domain=&#34;{{domain}}&#34;

                         ctx2-dataset=&#34;{{datasetid}}&#34;
                         ctx2-domain=&#34;{{domain}}&#34;

                         context0-dataset=&#34;{{datasetid}}&#34;
                         context0-domain=&#34;{{domain}}&#34;
                         context1-dataset=&#34;{{datasetid}}&#34;
                         context1-domain=&#34;{{domain}}&#34;
                         context2-dataset=&#34;{{datasetid}}&#34;
                         context2-domain=&#34;{{domain}}&#34;
                         context3-dataset=&#34;{{datasetid}}&#34;
                         context3-domain=&#34;{{domain}}&#34;

                         contextcompare0-dataset=&#34;{{datasetid}}&#34;
                         contextcompare0-domain=&#34;{{domain}}&#34;
                         contextcompare1-dataset=&#34;{{datasetid}}&#34;
                         contextcompare1-domain=&#34;{{domain}}&#34;
                         contextcompare2-dataset=&#34;{{datasetid}}&#34;
                         contextcompare2-domain=&#34;{{domain}}&#34;
                         contextcompare3-dataset=&#34;{{datasetid}}&#34;
                         contextcompare3-domain=&#34;{{domain}}&#34;
    &gt;

        &lt;span ng-if=&#34;refineField&#34;&gt;
            {{ctxref.parameters[&#39;refine.&#39; &#43; refineField] = refineValue; 
            ctxcompare.parameters[&#39;refine.&#39; &#43; refineField] = refineValue; 
            ctx1.parameters[&#39;refine.&#39; &#43; refineField] = refineValue; 
            ctx2.parameters[&#39;refine.&#39; &#43; refineField] = refineValue;  &#34;&#34;}}
        &lt;/span&gt;

        &lt;div ods-results=&#34;results1&#34; ods-results-context=&#34;ctx1&#34; ods-results-max=&#34;10&#34;&gt;
            &lt;div ods-results=&#34;results2&#34; ods-results-context=&#34;ctx2&#34; ods-results-max=&#34;10&#34;&gt;
                &lt;h1 class=&#34;page-title&#34;&gt;
                    {{ pageTitle }}
                &lt;/h1&gt;
                &lt;p class=&#34;page-subtitle&#34;&gt;
                    {{ pageSubtitle }}
                &lt;/p&gt;
                &lt;section class=&#34;filterbloc&#34;&gt;
    &lt;h2 class=&#34;filterbloc-title&#34;&gt;{{filterTitle}}&lt;/h2&gt;
    &lt;div class=&#34;filter-list&#34; ng-if=&#34;compareType == &#39;multiFields&#39;&#34;&gt;
        &lt;div class=&#34;filter-box select-left&#34;&gt;
            &lt;h4 class=&#34;filter-title&#34;&gt;
                {{referenceFitlerTitle}}
            &lt;/h4&gt;
            &lt;div class=&#34;ods-selects&#34;&gt;
                &lt;div ng-repeat=&#34;(i, fieldname) in fields&#34;&gt;
                    &lt;div ods-adv-analysis=&#34;list1&#34;
                         ods-adv-analysis-context=&#34;{{ &#39;context&#39; &#43; i }}&#34;
                         ods-adv-analysis-select=&#34;count(*)&#34;
                         ods-adv-analysis-group-by=&#34;{{fieldname.idField}},{{fieldname.labelField}}&#34;
                         ods-adv-analysis-order-by=&#34;{{fieldname.labelField}}&#34; ods-adv-analysis-limit=&#34;300&#34;&gt;
                        &lt;ods-select selected-values=&#34;selected1[fieldname.name]&#34;
                                    placeholder=&#34;{{ fieldname.placeholder }}&#34;
                                    label-modifier=&#34;{{fieldname.labelField}}&#34;
                                    value-modifier=&#34;{&#39;code&#39;:{{fieldname.idField}},&#39;name&#39;:{{fieldname.labelField}}}&#34;
                                    options=&#34;list1&#34;
                                    multiple=&#34;false&#34;
                                    is-loading=&#34;true&#34;&gt;&lt;/ods-select&gt;

                        &lt;span ng-repeat=&#34;(j, fake) in fields&#34;&gt;
                            &lt;span ng-if=&#34;i != j&#34;&gt;
                                {{
                                $parent.$parent.$parent.$parent[&#39;context&#39; &#43; j].parameters[&#39;refine.&#39; &#43; fieldname.idField] =
                                ctx1.parameters[&#39;refine.&#39; &#43;fieldname.idField] =
                                (selected1[fieldname.name] | toObject:&#39;code&#39; | keys);&#34;&#34;
                                }}
                            &lt;/span&gt;
                        &lt;/span&gt;
                    &lt;/div&gt;
                   
                &lt;/div&gt;
                &lt;div class=&#34;clear-filters&#34; ng-if=&#34;selected1[fields[3].name].length &gt; 0 || 
                    selected1[fields[2].name].length &gt; 0 ||
                    selected1[fields[1].name].length &gt; 0 ||
                    selected1[fields[0].name].length &gt; 0&#34;&gt;
                &lt;button class=&#34;clear-filters-button&#34;
                    ng-click=&#34;
                    selected1[fields[3].name].length = 0;
                    selected1[fields[2].name].length = 0;
                    selected1[fields[1].name].length = 0;
                    selected1[fields[0].name].length = 0;&#34;&gt;
                        {{resetFiltersButtonLabel}}
                    &lt;/button&gt;
                    &lt;i class=&#34;fa fa-times-circle&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;

                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;

        &lt;div class=&#34;filter-box select-right&#34;&gt;
            &lt;h4 class=&#34;filter-title&#34;&gt;
                {{compareFilterTitle}}
            &lt;/h4&gt;
            &lt;div class=&#34;ods-selects&#34;&gt;
                            &lt;div ng-repeat=&#34;(i, fieldname) in fields&#34;&gt;
                    &lt;div ods-adv-analysis=&#34;list2&#34;
                         ods-adv-analysis-context=&#34;{{ &#39;contextcompare&#39; &#43; i }}&#34;
                         ods-adv-analysis-select=&#34;count(*)&#34;
                         ods-adv-analysis-group-by=&#34;{{fieldname.idField}},{{fieldname.labelField}}&#34;
                         ods-adv-analysis-order-by=&#34;{{fieldname.labelField}}&#34; ods-adv-analysis-limit=&#34;300&#34;&gt;
                        &lt;ods-select selected-values=&#34;selected2[fieldname.name]&#34;
                                    placeholder=&#34;{{  fieldname.placeholder }}&#34;
                                    label-modifier=&#34;{{fieldname.labelField}}&#34;
                                    value-modifier=&#34;{&#39;code&#39;:{{fieldname.idField}},&#39;name&#39;:{{fieldname.labelField}}}&#34;
                                    options=&#34;list2&#34;
                                    multiple=&#34;false&#34;
                                    is-loading=&#34;true&#34;&gt;&lt;/ods-select&gt;

                        &lt;span ng-repeat=&#34;(j, fake) in fields&#34;&gt;
                            &lt;span ng-if=&#34;i != j&#34;&gt;
                                {{
                                $parent.$parent.$parent.$parent[&#39;contextcompare&#39; &#43; j].parameters[&#39;refine.&#39; &#43; fieldname.idField] =
                                ctx2.parameters[&#39;refine.&#39; &#43;fieldname.idField] =
                                (selected2[fieldname.name] | toObject:&#39;code&#39; | keys );&#34;&#34;
                                }}
                            &lt;/span&gt;
                        &lt;/span&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class=&#34;clear-filters&#34; ng-if=&#34;
                selected2[fields[3].name].length &gt; 0 ||
                selected2[fields[2].name].length &gt; 0 ||
                selected2[fields[1].name].length &gt; 0 ||
                selected2[fields[0].name].length &gt; 0&#34;&gt;
                &lt;button class=&#34;clear-filters-button&#34; 
                ng-click=&#34;
                selected2[fields[3].name].length = 0;
                selected2[fields[2].name].length = 0;
                selected2[fields[1].name].length = 0;
                selected2[fields[0].name].length = 0;&#34;&gt;
                {{resetFiltersButtonLabel}}
                &lt;/button&gt;
                &lt;i class=&#34;fa fa-times-circle&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;
            &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&#34;filter-list&#34; ng-if=&#34;compareType == &#39;singleField&#39;&#34;&gt;
        &lt;div class=&#34;filter-box&#34;&gt;
            &lt;h4 class=&#34;filter-title&#34;&gt;
                {{referenceFitlerTitle}}
            &lt;/h4&gt;
            &lt;div ods-adv-analysis=&#34;reflist&#34; ods-adv-analysis-context=&#34;ctxref&#34;
                 ods-adv-analysis-select=&#34;count(*) as y_axis&#34;
                 ods-adv-analysis-group-by=&#34;{{filterFieldId}} as x_axis_id, {{filterFieldLabel}} as x_axis_label&#34;
                 ods-adv-analysis-order-by=&#34;y_axis&#34;&gt;
                &lt;span ng-if=&#34;!defaultValue&#34;&gt;
                    &lt;ods-select options=&#34;reflist&#34; selected-values=&#34;selectionRefFinale&#34; label-modifier=&#34;x_axis_label&#34;
                                value-modifier=&#34;x_axis_id&#34; placeholder=&#34;{{filterPlaceholder}}&#34;&gt;
                    &lt;/ods-select&gt;
                    {{ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId] = selectionRefFinale ; &#34;&#34;}}
                &lt;/span&gt;
                &lt;span ng-if=&#34;defaultValue&#34;&gt;
                    &lt;ods-select options=&#34;reflist&#34; selected-values=&#34;selectionRefFinale&#34;
                                label-modifier=&#34;x_axis_label&#34; value-modifier=&#34;x_axis_id&#34;
                                placeholder=&#34;{{filterPlaceholder}}&#34;&gt;
                    &lt;/ods-select&gt;
                    {{selectionRefFinale == 0 ? selectionRefFinale = defaultValue : &#39;&#39; ; &#34;&#34;}}
                    {{ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId] = selectionRefFinale ; &#34;&#34;}}
                &lt;/span&gt;

            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class=&#34;filter-box&#34;&gt;
            &lt;h4 class=&#34;filter-title&#34;&gt;
                {{compareFilterTitle}}
            &lt;/h4&gt;
            &lt;div ods-adv-analysis=&#34;comparelist&#34; ods-adv-analysis-context=&#34;ctxcompare&#34;
                 ods-adv-analysis-select=&#34;count(*) as y_axis&#34;
                 ods-adv-analysis-group-by=&#34;{{filterFieldId}} as x_axis_id, {{filterFieldLabel}} as x_axis_label&#34;
                 ods-adv-analysis-order-by=&#34;y_axis&#34;&gt;
                &lt;span ng-if=&#34;!defaultValue&#34;&gt;
                    &lt;ods-select options=&#34;comparelist&#34; selected-values=&#34;selectionCompareFinale&#34;
                                label-modifier=&#34;x_axis_label&#34; value-modifier=&#34;x_axis_id&#34;
                                placeholder=&#34;{{filterPlaceholder}}&#34;&gt;
                    &lt;/ods-select&gt;
                    {{ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId] = selectionCompareFinale ; &#34;&#34;}}
                &lt;/span&gt;
                &lt;span ng-if=&#34;defaultValue&#34;&gt;
                    &lt;ods-select options=&#34;comparelist&#34; selected-values=&#34;selectionCompareFinale&#34;
                                label-modifier=&#34;x_axis_label&#34; value-modifier=&#34;x_axis_id&#34;
                                placeholder=&#34;{{filterPlaceholder}}&#34;&gt;
                    &lt;/ods-select&gt;
                    {{selectionCompareFinale == 0 ? selectionCompareFinale = defaultValue : &#39;&#39; ; &#34;&#34;}}
                    {{ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId] = selectionCompareFinale ; &#34;&#34;}}
                    {{ctx2.parameters}}
                &lt;/span&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;!-- {{ctx1.parameters}} // {{ctx2.parameters}}  --&gt;                &lt;div ods-facet-results=&#34;items1&#34; ods-facet-results-context=&#34;ctx1&#34;
                     ods-facet-results-facet-name=&#34;{{filterFieldLabel}}&#34;&gt;
                    &lt;div ods-facet-results=&#34;items2&#34; ods-facet-results-context=&#34;ctx2&#34;
                         ods-facet-results-facet-name=&#34;{{filterFieldLabel}}&#34;&gt;
                        &lt;section class=&#34;box-container&#34; ng-repeat=&#34;kpi in kpis&#34;&gt;
  &lt;div class=&#34;row row-equal-height&#34; ods-adv-analysis=&#34;kpi1&#34; ods-adv-analysis-context=&#34;ctx1&#34; ods-adv-analysis-select=&#34;{{ kpi.select }} as x&#34;&gt;
    &lt;div class=&#34;col-md-4&#34;&gt;
      &lt;!-- KPI box component --&gt;
      &lt;div class=&#34;kpi-card&#34;&gt;
        &lt;i ng-if=&#34;kpi.faicon&#34; class=&#34;kpi-icon fa fa-{{ kpi.faicon }}&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;
        &lt;p class=&#34;kpi-title left&#34;&gt;
          {{ (kpi1[0].x || 0) | number : (kpi.precision || 0) }}         
           &lt;span ng-if=&#34;kpi.unit&#34; class=&#34;kpi-unit left&#34;&gt;{{ kpi.unit }}&lt;/span&gt;
        &lt;/p&gt;
        &lt;p class=&#34;kpi-description&#34;&gt;
          {{ kpi.title }}
        &lt;/p&gt;
        &lt;p class=&#34;kpi-subtitle&#34;
          ng-if=&#34;compareType == &#39;multiFields&#39;&#34;&gt;
          {{ selected1[fields[3].name][0].name ||
            selected1[fields[2].name][0].name ||
            selected1[fields[1].name][0].name ||
            selected1[fields[0].name][0].name || defaultLevel }}&lt;/p&gt;
        
        &lt;p class=&#34;kpi-subtitle&#34; ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length &gt;0&#34;&gt;
          {{results1[0].fields[filterFieldLabel]}}&lt;/p&gt;
          &lt;p class=&#34;kpi-subtitle&#34; ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 &amp;&amp; compareType==&#39;singleField&#39;&#34;&gt;
            {{defaultLevel}}&lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&#34;col-md-4&#34;  ods-adv-analysis=&#34;kpi2&#34; ods-adv-analysis-context=&#34;ctx2&#34; ods-adv-analysis-select=&#34;{{ kpi.select }} as x&#34;&gt;
      &lt;!-- KPI box component --&gt;
      &lt;div class=&#34;kpi-card&#34;&gt;
        &lt;i ng-if=&#34;kpi.faicon&#34; class=&#34;kpi-icon fa fa-{{ kpi.faicon }}&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;
        &lt;p class=&#34;kpi-title right&#34;&gt;
          {{ (kpi2[0].x || 0) | number : (kpi.precision || 0) }}         
          &lt;span ng-if=&#34;kpi.unit&#34; class=&#34;kpi-unit right&#34;&gt;{{ kpi.unit }}&lt;/span&gt;
        &lt;/p&gt;
        &lt;p class=&#34;kpi-description&#34;&gt;
          {{ kpi.title }}
        &lt;/p&gt;
        &lt;p class=&#34;kpi-subtitle&#34;
          ng-if=&#34;compareType == &#39;multiFields&#39;&#34;&gt;
          {{ selected2[fields[3].name][0].name ||
            selected2[fields[2].name][0].name ||
            selected2[fields[1].name][0].name ||
            selected2[fields[0].name][0].name || defaultLevel }}&lt;/p&gt;
        &lt;p class=&#34;kpi-subtitle&#34; ng-if=&#34;ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId].length &gt;0&#34;&gt;
          {{results2[0].fields[filterFieldLabel]}}&lt;/p&gt;
          &lt;p class=&#34;kpi-subtitle&#34; ng-if=&#34;ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 &amp;&amp; compareType==&#39;singleField&#39;&#34;&gt;
            {{defaultLevel}}&lt;/p&gt;

        &lt;p class=&#34;kpi-compare right&#34;&gt;
          {{ ((kpi2[0].x - kpi1[0].x )/kpi1[0].x )*100 &gt; 0 ? &#39;&#43;&#39; : &#39;&#39; }}{{ (((kpi2[0].x -kpi1[0].x )/kpi1[0].x )*100|| 0) | number : 2 }}%
        &lt;/p&gt;
        &lt;span style=&#34;font-style: italic;&#34;&gt;par rapport à &lt;/span&gt;
        &lt;p class=&#34;kpi-compare-subtitle&#34; ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; levelRefSelectedId].length &gt;0&#34;&gt;&lt;span
            ng-repeat=&#34;item1 in items1&#34;&gt; {{item1.name}}{{$last ? &#39;&#39; : &#39; &#43; &#39;}} &lt;/span&gt;&lt;/p&gt;
        &lt;p class=&#34;kpi-compare-subtitle&#34;
          ng-if=&#34;compareType == &#39;multiFields&#39;&#34;&gt;
          {{ selected1[fields[3].name][0].name ||
            selected1[fields[2].name][0].name ||
            selected1[fields[1].name][0].name ||
            selected1[fields[0].name][0].name || defaultLevel }}&lt;/p&gt;
        &lt;p class=&#34;kpi-compare-subtitle&#34; ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length &gt;0&#34;&gt;
          {{results1[0].fields[filterFieldLabel]}}&lt;/p&gt;
          &lt;p class=&#34;kpi-compare-subtitle&#34; ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 &amp;&amp; compareType==&#39;singleField&#39;&#34;&gt;
            {{defaultLevel}}&lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/section&gt;                        &lt;div style=&#34;text-align: right; width: 100%&#34;&gt;
                            &lt;a href=&#34;https://{{ domainid }}/explore/dataset/{{ datasetid }}/&#34;
                               target=&#34;_blank&#34;&gt;Accéder
                                aux données sources&lt;/a&gt;
                        &lt;/div&gt;
                        &lt;span ng-repeat=&#34;chart in charts&#34;&gt;
                                    &lt;span ng-if=&#34;chart.disposition==&#39;pyramid&#39;&#34;&gt;
                                        &lt;section class=&#34;page-section&#34; ng-init=&#34;pyramid = {&#39;analysisref&#39;:undefined,
                            &#39;analysiscompare&#39;:undefined,
                            &#39;orderref&#39;:{},
                            &#39;ordercompare&#39;:{},
                            &#39;defaultorder&#39;:&#39;orderref&#39;}&#34;&gt;

    &lt;div class=&#34;box-container&#34;&gt;
        &lt;div class=&#34;chart-card&#34;&gt;
            &lt;h2&gt;{{chart.title}}&lt;/h2&gt;
            &lt;span ods-adv-analysis=&#34;analysisref&#34; ods-adv-analysis-context=&#34;ctx1&#34;
                ods-adv-analysis-group-by=&#34;{{chart.xAxis}}&#34; ods-adv-analysis-select=&#34;{{chart.select}} as counttotal&#34;
                ods-adv-analysis-order-by=&#34;{{chart.select}} DESC&#34;&gt;
                &lt;div ods-subaggregation=&#34;analysisref&#34; ods-subaggregation-serie-max=&#34;MAX(counttotal)&#34;&gt;

                    {{ pyramid[&#39;maxref&#39;] = results[0].max; &#39;&#39; }}
                &lt;/div&gt;

                {{ pyramid.analysisref = analysisref ; &#39;&#39; }}
            &lt;/span&gt;
            &lt;span ods-adv-analysis=&#34;analysiscompare&#34; ods-adv-analysis-context=&#34;ctx2&#34;
                ods-adv-analysis-group-by=&#34;{{chart.xAxis}}&#34; ods-adv-analysis-select=&#34;{{chart.select}} as counttotal&#34;
                ods-adv-analysis-order-by=&#34;{{chart.select}} DESC&#34;&gt;
                &lt;div ods-subaggregation=&#34;analysiscompare&#34; ods-subaggregation-serie-max=&#34;MAX(counttotal)&#34;&gt;
                    {{ pyramid[&#39;maxcompare&#39;] = results[0].max; &#39;&#39; }}
                &lt;/div&gt;

                {{ pyramid.analysiscompare = analysiscompare ; &#39;&#39; }}
            &lt;/span&gt;
            &lt;span ng-if=&#34;pyramid[&#39;maxref&#39;] &amp;&amp; pyramid[&#39;maxcompare&#39;]&#34;&gt;
                {{ pyramid[&#39;max&#39;] =
                (pyramid[&#39;maxcompare&#39;]&gt;pyramid[&#39;maxref&#39;]?pyramid[&#39;maxcompare&#39;]:pyramid[&#39;maxref&#39;]); &#39;&#39; }}
            &lt;/span&gt;

            &lt;p ng-if=&#34;pyramid.defaultorder == &#39;orderref&#39;&#34; ng-repeat=&#34;(i,item) in pyramid.analysisref&#34;&gt;
                {{ pyramid.order[item[chart.xAxis]] = i&#43;1; &#39;&#39; }}
            &lt;/p&gt;
            &lt;p ng-if=&#34;pyramid.defaultorder == &#39;ordercompare&#39;&#34; ng-repeat=&#34;(i,item) in pyramid.analysiscompare&#34;&gt;
                {{ pyramid.order[item[chart.xAxis]] = i&#43;1; &#39;&#39; }}
            &lt;/p&gt;

            &lt;!--Custom Left/Right Graph here
    ========================================================================== --&gt;

            &lt;div class=&#34;custom-graph&#34;&gt;
                &lt;div class=&#34;custom-graph-body&#34;&gt;
                    &lt;div class=&#34;custom-graph-block&#34;&gt;
                        &lt;div class=&#34;custom-graph-header header-left left&#34;&gt;
                            &lt;h3 class=&#34;custom-graph-title&#34;&gt;
                                &lt;span ng-if=&#34;compareType==&#39;multiFields&#39;&#34;&gt; {{ selected1[fields[3].name][0].name ||
                                    selected1[fields[2].name][0].name ||
                                    selected1[fields[1].name][0].name ||
                                    selected1[fields[0].name][0].name || defaultLevel }}
                                &lt;/span&gt;
                                &lt;span ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length &gt;0&#34;&gt;
                                    {{results1[0].fields[filterFieldLabel]}}&lt;/span&gt;
                                &lt;span
                                    ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 &amp;&amp; compareType==&#39;singleField&#39;&#34;&gt;
                                    {{defaultLevel}}&lt;/span&gt;
                            &lt;/h3&gt;
                            &lt;h4&gt;{{chart.label}}&lt;/h4&gt;
                        &lt;/div&gt;
                        &lt;div class=&#34;custom-graph-content-left&#34;&gt;
                            &lt;div class=&#34;custom-graph-item&#34; ng-repeat=&#34;itemleft in pyramid.analysisref&#34;
                                ng-if=&#34;pyramid.order[itemleft[chart.xAxis]]&lt;=10&#34; style=&#34;grid-row: {{ pyramid.order[itemleft[chart.xAxis]] }} ;
                                    grid-column:1&#34;&gt;
                                &lt;h5 class=&#34;custom-graph-item-title&#34;&gt;
                                    {{ itemleft[chart.xAxis] }}
                                &lt;/h5&gt;
                                &lt;div class=&#34;custom-graph-progress-container&#34;&gt;
                                    &lt;div class=&#34;custom-graph-progress background-left&#34;
                                        style=&#34;width: {{ 100 * itemleft.counttotal / pyramid.max }}%&#34;&gt;
                                        &lt;span class=&#34;custom-graph-progress-value&#34;&gt;
                                            {{ itemleft.counttotal | number }}
                                        &lt;/span&gt;
                                    &lt;/div&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;

                    &lt;div class=&#34;custom-graph-separator&#34;&gt;&lt;/div&gt;
                    &lt;div class=&#34;custom-graph-block&#34;&gt;
                        &lt;div class=&#34;custom-graph-header header-right right&#34;&gt;
                            &lt;h3 class=&#34;custom-graph-title&#34;&gt;
                                &lt;span ng-if=&#34;compareType==&#39;multiFields&#39;&#34;&gt; {{ selected2[fields[3].name][0].name ||
                                    selected2[fields[2].name][0].name ||
                                    selected2[fields[1].name][0].name ||
                                    selected2[fields[0].name][0].name || defaultLevel }}&lt;/span&gt;
                                &lt;span ng-if=&#34;ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId].length &gt;0&#34;&gt;
                                    {{results2[0].fields[filterFieldLabel]}}&lt;/span&gt;
                                &lt;span
                                    ng-if=&#34;ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 &amp;&amp; compareType==&#39;singleField&#39;&#34;&gt;
                                    {{defaultLevel}}&lt;/span&gt;
                            &lt;/h3&gt;
                            &lt;h4&gt;{{chart.label}}&lt;/h4&gt;
                        &lt;/div&gt;
                        &lt;div class=&#34;custom-graph-content-right&#34;&gt;
                            &lt;div class=&#34;custom-graph-item&#34; ng-repeat=&#34;itemright in pyramid.analysiscompare&#34;
                                ng-if=&#34;pyramid.order[itemright[chart.xAxis]]&lt;=10&#34; style=&#34;grid-row: {{ pyramid.order[itemright[chart.xAxis]] }} ;
                                    grid-column:1&#34;&gt;
                                &lt;h5 class=&#34;custom-graph-item-title&#34;&gt;
                                    {{ itemright[chart.xAxis] }}
                                &lt;/h5&gt;
                                &lt;div class=&#34;custom-graph-progress-container&#34;&gt;
                                    &lt;div class=&#34;custom-graph-progress background-right&#34;
                                        style=&#34;width: {{ 100 * itemright.counttotal / pyramid.max }}%&#34;&gt;
                                        &lt;span class=&#34;custom-graph-progress-value&#34;&gt;
                                            {{ itemright.counttotal | number }}
                                        &lt;/span&gt;
                                    &lt;/div&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;                                    &lt;/span&gt;
                                    &lt;span ng-if=&#34;chart.disposition==&#39;classic&#39;&#34;&gt;
                                        &lt;div class=&#34;box-container&#34;&gt;
    &lt;div class=&#34;chart-card&#34;&gt;
        &lt;h2&gt;{{chart.title}}&lt;/h2&gt;
        &lt;ods-chart ng-if=&#34;compareType==&#39;multiFields&#39;&#34; align-month=&#34;true&#34; single-y-axis=&#34;true&#34; labels-x-length=&#34;25&#34;&gt;
            &lt;ods-chart-query context=&#34;ctx1&#34; field-x=&#34;{{chart.xAxis}}&#34; maxpoints=&#34;{{chart.maxPoints}}&#34;
                sort=&#34;{{chart.sort}}&#34;&gt;
                &lt;ods-chart-serie label-y=&#34;{{ chart.label &#43; &#39; - &#39; &#43; (selected1[fields[3].name][0].name ||
                selected1[fields[2].name][0].name ||
                selected1[fields[1].name][0].name ||
                selected1[fields[0].name][0].name ||defaultLevel ) }}&#34; expression-y=&#34;{{chart.xAxis}}&#34; chart-type=&#34;{{chart.type}}&#34;
                    function-y=&#34;{{chart.function}}&#34; color=&#34;#08A8AB&#34; scientific-display=&#34;true&#34;
                    display-values=&#34;{{chart.displayValues}}&#34; logarithmic=&#34;true&#34;&gt;
                &lt;/ods-chart-serie&gt;
            &lt;/ods-chart-query&gt;
            &lt;ods-chart-query context=&#34;ctx2&#34; field-x=&#34;{{chart.xAxis}}&#34; maxpoints=&#34;{{chart.maxPoints}}&#34; sort=&#34;{{chart.sort}}&#34;&gt;
                &lt;ods-chart-serie label-y=&#34;{{ chart.label &#43; &#39; - &#39; &#43; (selected2[fields[3].name][0].name ||
                selected2[fields[2].name][0].name ||
                selected2[fields[1].name][0].name ||
                selected2[fields[0].name][0].name || defaultLevel) }}&#34; expression-y=&#34;{{chart.xAxis}}&#34; chart-type=&#34;{{chart.type}}&#34;
                    function-y=&#34;{{chart.function}}&#34; color=&#34;#D5AC00&#34; scientific-display=&#34;true&#34;
                    display-values=&#34;{{chart.displayValues}}&#34; logarithmic=&#34;true&#34;&gt;
                &lt;/ods-chart-serie&gt;
            &lt;/ods-chart-query&gt;
        &lt;/ods-chart&gt;
        &lt;ods-chart ng-if=&#34;compareType==&#39;singleField&#39;&#34; align-month=&#34;true&#34; single-y-axis=&#34;true&#34; labels-x-length=&#34;25&#34;&gt;
            &lt;ods-chart-query context=&#34;ctx1&#34; field-x=&#34;{{chart.xAxis}}&#34; maxpoints=&#34;{{chart.maxPoints}}&#34;
                sort=&#34;{{chart.sort}}&#34;&gt;
                &lt;ods-chart-serie label-y=&#34;{{ chart.label &#43; &#39; - &#39; &#43; ((items1 | toObject : &#39;name&#39; | keys).length == 1 ? (items1 | toObject : &#39;name&#39; | keys) : defaultLevel) }}&#34; expression-y=&#34;{{chart.xAxis}}&#34; chart-type=&#34;{{chart.type}}&#34;
                    function-y=&#34;{{chart.function}}&#34; color=&#34;#08A8AB&#34; scientific-display=&#34;true&#34;
                    display-values=&#34;{{chart.displayValues}}&#34; logarithmic=&#34;true&#34;&gt;
                &lt;/ods-chart-serie&gt;
            &lt;/ods-chart-query&gt;
            &lt;ods-chart-query context=&#34;ctx2&#34; field-x=&#34;{{chart.xAxis}}&#34; maxpoints=&#34;{{chart.maxPoints}}&#34; sort=&#34;{{chart.sort}}&#34;&gt;
                &lt;ods-chart-serie label-y=&#34;{{ chart.label &#43; &#39; - &#39; &#43; ((items2 | toObject : &#39;name&#39; | keys).length == 1 ? (items2 | toObject : &#39;name&#39; | keys) : defaultLevel) }}&#34; expression-y=&#34;{{chart.xAxis}}&#34; chart-type=&#34;{{chart.type}}&#34;
                    function-y=&#34;{{chart.function}}&#34; color=&#34;#D5AC00&#34; scientific-display=&#34;true&#34;
                    display-values=&#34;{{chart.displayValues}}&#34; logarithmic=&#34;true&#34;&gt;
                &lt;/ods-chart-serie&gt;
            &lt;/ods-chart-query&gt;
        &lt;/ods-chart&gt;
    &lt;/div&gt;
&lt;/div&gt;                                    &lt;/span&gt;
                                &lt;/span&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/ods-dataset-context&gt;
&lt;/div&gt;&lt;/ods-dataset-context&gt;
&lt;/div&gt;</div>
                <style type='text/css'>
                    /* General Layout
========================================================================== */
:root {
  --left-color: #08a8ab;
  --right-color: #d5ac00;
  --secondary-color: black;
}

.left {
  color: var(--left-color);
}

.right {
  color: var(--right-color);
}

.background-left {
  background-color: var(--left-color);
}

.background-right {
  background-color: var(--right-color);
}

@media screen and (min-width: 992px) {
  .row-equal-height {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -ms-flex-wrap: wrap;
    flex-wrap: wrap;
    margin-bottom: 20px;
    width: 100%;
    justify-content: space-around;
  }

  /* Fix for early content wrapping in Safari*/
  .row-equal-height:before,
.row-equal-height:after {
    content: normal;
  }
}


.page-title {
  font-size: 3rem;
  font-weight: bold;
  margin-top: 0;
  margin-bottom: 1rem;
}

.page-subtitle {
  font-size: 1.2rem;
  line-height: 2;
  margin-top: 0;
  margin-bottom: 3rem;
}

.box-container {
  padding: 10px 0px;
}

@media screen and (min-width: 992px) {
  .box-container {
    display: flex;
    justify-content: center;
  }
}

/* Filters
========================================================================== */
.ods-selects {
  display: flex;
  flex-direction: column;
  gap: 5px;
}

.filterbloc {
  background-color: var(--boxes-background);
  height: 100%;
  padding: 20px 0px;
  border-radius: 4px;
  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.13);
  margin: 10px 0px;
  width: 100%;
}

.filterbloc-title {
  text-align: center;
}

.filter-list {
  display: flex;
  flex-wrap: wrap;
  position: relative;
  margin-bottom: 20px;
  justify-content: space-around;
}

.filter-list &gt; * {
  margin: 0 0 10px;
  width: 100%;
}

.filter-box {
  display: flex;
  flex-direction: column;
  gap: 10px;
  align-items: center;
}

.filter-title {
  margin-top: 15px;
  margin-bottom: 0px;
}

.odswidget-select .odswidget-select-dropdown.open .odswidget-select-dropdown-menu {
  width: 100%;
}

.odswidget-select,
.odswidget-select .odswidget-select-dropdown {
  width: 100%;
}

@media screen and (min-width: 500px) {
  .filter-list &gt; * {
    margin: 0 10px 10px 0;
    width: inherit;
  }

  .odswidget-select .odswidget-select-dropdown.open .odswidget-select-dropdown-menu, .odswidget-select-input, .odswidget-select-dropdown {
    width: max-content;
    min-width: 266px;
  }
}
.select-left .odswidget-select-dropdown-item-close-icon, .select-left .odswidget-select-dropdown-item-icon.fa-check-square,
.select-left .odswidget-select-dropdown-item-icon.fa-minus-square,
.select-left .odswidget-select-dropdown-menu-item:hover i.fa-square-o {
  color: var(--left-color);
}

.select-right .odswidget-select-dropdown-item-close-icon, .select-right .odswidget-select-dropdown-item-icon.fa-check-square,
.select-right .odswidget-select-dropdown-item-icon.fa-minus-square,
.select-right .odswidget-select-dropdown-menu-item:hover i.fa-square-o {
  color: var(--right-color);
}

.clear-filters {
  display: flex;
  align-items: center;
  justify-content: center;
  margin-top: 5px;
}

.clear-filters-button {
  background: none;
  border: none;
  color: var(--text);
}

.clear-filters-button:hover {
  opacity: 0.65;
}

/* KPI Card
========================================================================== */
.kpi-card {
  background-color: var(--boxes-background);
  height: 100%;
  padding: 39px;
  border-radius: 4px;
  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.13);
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
  -ms-flex-direction: column;
  flex-direction: column;
  -webkit-box-align: center;
  -ms-flex-align: center;
  align-items: center;
  text-align: center;
  -webkit-box-pack: center;
  -ms-flex-pack: center;
  justify-content: center;
  text-align: center;
  width: 100%;
  margin-bottom: 5px;
}

.kpi-icon {
  color: var(--secondary-color);
  font-size: 4rem;
  margin-top: 0;
  margin-bottom: 13px;
  max-width: 100%;
}

.kpi-title {
  font-weight: normal;
  font-size: 3.2rem;
  margin-top: 0;
  max-width: 100%;
  margin-bottom: 5px;
}

.kpi-compare {
  font-weight: normal;
  font-size: 1.8rem;
  margin-top: 0;
  margin-bottom: 0px;
  max-width: 100%;
}

.kpi-unit {
  font-size: 0.8em;
}

.kpi-description {
  color: var(--text);
  font-size: 1rem;
  line-height: 1.5;
  font-weight: normal;
  margin-top: 0;
  margin-bottom: 0;
  max-width: 100%;
}

.kpi-subtitle {
  font-weight: bold;
  text-transform: uppercase;
  margin-bottom: 0;
}

.kpi-compare-subtitle {
  text-transform: uppercase;
  margin-bottom: 0;
}

/* Charts
========================================================================== */
.chart-card {
  background-color: var(--boxes-background);
  height: 100%;
  padding: 39px;
  border-radius: 4px;
  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.13);
  display: block;
  width: 100%;
  margin-bottom: 10px;
}

.chart-title:first-child {
  margin-top: 20px;
}

rect.highcharts-background {
  fill: transparent !important;
}

/* Custom Charts
========================================================================== */
.custom-graph {
  display: flex;
  flex-direction: column;
  margin-bottom: 4rem;
  width: 100%;
}

.custom-graph-body {
  display: flex;
  align-items: stretch;
}

.custom-graph-block {
  flex: 1 1 auto;
}

.custom-graph-separator {
  width: 3px;
  background-color: #232423;
}

.custom-graph-header {
  display: block;
  margin-bottom: 0.5rem;
}
.custom-graph-header h4 {
  margin-top: 0;
}

.header-right {
  text-align: right;
}

.custom-graph-title {
  font-size: 1.43rem;
  margin: 0;
  text-transform: uppercase;
  color: var(--titles);
  font-weight: bold;
}

.custom-graph-content {
  display: grid;
}

.custom-graph-item {
  border-bottom: 1px solid #979797;
  margin-top: 0.5rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  min-height: 50px;
}

.custom-graph-item-title {
  font-size: 0.75rem;
  color: var(--titles);
  font-weight: normal;
  margin: 0;
  flex: 0 0 35%;
}

.custom-graph-progress-container {
  align-self: end;
  flex: 1 1 65%;
}

.custom-graph-progress {
  height: 30px;
  display: flex;
  align-items: center;
}

.custom-graph-progress-value {
  font-size: 0.625rem;
  color: var(--titles);
  margin: 0 9px;
}

.custom-graph-content-left .custom-graph-progress {
  margin-left: auto;
  border-radius: 8px 0 0 8px;
  justify-content: flex-end;
}

.custom-graph-content-right .custom-graph-item-title {
  order: 1;
  text-align: right;
}

.custom-graph-content-right .custom-graph-progress {
  order: 1;
  margin-right: auto;
  border-radius: 0 8px 8px 0;
  justify-content: flex-start;
}

.custom-graph-inverted-text-color .custom-graph-progress-value,
.custom-graph-inverted-text-color .custom-graph-item-title {
  color: inherit;
}
                </style>
                </body>
              ">
      </iframe>
      <div class="buttons has-addons">
          
          <button id="tab-show-schema" aria-controls="panel-show-schema"
                  class="show-schema button is-light"
                  title="Show the data schema of the dataset used in this resource">
              <span>See fields in use</span>
          </button>
          
          <button id="tab-show-code" aria-controls="panel-show-code"
                  class="show-code button is-light">
              <span>Show code</span>
          </button>
          <button class="button is-light"
             target="_blank"
             aria-role="link"
             rel="noopener"
             title="Edit on CodePen, open a new tab"
             onclick="document.getElementById('form-automated-comparison-dashboard').submit()">
              <span>Edit on Codepen</span>
              <span class="icon is-small">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                  <use xlink:href="#external"></use>
                </svg>
              </span>
          </button>
      </div>
    </div>
    
    <div id="panel-show-schema" aria-labelledby="tab-show-schema" aria-hidden
         class="box-schema is-hidden">
        <div class="content">
            <p><strong>Dataset in use:</strong> <code>healthref-france-finess</code> <a href="https://userclub.opendatasoft.com/explore/dataset/healthref-france-finess/table/">(See it on userclub domain)</a></p>
<p><strong>Fields in use:</strong></p>
<table>
<thead>
<tr>
<th>code_officiel_region</th>
<th>nom_officiel_region</th>
<th>departement</th>
<th>libelle_departement</th>
<th>code_officiel_epci</th>
<th>nom_officiel_epci</th>
<th>nom_officiel_commune</th>
<th>code_commune</th>
<th>libelle_mft</th>
<th>libelle_categorie_d_etablissement</th>
<th>libelle_sph</th>
<th>date_d_ouverture</th>
</tr>
</thead>
<tbody>
<tr>
<td>44</td>
<td>Grand Est</td>
<td>68</td>
<td>HAUT RHIN</td>
<td>200066009</td>
<td>CA Mulhouse Alsace Agglomération</td>
<td>Mulhouse</td>
<td>68224</td>
<td>Indéterminé</td>
<td>Autre Résidence Sociale (hors Maison Relais, Pension de Fami</td>
<td></td>
<td>1904-04-04</td>
</tr>
<tr>
<td>44</td>
<td>Grand Est</td>
<td>68</td>
<td>HAUT RHIN</td>
<td>200066009</td>
<td>CA Mulhouse Alsace Agglomération</td>
<td>Mulhouse</td>
<td>68224</td>
<td>ARS/PCD, Tarif global, habilité aide sociale, recours PUI</td>
<td>Etablissement d&rsquo;hébergement pour personnes âgées dépendantes</td>
<td></td>
<td>1972-10-01</td>
</tr>
<tr>
<td>44</td>
<td>Grand Est</td>
<td>68</td>
<td>HAUT RHIN</td>
<td>200066009</td>
<td>CA Mulhouse Alsace Agglomération</td>
<td>Mulhouse</td>
<td>68224</td>
<td>Etablissement Tarif Libre</td>
<td>Pharmacie d&rsquo;Officine</td>
<td></td>
<td>2021-10-25</td>
</tr>
<tr>
<td>44</td>
<td>Grand Est</td>
<td>68</td>
<td>HAUT RHIN</td>
<td>246800726</td>
<td>CA Colmar Agglomération</td>
<td>Colmar</td>
<td>68066</td>
<td>ARS / DG dotation globale</td>
<td>Centre soins accompagnement prévention addictologie (CSAPA)</td>
<td></td>
<td>1989-12-01</td>
</tr>
</tbody>
</table>

        </div>
    </div>
    
    <div id="panel-show-code" aria-labelledby="tab-show-code" aria-hidden
         class="box-code js-tabs is-hidden">
        <nav class="level is-mobile">
            <div class="level-left">
                <div class="level-item">
                    <div class="buttons has-addons js-tablist">
                        <a
                          class="button is-primary is-outlined js-tablist__item js-tablist__link"
                          href="#code-automated-comparison-dashboard-html-content"
                        >
                          HTML
                        </a>
                        
                        <a
                          class="button is-primary is-outlined js-tablist__item js-tablist__link"
                          href="#code-automated-comparison-dashboard-css-content"
                        >
                          CSS
                        </a>
                        
                    </div>
                </div>
            </div>
            <div class="level-right">
                <button class="copy-to-cc button is-primary is-outlined is-rounded has-tooltip-left"
                  data-tooltip="Copy to clipboard"
                  aria-role="button"
                  title="Edit on CodePen, open a new tab"
                >
                  <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                      <use xlink:href="#copy"></use>
                    </svg>
                  </span>
                </button>
                <button class="copied-to-cc button is-success is-outlined is-rounded has-tooltip-left is-hidden"
                  data-tooltip="Copied"
                  aria-role="button"
                  title="Copied"
                >
                  <figure class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                      <use xlink:href="#check"></use>
                    </svg>
                  </figure>
                </button>
            </div>
        </nav>
        <div class="tab-content">
            <div class="js-tabcontent"
                 id="code-automated-comparison-dashboard-html-content"
                 data-clipboard="&lt;!-- IMPORTANT ******** MUST READ !

    In the following settings declaration :

    A common error is forget to escape (protect) apostrophe with a leading backslash
    As apostrophes are used to declare values of variable it will break the settings

    Ex:
    wrongVariable = &#39;I&#39;ll be freed from apostrophes&#39;
    correctVariable = &#39;I\&#39;ll be freed from apostrophes&#39;
--&gt;

&lt;!-- SETTINGS START HERE --&gt;
&lt;div class=&#34;container&#34;ng-init=&#34;domain = &#39;userclub.opendatasoft.com&#39;;
                datasetid = &#39;healthref-france-finess&#39;;
                
                refineField = &#39;&#39;;
                refineValue = &#39;&#39;;

                pageTitle = &#39;Analyse : Etablissements du domaine sanitaire et social en France&#39;;
                pageSubtitle = &#39;Cette page permet de comparer la répartition des établissements du domaine sanitaire et social en France. Sélectionnez les territoires à comparer et parcourez les différents indicateurs et graphiques pour dresser votre analyse.&#39;;

                compareType = &#39;multiFields&#39;;
                
                filterTitle = &#39;Sélectionnez les catégories à comparer&#39;;
                referenceFitlerTitle = &#39;Catégorie de référence&#39;;
                compareFilterTitle = &#39;Catégorie à comparer&#39;;

                defaultLevel = &#39;France entière&#39;;

                IF_COMPARE_BY_MULTIFIELDS;

                fields = [
                {name:&#39;Région&#39;,idField:&#39;code_officiel_region&#39;,labelField:&#39;nom_officiel_region&#39;, placeholder:&#39;Toutes régions&#39;},
                {name:&#39;Département&#39;, idField:&#39;departement&#39;,labelField:&#39;libelle_departement&#39;, placeholder:&#39;Tous départements&#39;},
                {name:&#39;EPCI&#39;, idField:&#39;code_officiel_epci&#39;,labelField:&#39;nom_officiel_epci&#39;, placeholder:&#39;Tous EPCIs&#39;},
                {name:&#39;Commune&#39;, idField:&#39;code_commune&#39;,labelField:&#39;nom_officiel_commune&#39;, placeholder:&#39;Toutes communes&#39;}
                ];

                resetFiltersButtonLabel = &#39;Supprimer tous les filtres&#39;;

                IF_COMPARE_BY_SINGLEFIELD;

                filterFieldId = &#39;alert_country&#39;;
                filterFieldLabel = &#39;alert_country&#39;;

                defaultValue = &#39;&#39;;

                filterPlaceholder = &#39;Sélectionnez une valeur&#39;;

                kpis = [ 
                {
                &#39;title&#39;: &#39;Nombre d\&#39;établissements&#39;,
                &#39;select&#39;: &#39;count(*)&#39;,
                &#39;precision&#39;: 0,
                &#39;unit&#39;: &#39;&#39;,
                &#39;faicon&#39;: &#39;square-o&#39;
                }
                ];

                charts = [
                { 
                &#39;disposition&#39;:&#39;pyramid&#39;,
                &#39;title&#39;:&#39;Répartition par mode de fixation des tarifs&#39;,
                &#39;xAxis&#39;:&#39;libelle_mft&#39;,
                &#39;label&#39;:&#39;Nombre d\&#39;établissements&#39;,
                &#39;select&#39;:&#39;count(*)&#39;
                },
                { 
                &#39;disposition&#39;:&#39;pyramid&#39;,
                &#39;title&#39;:&#39;Répartition par catégorie d\’établissement&#39;,
                &#39;xAxis&#39;:&#39;libelle_categorie_d_etablissement&#39;,
                &#39;label&#39;:&#39;Nombre d\&#39;établissements&#39;,
                &#39;select&#39;:&#39;count(*)&#39;
                },
                { 
                &#39;disposition&#39;:&#39;classic&#39;,
                &#39;title&#39;:&#39;Participation au service public hospitalier&#39;,
                &#39;xAxis&#39;:&#39;libelle_sph&#39;,
                &#39;type&#39;:&#39;line&#39;,
                &#39;function&#39;:&#39;COUNT&#39;,
                &#39;maxPoints&#39;:&#39;20&#39;,
                &#39;displayValues&#39;:&#39;true&#39;,
                &#39;label&#39;:&#39;Nombre d\&#39;établissements&#39;,
                &#39;sort&#39;:&#39;serie1-1&#39;,
                &#39;expression&#39;:&#39;&#39;
                },
                { 
                &#39;disposition&#39;:&#39;classic&#39;,
                &#39;title&#39;:&#39;Date d\&#39;ouverture&#39;,
                &#39;xAxis&#39;:&#39;date_d_ouverture&#39;,
                &#39;label&#39;:&#39;Nombre d\&#39;établissements&#39;,
                &#39;type&#39;:&#39;line&#39;,
                &#39;function&#39;:&#39;COUNT&#39;,
                &#39;expression&#39;:&#39;&#39;,
                &#39;sort&#39;:&#39;&#39;,
                &#39;maxPoints&#39;:&#39;&#39;,
                &#39;displayValues&#39;:&#39;true&#39;
                }
                ];


                DO_NOT_MODIFY_BELOW;

                selected1 = {};
                selected2 = {};
                selectionRefFinale = &#39;&#39;;
                selectionCompareFinale = {};
                &#34;&gt;
    &lt;!--

    --&gt;

    &lt;!-- ### GENERAL SETTINGS ### --&gt;
    &lt;!-- domain (Domain URL): Must contain the URL of the domain where the dataset is published.
     ex: &#39;public.opendatasoft.com&#39;
    --&gt;
    &lt;!-- datasetid (Dataset ID): Must contain the ID of the dataset
     ex: &#39;healthref-france-finess&#39;
    --&gt;
    &lt;!-- compareType: Must contain the type of comparison you want to do. 
            Can be multiFields (to do a comparison based on a serie of fields, for example geographical levels or category and sub-category) or singleField (to do a comparison based on a single field).
     ex: &#39;multiFields&#39;
    --&gt;

    &lt;!-- defaultLevel: the title you want to display when no filter is selected --&gt;


    &lt;!-- ### FILTERS SETTINGS ### --&gt;
    &lt;!-- IF_COMPARE_BY_MULTIFIELDS --&gt;
    &lt;!-- fields : List of fields available on the comparison filters, and their corresponding field id in the dataset.
        You can put as many fields as you have available on your dataset.
        List of parameters are :
        - name (label of the filter to be display on the filter list) ex: &#39;Region&#39;
        - idField (id of the field containing the id of the filter) ex: &#39;reg_code&#39;. can be the same as the labelField.
        - labelField (id of the field containing the label of the filter) ex: &#39;reg_name&#39;
        NB: the field must be a facet in the dataset
        NB: alphanumerical sort is applied in the filter view
        ex: 
        fields = [
                        {
                            name:&#39;Région&#39;,idField:&#39;reg_code&#39;,labelField:&#39;reg_name&#39;
                        },
                        {
                            name:&#39;Département&#39;,idField:&#39;dep_code&#39;,labelField:&#39;dep_name&#39;
                        },
                        {
                            name:&#39;EPCI&#39;,idField:&#39;epci_code&#39;,labelField:&#39;epci_name&#39;
                        },
                        {
                            name:&#39;Commune&#39;,idField:&#39;com_code&#39;,labelField:&#39;com_name&#39;
                        }
                ]
    --&gt;

        &lt;!-- resetFiltersButtonLabel (Label of the button) : test to display when a filter is selected
         ex: &#39;Clear all filters&#39;
    --&gt;

    &lt;!-- IF_COMPARE_BY_SINGLEFIELD --&gt;
    &lt;!--filterFieldId: id of the field containing the id of the filter field;
        filterFieldLabel: id of the field containing the label of the filter field;
        filterFieldId and filterFieldLabel can have the same id.
        ex:  filterFieldId = &#39;categetab&#39;;
             filterFieldLabel = &#39;libcategetab&#39;
    --&gt;

    &lt;!--defaultValue: default selected value you want to set up on the filter;
       ex:  defaultValue = &#39;44&#39;;
       WARNING: must be the value of the filterFieldId and NOT the filterFieldLabel, if they are different.
   --&gt;

    &lt;!-- filterPlaceholder: placeholder text for the filter --&gt;

    &lt;!-- ### KPIS SETTINGS ### --&gt;
    &lt;!-- KPIS settings is a list of object that describes each KPI
    List of available keys are:
    - title (string) : mandatory, name of the KPI, ex: ‘City population’
    - select (string) : mandatory, API V2 select, containing the calculation to perform, ex: ‘sum(population)’ or ‘count(*)’
    - precision (string) : optional, decimal precision of the KPI, ex: 2
    - unit (string) : optional, KPI unit, ex: ‘citizens’
    - faicon (string) : optional, FontAwesome icon id, ex: ‘square-o’ (omit the fa- prefix) 

    Please see the documentation for more information regarding the select
    https://help.opendatasoft.com/apis/ods-explore-v2/#section/Opendatasoft-Query-Language-(ODSQL)

    Please see all available icons here
    https://fontawesome.com/v4/icons/

    ex:
    kpis = [
              {
                  &#39;title&#39;: &#39;Nombre d\&#39;établissements&#39;,
                  &#39;select&#39;: &#39;count(*)&#39;,
                  &#39;precision&#39;: 0,
                  &#39;unit&#39;: &#39;&#39;,
                  &#39;faicon&#39;: &#39;square-o&#39;
              },
              {
                  &#39;title&#39;: &#39;Taille moyenne&#39;,
                  &#39;select&#39;: &#39;avg(surface)&#39;,
                  &#39;precision&#39;: 2,
                  &#39;unit&#39;: &#39;m2&#39;,
                  &#39;faicon&#39;: &#39;square-o&#39;
              }
           ];
--&gt;

    &lt;!-- ### CHARTS SETTINGS ### --&gt;
    &lt;!-- 2 dispositions are available: pyramid (custom css chart) and classic (ods-chart).
         Each disposition has specific parameters--&gt;
    &lt;!-- Pyramid disposition.
     List of available parameters are :
     - disposition (pyramid or classic) ex:&#39;pyramid&#39;
     - title (title of the chart) ex: &#39;Répartition par mode de fixation des tarifs&#39;
     - xAxis (id of the field for the X axis) ex: &#39;libmft&#39;
     - label (label of the serie) ex:&#39;Nombre d\&#39;établissements&#39;
     - select (function for the serie) ex:&#39;COUNT(*)&#39;

    disposition, title, xAxis, select are MANDATORY
    label is optionnal

    Available values for select are AVG, COUNT, MIN, MAX, STDDEV, SUM.
    Please see the documentation for more information
    https://help.opendatasoft.com/widgets/#/api/ods-widgets.directive:odsAnalysis

    ex:
    charts = [
                { 
                &#39;disposition&#39;:&#39;pyramid&#39;,
                &#39;title&#39;:&#39;Répartition par mode de fixation des tarifs&#39;,
                &#39;xAxis&#39;:&#39;libmft&#39;,
                &#39;label&#39;:&#39;Nombre d\&#39;établissements&#39;,
                &#39;select&#39;:&#39;COUNT(*)&#39;
                }
            ]
    --&gt;
    &lt;!-- Classic disposition.
 List of available parameters are :
 - disposition (pyramid or classic) ex:&#39;classic&#39;
 - title (title of the chart) ex: &#39;Date d\ouverture&#39;
 - xAxis (id of the field for the X axis) ex: &#39;dateouv&#39;
 - label (label of the serie) ex:&#39;Nombre d\&#39;établissements&#39;
 - type (type of chart) ex: &#39;line&#39;
 - function (function for the serie) ex:&#39;SUM&#39;
 - expression (field id that contains numerical values to use for the serie) ex: &#39;population&#39;
 - sort (rule to sort the data, empty for default order or serie1-1 to order by serie) ex:&#39;serie1-1&#39;
 - maxPoints (max number of points to display on the X axis) ex:&#39;20&#39;
 - displayValues (can be true or false, if true: values are displayed on the serie): ex:&#39;true&#39;

disposition, title, xAxis, select are MANDATORY
label is optionnal

Available values for type are line, spline, area, areaspline, column, bar, pie, scatter, polar, spiderweb, funnel, arearange, areasplinerange, columnrange

Available values for function are COUNT, AVG, MIN, MAX, STDDEV, SUM, QUANTILES, CONSTANT

Please see the documentation for more information
https://help.opendatasoft.com/widgets/#/api/ods-widgets.directive:odsChartSerie

ex:
charts = [
            {
            &#39;disposition&#39;:&#39;classic&#39;,
            &#39;title&#39;:&#39;Participation au service public hospitalier&#39;,
            &#39;xAxis&#39;:&#39;libsph&#39;,
            &#39;type&#39;:&#39;bar&#39;,
            &#39;function&#39;:&#39;COUNT&#39;,
            &#39;maxPoints&#39;:&#39;20&#39;,
            &#39;displayValues&#39;:&#39;true&#39;,
            &#39;label&#39;:&#39;Nombre d\&#39;établissements&#39;,
            &#39;sort&#39;:&#39;serie1-1&#39;,
            &#39;expression&#39;:&#39;&#39;
            }
        ]
--&gt;

    &lt;!-- DO NOT MODIFY --&gt;
    &lt;!-- Technical fields, do not modify please --&gt;

    &lt;ods-dataset-context context=&#34;ctxref,ctxcompare,ctx1,ctx2,context0,context1,context2,context3,contextcompare0,contextcompare1,contextcompare2,contextcompare3&#34;
                         ctxref-dataset=&#34;{{datasetid}}&#34;
                         ctxref-domain=&#34;{{domain}}&#34;

                         ctxcompare-dataset=&#34;{{datasetid}}&#34;
                         ctxcompare-domain=&#34;{{domain}}&#34;

                         ctx1-dataset=&#34;{{datasetid}}&#34;
                         ctx1-domain=&#34;{{domain}}&#34;

                         ctx2-dataset=&#34;{{datasetid}}&#34;
                         ctx2-domain=&#34;{{domain}}&#34;

                         context0-dataset=&#34;{{datasetid}}&#34;
                         context0-domain=&#34;{{domain}}&#34;
                         context1-dataset=&#34;{{datasetid}}&#34;
                         context1-domain=&#34;{{domain}}&#34;
                         context2-dataset=&#34;{{datasetid}}&#34;
                         context2-domain=&#34;{{domain}}&#34;
                         context3-dataset=&#34;{{datasetid}}&#34;
                         context3-domain=&#34;{{domain}}&#34;

                         contextcompare0-dataset=&#34;{{datasetid}}&#34;
                         contextcompare0-domain=&#34;{{domain}}&#34;
                         contextcompare1-dataset=&#34;{{datasetid}}&#34;
                         contextcompare1-domain=&#34;{{domain}}&#34;
                         contextcompare2-dataset=&#34;{{datasetid}}&#34;
                         contextcompare2-domain=&#34;{{domain}}&#34;
                         contextcompare3-dataset=&#34;{{datasetid}}&#34;
                         contextcompare3-domain=&#34;{{domain}}&#34;
    &gt;

        &lt;span ng-if=&#34;refineField&#34;&gt;
            {{ctxref.parameters[&#39;refine.&#39; &#43; refineField] = refineValue; 
            ctxcompare.parameters[&#39;refine.&#39; &#43; refineField] = refineValue; 
            ctx1.parameters[&#39;refine.&#39; &#43; refineField] = refineValue; 
            ctx2.parameters[&#39;refine.&#39; &#43; refineField] = refineValue;  &#34;&#34;}}
        &lt;/span&gt;

        &lt;div ods-results=&#34;results1&#34; ods-results-context=&#34;ctx1&#34; ods-results-max=&#34;10&#34;&gt;
            &lt;div ods-results=&#34;results2&#34; ods-results-context=&#34;ctx2&#34; ods-results-max=&#34;10&#34;&gt;
                &lt;h1 class=&#34;page-title&#34;&gt;
                    {{ pageTitle }}
                &lt;/h1&gt;
                &lt;p class=&#34;page-subtitle&#34;&gt;
                    {{ pageSubtitle }}
                &lt;/p&gt;
                &lt;section class=&#34;filterbloc&#34;&gt;
    &lt;h2 class=&#34;filterbloc-title&#34;&gt;{{filterTitle}}&lt;/h2&gt;
    &lt;div class=&#34;filter-list&#34; ng-if=&#34;compareType == &#39;multiFields&#39;&#34;&gt;
        &lt;div class=&#34;filter-box select-left&#34;&gt;
            &lt;h4 class=&#34;filter-title&#34;&gt;
                {{referenceFitlerTitle}}
            &lt;/h4&gt;
            &lt;div class=&#34;ods-selects&#34;&gt;
                &lt;div ng-repeat=&#34;(i, fieldname) in fields&#34;&gt;
                    &lt;div ods-adv-analysis=&#34;list1&#34;
                         ods-adv-analysis-context=&#34;{{ &#39;context&#39; &#43; i }}&#34;
                         ods-adv-analysis-select=&#34;count(*)&#34;
                         ods-adv-analysis-group-by=&#34;{{fieldname.idField}},{{fieldname.labelField}}&#34;
                         ods-adv-analysis-order-by=&#34;{{fieldname.labelField}}&#34; ods-adv-analysis-limit=&#34;300&#34;&gt;
                        &lt;ods-select selected-values=&#34;selected1[fieldname.name]&#34;
                                    placeholder=&#34;{{ fieldname.placeholder }}&#34;
                                    label-modifier=&#34;{{fieldname.labelField}}&#34;
                                    value-modifier=&#34;{&#39;code&#39;:{{fieldname.idField}},&#39;name&#39;:{{fieldname.labelField}}}&#34;
                                    options=&#34;list1&#34;
                                    multiple=&#34;false&#34;
                                    is-loading=&#34;true&#34;&gt;&lt;/ods-select&gt;

                        &lt;span ng-repeat=&#34;(j, fake) in fields&#34;&gt;
                            &lt;span ng-if=&#34;i != j&#34;&gt;
                                {{
                                $parent.$parent.$parent.$parent[&#39;context&#39; &#43; j].parameters[&#39;refine.&#39; &#43; fieldname.idField] =
                                ctx1.parameters[&#39;refine.&#39; &#43;fieldname.idField] =
                                (selected1[fieldname.name] | toObject:&#39;code&#39; | keys);&#34;&#34;
                                }}
                            &lt;/span&gt;
                        &lt;/span&gt;
                    &lt;/div&gt;
                   
                &lt;/div&gt;
                &lt;div class=&#34;clear-filters&#34; ng-if=&#34;selected1[fields[3].name].length &gt; 0 || 
                    selected1[fields[2].name].length &gt; 0 ||
                    selected1[fields[1].name].length &gt; 0 ||
                    selected1[fields[0].name].length &gt; 0&#34;&gt;
                &lt;button class=&#34;clear-filters-button&#34;
                    ng-click=&#34;
                    selected1[fields[3].name].length = 0;
                    selected1[fields[2].name].length = 0;
                    selected1[fields[1].name].length = 0;
                    selected1[fields[0].name].length = 0;&#34;&gt;
                        {{resetFiltersButtonLabel}}
                    &lt;/button&gt;
                    &lt;i class=&#34;fa fa-times-circle&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;

                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;

        &lt;div class=&#34;filter-box select-right&#34;&gt;
            &lt;h4 class=&#34;filter-title&#34;&gt;
                {{compareFilterTitle}}
            &lt;/h4&gt;
            &lt;div class=&#34;ods-selects&#34;&gt;
                            &lt;div ng-repeat=&#34;(i, fieldname) in fields&#34;&gt;
                    &lt;div ods-adv-analysis=&#34;list2&#34;
                         ods-adv-analysis-context=&#34;{{ &#39;contextcompare&#39; &#43; i }}&#34;
                         ods-adv-analysis-select=&#34;count(*)&#34;
                         ods-adv-analysis-group-by=&#34;{{fieldname.idField}},{{fieldname.labelField}}&#34;
                         ods-adv-analysis-order-by=&#34;{{fieldname.labelField}}&#34; ods-adv-analysis-limit=&#34;300&#34;&gt;
                        &lt;ods-select selected-values=&#34;selected2[fieldname.name]&#34;
                                    placeholder=&#34;{{  fieldname.placeholder }}&#34;
                                    label-modifier=&#34;{{fieldname.labelField}}&#34;
                                    value-modifier=&#34;{&#39;code&#39;:{{fieldname.idField}},&#39;name&#39;:{{fieldname.labelField}}}&#34;
                                    options=&#34;list2&#34;
                                    multiple=&#34;false&#34;
                                    is-loading=&#34;true&#34;&gt;&lt;/ods-select&gt;

                        &lt;span ng-repeat=&#34;(j, fake) in fields&#34;&gt;
                            &lt;span ng-if=&#34;i != j&#34;&gt;
                                {{
                                $parent.$parent.$parent.$parent[&#39;contextcompare&#39; &#43; j].parameters[&#39;refine.&#39; &#43; fieldname.idField] =
                                ctx2.parameters[&#39;refine.&#39; &#43;fieldname.idField] =
                                (selected2[fieldname.name] | toObject:&#39;code&#39; | keys );&#34;&#34;
                                }}
                            &lt;/span&gt;
                        &lt;/span&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class=&#34;clear-filters&#34; ng-if=&#34;
                selected2[fields[3].name].length &gt; 0 ||
                selected2[fields[2].name].length &gt; 0 ||
                selected2[fields[1].name].length &gt; 0 ||
                selected2[fields[0].name].length &gt; 0&#34;&gt;
                &lt;button class=&#34;clear-filters-button&#34; 
                ng-click=&#34;
                selected2[fields[3].name].length = 0;
                selected2[fields[2].name].length = 0;
                selected2[fields[1].name].length = 0;
                selected2[fields[0].name].length = 0;&#34;&gt;
                {{resetFiltersButtonLabel}}
                &lt;/button&gt;
                &lt;i class=&#34;fa fa-times-circle&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;
            &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&#34;filter-list&#34; ng-if=&#34;compareType == &#39;singleField&#39;&#34;&gt;
        &lt;div class=&#34;filter-box&#34;&gt;
            &lt;h4 class=&#34;filter-title&#34;&gt;
                {{referenceFitlerTitle}}
            &lt;/h4&gt;
            &lt;div ods-adv-analysis=&#34;reflist&#34; ods-adv-analysis-context=&#34;ctxref&#34;
                 ods-adv-analysis-select=&#34;count(*) as y_axis&#34;
                 ods-adv-analysis-group-by=&#34;{{filterFieldId}} as x_axis_id, {{filterFieldLabel}} as x_axis_label&#34;
                 ods-adv-analysis-order-by=&#34;y_axis&#34;&gt;
                &lt;span ng-if=&#34;!defaultValue&#34;&gt;
                    &lt;ods-select options=&#34;reflist&#34; selected-values=&#34;selectionRefFinale&#34; label-modifier=&#34;x_axis_label&#34;
                                value-modifier=&#34;x_axis_id&#34; placeholder=&#34;{{filterPlaceholder}}&#34;&gt;
                    &lt;/ods-select&gt;
                    {{ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId] = selectionRefFinale ; &#34;&#34;}}
                &lt;/span&gt;
                &lt;span ng-if=&#34;defaultValue&#34;&gt;
                    &lt;ods-select options=&#34;reflist&#34; selected-values=&#34;selectionRefFinale&#34;
                                label-modifier=&#34;x_axis_label&#34; value-modifier=&#34;x_axis_id&#34;
                                placeholder=&#34;{{filterPlaceholder}}&#34;&gt;
                    &lt;/ods-select&gt;
                    {{selectionRefFinale == 0 ? selectionRefFinale = defaultValue : &#39;&#39; ; &#34;&#34;}}
                    {{ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId] = selectionRefFinale ; &#34;&#34;}}
                &lt;/span&gt;

            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class=&#34;filter-box&#34;&gt;
            &lt;h4 class=&#34;filter-title&#34;&gt;
                {{compareFilterTitle}}
            &lt;/h4&gt;
            &lt;div ods-adv-analysis=&#34;comparelist&#34; ods-adv-analysis-context=&#34;ctxcompare&#34;
                 ods-adv-analysis-select=&#34;count(*) as y_axis&#34;
                 ods-adv-analysis-group-by=&#34;{{filterFieldId}} as x_axis_id, {{filterFieldLabel}} as x_axis_label&#34;
                 ods-adv-analysis-order-by=&#34;y_axis&#34;&gt;
                &lt;span ng-if=&#34;!defaultValue&#34;&gt;
                    &lt;ods-select options=&#34;comparelist&#34; selected-values=&#34;selectionCompareFinale&#34;
                                label-modifier=&#34;x_axis_label&#34; value-modifier=&#34;x_axis_id&#34;
                                placeholder=&#34;{{filterPlaceholder}}&#34;&gt;
                    &lt;/ods-select&gt;
                    {{ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId] = selectionCompareFinale ; &#34;&#34;}}
                &lt;/span&gt;
                &lt;span ng-if=&#34;defaultValue&#34;&gt;
                    &lt;ods-select options=&#34;comparelist&#34; selected-values=&#34;selectionCompareFinale&#34;
                                label-modifier=&#34;x_axis_label&#34; value-modifier=&#34;x_axis_id&#34;
                                placeholder=&#34;{{filterPlaceholder}}&#34;&gt;
                    &lt;/ods-select&gt;
                    {{selectionCompareFinale == 0 ? selectionCompareFinale = defaultValue : &#39;&#39; ; &#34;&#34;}}
                    {{ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId] = selectionCompareFinale ; &#34;&#34;}}
                    {{ctx2.parameters}}
                &lt;/span&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;!-- {{ctx1.parameters}} // {{ctx2.parameters}}  --&gt;                &lt;div ods-facet-results=&#34;items1&#34; ods-facet-results-context=&#34;ctx1&#34;
                     ods-facet-results-facet-name=&#34;{{filterFieldLabel}}&#34;&gt;
                    &lt;div ods-facet-results=&#34;items2&#34; ods-facet-results-context=&#34;ctx2&#34;
                         ods-facet-results-facet-name=&#34;{{filterFieldLabel}}&#34;&gt;
                        &lt;section class=&#34;box-container&#34; ng-repeat=&#34;kpi in kpis&#34;&gt;
  &lt;div class=&#34;row row-equal-height&#34; ods-adv-analysis=&#34;kpi1&#34; ods-adv-analysis-context=&#34;ctx1&#34; ods-adv-analysis-select=&#34;{{ kpi.select }} as x&#34;&gt;
    &lt;div class=&#34;col-md-4&#34;&gt;
      &lt;!-- KPI box component --&gt;
      &lt;div class=&#34;kpi-card&#34;&gt;
        &lt;i ng-if=&#34;kpi.faicon&#34; class=&#34;kpi-icon fa fa-{{ kpi.faicon }}&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;
        &lt;p class=&#34;kpi-title left&#34;&gt;
          {{ (kpi1[0].x || 0) | number : (kpi.precision || 0) }}         
           &lt;span ng-if=&#34;kpi.unit&#34; class=&#34;kpi-unit left&#34;&gt;{{ kpi.unit }}&lt;/span&gt;
        &lt;/p&gt;
        &lt;p class=&#34;kpi-description&#34;&gt;
          {{ kpi.title }}
        &lt;/p&gt;
        &lt;p class=&#34;kpi-subtitle&#34;
          ng-if=&#34;compareType == &#39;multiFields&#39;&#34;&gt;
          {{ selected1[fields[3].name][0].name ||
            selected1[fields[2].name][0].name ||
            selected1[fields[1].name][0].name ||
            selected1[fields[0].name][0].name || defaultLevel }}&lt;/p&gt;
        
        &lt;p class=&#34;kpi-subtitle&#34; ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length &gt;0&#34;&gt;
          {{results1[0].fields[filterFieldLabel]}}&lt;/p&gt;
          &lt;p class=&#34;kpi-subtitle&#34; ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 &amp;&amp; compareType==&#39;singleField&#39;&#34;&gt;
            {{defaultLevel}}&lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&#34;col-md-4&#34;  ods-adv-analysis=&#34;kpi2&#34; ods-adv-analysis-context=&#34;ctx2&#34; ods-adv-analysis-select=&#34;{{ kpi.select }} as x&#34;&gt;
      &lt;!-- KPI box component --&gt;
      &lt;div class=&#34;kpi-card&#34;&gt;
        &lt;i ng-if=&#34;kpi.faicon&#34; class=&#34;kpi-icon fa fa-{{ kpi.faicon }}&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;
        &lt;p class=&#34;kpi-title right&#34;&gt;
          {{ (kpi2[0].x || 0) | number : (kpi.precision || 0) }}         
          &lt;span ng-if=&#34;kpi.unit&#34; class=&#34;kpi-unit right&#34;&gt;{{ kpi.unit }}&lt;/span&gt;
        &lt;/p&gt;
        &lt;p class=&#34;kpi-description&#34;&gt;
          {{ kpi.title }}
        &lt;/p&gt;
        &lt;p class=&#34;kpi-subtitle&#34;
          ng-if=&#34;compareType == &#39;multiFields&#39;&#34;&gt;
          {{ selected2[fields[3].name][0].name ||
            selected2[fields[2].name][0].name ||
            selected2[fields[1].name][0].name ||
            selected2[fields[0].name][0].name || defaultLevel }}&lt;/p&gt;
        &lt;p class=&#34;kpi-subtitle&#34; ng-if=&#34;ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId].length &gt;0&#34;&gt;
          {{results2[0].fields[filterFieldLabel]}}&lt;/p&gt;
          &lt;p class=&#34;kpi-subtitle&#34; ng-if=&#34;ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 &amp;&amp; compareType==&#39;singleField&#39;&#34;&gt;
            {{defaultLevel}}&lt;/p&gt;

        &lt;p class=&#34;kpi-compare right&#34;&gt;
          {{ ((kpi2[0].x - kpi1[0].x )/kpi1[0].x )*100 &gt; 0 ? &#39;&#43;&#39; : &#39;&#39; }}{{ (((kpi2[0].x -kpi1[0].x )/kpi1[0].x )*100|| 0) | number : 2 }}%
        &lt;/p&gt;
        &lt;span style=&#34;font-style: italic;&#34;&gt;par rapport à &lt;/span&gt;
        &lt;p class=&#34;kpi-compare-subtitle&#34; ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; levelRefSelectedId].length &gt;0&#34;&gt;&lt;span
            ng-repeat=&#34;item1 in items1&#34;&gt; {{item1.name}}{{$last ? &#39;&#39; : &#39; &#43; &#39;}} &lt;/span&gt;&lt;/p&gt;
        &lt;p class=&#34;kpi-compare-subtitle&#34;
          ng-if=&#34;compareType == &#39;multiFields&#39;&#34;&gt;
          {{ selected1[fields[3].name][0].name ||
            selected1[fields[2].name][0].name ||
            selected1[fields[1].name][0].name ||
            selected1[fields[0].name][0].name || defaultLevel }}&lt;/p&gt;
        &lt;p class=&#34;kpi-compare-subtitle&#34; ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length &gt;0&#34;&gt;
          {{results1[0].fields[filterFieldLabel]}}&lt;/p&gt;
          &lt;p class=&#34;kpi-compare-subtitle&#34; ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 &amp;&amp; compareType==&#39;singleField&#39;&#34;&gt;
            {{defaultLevel}}&lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/section&gt;                        &lt;div style=&#34;text-align: right; width: 100%&#34;&gt;
                            &lt;a href=&#34;https://{{ domainid }}/explore/dataset/{{ datasetid }}/&#34;
                               target=&#34;_blank&#34;&gt;Accéder
                                aux données sources&lt;/a&gt;
                        &lt;/div&gt;
                        &lt;span ng-repeat=&#34;chart in charts&#34;&gt;
                                    &lt;span ng-if=&#34;chart.disposition==&#39;pyramid&#39;&#34;&gt;
                                        &lt;section class=&#34;page-section&#34; ng-init=&#34;pyramid = {&#39;analysisref&#39;:undefined,
                            &#39;analysiscompare&#39;:undefined,
                            &#39;orderref&#39;:{},
                            &#39;ordercompare&#39;:{},
                            &#39;defaultorder&#39;:&#39;orderref&#39;}&#34;&gt;

    &lt;div class=&#34;box-container&#34;&gt;
        &lt;div class=&#34;chart-card&#34;&gt;
            &lt;h2&gt;{{chart.title}}&lt;/h2&gt;
            &lt;span ods-adv-analysis=&#34;analysisref&#34; ods-adv-analysis-context=&#34;ctx1&#34;
                ods-adv-analysis-group-by=&#34;{{chart.xAxis}}&#34; ods-adv-analysis-select=&#34;{{chart.select}} as counttotal&#34;
                ods-adv-analysis-order-by=&#34;{{chart.select}} DESC&#34;&gt;
                &lt;div ods-subaggregation=&#34;analysisref&#34; ods-subaggregation-serie-max=&#34;MAX(counttotal)&#34;&gt;

                    {{ pyramid[&#39;maxref&#39;] = results[0].max; &#39;&#39; }}
                &lt;/div&gt;

                {{ pyramid.analysisref = analysisref ; &#39;&#39; }}
            &lt;/span&gt;
            &lt;span ods-adv-analysis=&#34;analysiscompare&#34; ods-adv-analysis-context=&#34;ctx2&#34;
                ods-adv-analysis-group-by=&#34;{{chart.xAxis}}&#34; ods-adv-analysis-select=&#34;{{chart.select}} as counttotal&#34;
                ods-adv-analysis-order-by=&#34;{{chart.select}} DESC&#34;&gt;
                &lt;div ods-subaggregation=&#34;analysiscompare&#34; ods-subaggregation-serie-max=&#34;MAX(counttotal)&#34;&gt;
                    {{ pyramid[&#39;maxcompare&#39;] = results[0].max; &#39;&#39; }}
                &lt;/div&gt;

                {{ pyramid.analysiscompare = analysiscompare ; &#39;&#39; }}
            &lt;/span&gt;
            &lt;span ng-if=&#34;pyramid[&#39;maxref&#39;] &amp;&amp; pyramid[&#39;maxcompare&#39;]&#34;&gt;
                {{ pyramid[&#39;max&#39;] =
                (pyramid[&#39;maxcompare&#39;]&gt;pyramid[&#39;maxref&#39;]?pyramid[&#39;maxcompare&#39;]:pyramid[&#39;maxref&#39;]); &#39;&#39; }}
            &lt;/span&gt;

            &lt;p ng-if=&#34;pyramid.defaultorder == &#39;orderref&#39;&#34; ng-repeat=&#34;(i,item) in pyramid.analysisref&#34;&gt;
                {{ pyramid.order[item[chart.xAxis]] = i&#43;1; &#39;&#39; }}
            &lt;/p&gt;
            &lt;p ng-if=&#34;pyramid.defaultorder == &#39;ordercompare&#39;&#34; ng-repeat=&#34;(i,item) in pyramid.analysiscompare&#34;&gt;
                {{ pyramid.order[item[chart.xAxis]] = i&#43;1; &#39;&#39; }}
            &lt;/p&gt;

            &lt;!--Custom Left/Right Graph here
    ========================================================================== --&gt;

            &lt;div class=&#34;custom-graph&#34;&gt;
                &lt;div class=&#34;custom-graph-body&#34;&gt;
                    &lt;div class=&#34;custom-graph-block&#34;&gt;
                        &lt;div class=&#34;custom-graph-header header-left left&#34;&gt;
                            &lt;h3 class=&#34;custom-graph-title&#34;&gt;
                                &lt;span ng-if=&#34;compareType==&#39;multiFields&#39;&#34;&gt; {{ selected1[fields[3].name][0].name ||
                                    selected1[fields[2].name][0].name ||
                                    selected1[fields[1].name][0].name ||
                                    selected1[fields[0].name][0].name || defaultLevel }}
                                &lt;/span&gt;
                                &lt;span ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length &gt;0&#34;&gt;
                                    {{results1[0].fields[filterFieldLabel]}}&lt;/span&gt;
                                &lt;span
                                    ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 &amp;&amp; compareType==&#39;singleField&#39;&#34;&gt;
                                    {{defaultLevel}}&lt;/span&gt;
                            &lt;/h3&gt;
                            &lt;h4&gt;{{chart.label}}&lt;/h4&gt;
                        &lt;/div&gt;
                        &lt;div class=&#34;custom-graph-content-left&#34;&gt;
                            &lt;div class=&#34;custom-graph-item&#34; ng-repeat=&#34;itemleft in pyramid.analysisref&#34;
                                ng-if=&#34;pyramid.order[itemleft[chart.xAxis]]&lt;=10&#34; style=&#34;grid-row: {{ pyramid.order[itemleft[chart.xAxis]] }} ;
                                    grid-column:1&#34;&gt;
                                &lt;h5 class=&#34;custom-graph-item-title&#34;&gt;
                                    {{ itemleft[chart.xAxis] }}
                                &lt;/h5&gt;
                                &lt;div class=&#34;custom-graph-progress-container&#34;&gt;
                                    &lt;div class=&#34;custom-graph-progress background-left&#34;
                                        style=&#34;width: {{ 100 * itemleft.counttotal / pyramid.max }}%&#34;&gt;
                                        &lt;span class=&#34;custom-graph-progress-value&#34;&gt;
                                            {{ itemleft.counttotal | number }}
                                        &lt;/span&gt;
                                    &lt;/div&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;

                    &lt;div class=&#34;custom-graph-separator&#34;&gt;&lt;/div&gt;
                    &lt;div class=&#34;custom-graph-block&#34;&gt;
                        &lt;div class=&#34;custom-graph-header header-right right&#34;&gt;
                            &lt;h3 class=&#34;custom-graph-title&#34;&gt;
                                &lt;span ng-if=&#34;compareType==&#39;multiFields&#39;&#34;&gt; {{ selected2[fields[3].name][0].name ||
                                    selected2[fields[2].name][0].name ||
                                    selected2[fields[1].name][0].name ||
                                    selected2[fields[0].name][0].name || defaultLevel }}&lt;/span&gt;
                                &lt;span ng-if=&#34;ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId].length &gt;0&#34;&gt;
                                    {{results2[0].fields[filterFieldLabel]}}&lt;/span&gt;
                                &lt;span
                                    ng-if=&#34;ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 &amp;&amp; compareType==&#39;singleField&#39;&#34;&gt;
                                    {{defaultLevel}}&lt;/span&gt;
                            &lt;/h3&gt;
                            &lt;h4&gt;{{chart.label}}&lt;/h4&gt;
                        &lt;/div&gt;
                        &lt;div class=&#34;custom-graph-content-right&#34;&gt;
                            &lt;div class=&#34;custom-graph-item&#34; ng-repeat=&#34;itemright in pyramid.analysiscompare&#34;
                                ng-if=&#34;pyramid.order[itemright[chart.xAxis]]&lt;=10&#34; style=&#34;grid-row: {{ pyramid.order[itemright[chart.xAxis]] }} ;
                                    grid-column:1&#34;&gt;
                                &lt;h5 class=&#34;custom-graph-item-title&#34;&gt;
                                    {{ itemright[chart.xAxis] }}
                                &lt;/h5&gt;
                                &lt;div class=&#34;custom-graph-progress-container&#34;&gt;
                                    &lt;div class=&#34;custom-graph-progress background-right&#34;
                                        style=&#34;width: {{ 100 * itemright.counttotal / pyramid.max }}%&#34;&gt;
                                        &lt;span class=&#34;custom-graph-progress-value&#34;&gt;
                                            {{ itemright.counttotal | number }}
                                        &lt;/span&gt;
                                    &lt;/div&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;                                    &lt;/span&gt;
                                    &lt;span ng-if=&#34;chart.disposition==&#39;classic&#39;&#34;&gt;
                                        &lt;div class=&#34;box-container&#34;&gt;
    &lt;div class=&#34;chart-card&#34;&gt;
        &lt;h2&gt;{{chart.title}}&lt;/h2&gt;
        &lt;ods-chart ng-if=&#34;compareType==&#39;multiFields&#39;&#34; align-month=&#34;true&#34; single-y-axis=&#34;true&#34; labels-x-length=&#34;25&#34;&gt;
            &lt;ods-chart-query context=&#34;ctx1&#34; field-x=&#34;{{chart.xAxis}}&#34; maxpoints=&#34;{{chart.maxPoints}}&#34;
                sort=&#34;{{chart.sort}}&#34;&gt;
                &lt;ods-chart-serie label-y=&#34;{{ chart.label &#43; &#39; - &#39; &#43; (selected1[fields[3].name][0].name ||
                selected1[fields[2].name][0].name ||
                selected1[fields[1].name][0].name ||
                selected1[fields[0].name][0].name ||defaultLevel ) }}&#34; expression-y=&#34;{{chart.xAxis}}&#34; chart-type=&#34;{{chart.type}}&#34;
                    function-y=&#34;{{chart.function}}&#34; color=&#34;#08A8AB&#34; scientific-display=&#34;true&#34;
                    display-values=&#34;{{chart.displayValues}}&#34; logarithmic=&#34;true&#34;&gt;
                &lt;/ods-chart-serie&gt;
            &lt;/ods-chart-query&gt;
            &lt;ods-chart-query context=&#34;ctx2&#34; field-x=&#34;{{chart.xAxis}}&#34; maxpoints=&#34;{{chart.maxPoints}}&#34; sort=&#34;{{chart.sort}}&#34;&gt;
                &lt;ods-chart-serie label-y=&#34;{{ chart.label &#43; &#39; - &#39; &#43; (selected2[fields[3].name][0].name ||
                selected2[fields[2].name][0].name ||
                selected2[fields[1].name][0].name ||
                selected2[fields[0].name][0].name || defaultLevel) }}&#34; expression-y=&#34;{{chart.xAxis}}&#34; chart-type=&#34;{{chart.type}}&#34;
                    function-y=&#34;{{chart.function}}&#34; color=&#34;#D5AC00&#34; scientific-display=&#34;true&#34;
                    display-values=&#34;{{chart.displayValues}}&#34; logarithmic=&#34;true&#34;&gt;
                &lt;/ods-chart-serie&gt;
            &lt;/ods-chart-query&gt;
        &lt;/ods-chart&gt;
        &lt;ods-chart ng-if=&#34;compareType==&#39;singleField&#39;&#34; align-month=&#34;true&#34; single-y-axis=&#34;true&#34; labels-x-length=&#34;25&#34;&gt;
            &lt;ods-chart-query context=&#34;ctx1&#34; field-x=&#34;{{chart.xAxis}}&#34; maxpoints=&#34;{{chart.maxPoints}}&#34;
                sort=&#34;{{chart.sort}}&#34;&gt;
                &lt;ods-chart-serie label-y=&#34;{{ chart.label &#43; &#39; - &#39; &#43; ((items1 | toObject : &#39;name&#39; | keys).length == 1 ? (items1 | toObject : &#39;name&#39; | keys) : defaultLevel) }}&#34; expression-y=&#34;{{chart.xAxis}}&#34; chart-type=&#34;{{chart.type}}&#34;
                    function-y=&#34;{{chart.function}}&#34; color=&#34;#08A8AB&#34; scientific-display=&#34;true&#34;
                    display-values=&#34;{{chart.displayValues}}&#34; logarithmic=&#34;true&#34;&gt;
                &lt;/ods-chart-serie&gt;
            &lt;/ods-chart-query&gt;
            &lt;ods-chart-query context=&#34;ctx2&#34; field-x=&#34;{{chart.xAxis}}&#34; maxpoints=&#34;{{chart.maxPoints}}&#34; sort=&#34;{{chart.sort}}&#34;&gt;
                &lt;ods-chart-serie label-y=&#34;{{ chart.label &#43; &#39; - &#39; &#43; ((items2 | toObject : &#39;name&#39; | keys).length == 1 ? (items2 | toObject : &#39;name&#39; | keys) : defaultLevel) }}&#34; expression-y=&#34;{{chart.xAxis}}&#34; chart-type=&#34;{{chart.type}}&#34;
                    function-y=&#34;{{chart.function}}&#34; color=&#34;#D5AC00&#34; scientific-display=&#34;true&#34;
                    display-values=&#34;{{chart.displayValues}}&#34; logarithmic=&#34;true&#34;&gt;
                &lt;/ods-chart-serie&gt;
            &lt;/ods-chart-query&gt;
        &lt;/ods-chart&gt;
    &lt;/div&gt;
&lt;/div&gt;                                    &lt;/span&gt;
                                &lt;/span&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/ods-dataset-context&gt;
&lt;/div&gt;"
                 role="tabpanel">
                <div class="highlight">
                    <pre class="language-html" data-lang="html"><code>&lt;!-- IMPORTANT ******** MUST READ !

    In the following settings declaration :

    A common error is forget to escape (protect) apostrophe with a leading backslash
    As apostrophes are used to declare values of variable it will break the settings

    Ex:
    wrongVariable = &#39;I&#39;ll be freed from apostrophes&#39;
    correctVariable = &#39;I\&#39;ll be freed from apostrophes&#39;
--&gt;

&lt;!-- SETTINGS START HERE --&gt;
&lt;div class=&#34;container&#34;ng-init=&#34;domain = &#39;userclub.opendatasoft.com&#39;;
                datasetid = &#39;healthref-france-finess&#39;;
                
                refineField = &#39;&#39;;
                refineValue = &#39;&#39;;

                pageTitle = &#39;Analyse : Etablissements du domaine sanitaire et social en France&#39;;
                pageSubtitle = &#39;Cette page permet de comparer la répartition des établissements du domaine sanitaire et social en France. Sélectionnez les territoires à comparer et parcourez les différents indicateurs et graphiques pour dresser votre analyse.&#39;;

                compareType = &#39;multiFields&#39;;
                
                filterTitle = &#39;Sélectionnez les catégories à comparer&#39;;
                referenceFitlerTitle = &#39;Catégorie de référence&#39;;
                compareFilterTitle = &#39;Catégorie à comparer&#39;;

                defaultLevel = &#39;France entière&#39;;

                IF_COMPARE_BY_MULTIFIELDS;

                fields = [
                {name:&#39;Région&#39;,idField:&#39;code_officiel_region&#39;,labelField:&#39;nom_officiel_region&#39;, placeholder:&#39;Toutes régions&#39;},
                {name:&#39;Département&#39;, idField:&#39;departement&#39;,labelField:&#39;libelle_departement&#39;, placeholder:&#39;Tous départements&#39;},
                {name:&#39;EPCI&#39;, idField:&#39;code_officiel_epci&#39;,labelField:&#39;nom_officiel_epci&#39;, placeholder:&#39;Tous EPCIs&#39;},
                {name:&#39;Commune&#39;, idField:&#39;code_commune&#39;,labelField:&#39;nom_officiel_commune&#39;, placeholder:&#39;Toutes communes&#39;}
                ];

                resetFiltersButtonLabel = &#39;Supprimer tous les filtres&#39;;

                IF_COMPARE_BY_SINGLEFIELD;

                filterFieldId = &#39;alert_country&#39;;
                filterFieldLabel = &#39;alert_country&#39;;

                defaultValue = &#39;&#39;;

                filterPlaceholder = &#39;Sélectionnez une valeur&#39;;

                kpis = [ 
                {
                &#39;title&#39;: &#39;Nombre d\&#39;établissements&#39;,
                &#39;select&#39;: &#39;count(*)&#39;,
                &#39;precision&#39;: 0,
                &#39;unit&#39;: &#39;&#39;,
                &#39;faicon&#39;: &#39;square-o&#39;
                }
                ];

                charts = [
                { 
                &#39;disposition&#39;:&#39;pyramid&#39;,
                &#39;title&#39;:&#39;Répartition par mode de fixation des tarifs&#39;,
                &#39;xAxis&#39;:&#39;libelle_mft&#39;,
                &#39;label&#39;:&#39;Nombre d\&#39;établissements&#39;,
                &#39;select&#39;:&#39;count(*)&#39;
                },
                { 
                &#39;disposition&#39;:&#39;pyramid&#39;,
                &#39;title&#39;:&#39;Répartition par catégorie d\’établissement&#39;,
                &#39;xAxis&#39;:&#39;libelle_categorie_d_etablissement&#39;,
                &#39;label&#39;:&#39;Nombre d\&#39;établissements&#39;,
                &#39;select&#39;:&#39;count(*)&#39;
                },
                { 
                &#39;disposition&#39;:&#39;classic&#39;,
                &#39;title&#39;:&#39;Participation au service public hospitalier&#39;,
                &#39;xAxis&#39;:&#39;libelle_sph&#39;,
                &#39;type&#39;:&#39;line&#39;,
                &#39;function&#39;:&#39;COUNT&#39;,
                &#39;maxPoints&#39;:&#39;20&#39;,
                &#39;displayValues&#39;:&#39;true&#39;,
                &#39;label&#39;:&#39;Nombre d\&#39;établissements&#39;,
                &#39;sort&#39;:&#39;serie1-1&#39;,
                &#39;expression&#39;:&#39;&#39;
                },
                { 
                &#39;disposition&#39;:&#39;classic&#39;,
                &#39;title&#39;:&#39;Date d\&#39;ouverture&#39;,
                &#39;xAxis&#39;:&#39;date_d_ouverture&#39;,
                &#39;label&#39;:&#39;Nombre d\&#39;établissements&#39;,
                &#39;type&#39;:&#39;line&#39;,
                &#39;function&#39;:&#39;COUNT&#39;,
                &#39;expression&#39;:&#39;&#39;,
                &#39;sort&#39;:&#39;&#39;,
                &#39;maxPoints&#39;:&#39;&#39;,
                &#39;displayValues&#39;:&#39;true&#39;
                }
                ];


                DO_NOT_MODIFY_BELOW;

                selected1 = {};
                selected2 = {};
                selectionRefFinale = &#39;&#39;;
                selectionCompareFinale = {};
                &#34;&gt;
    &lt;!--

    --&gt;

    &lt;!-- ### GENERAL SETTINGS ### --&gt;
    &lt;!-- domain (Domain URL): Must contain the URL of the domain where the dataset is published.
     ex: &#39;public.opendatasoft.com&#39;
    --&gt;
    &lt;!-- datasetid (Dataset ID): Must contain the ID of the dataset
     ex: &#39;healthref-france-finess&#39;
    --&gt;
    &lt;!-- compareType: Must contain the type of comparison you want to do. 
            Can be multiFields (to do a comparison based on a serie of fields, for example geographical levels or category and sub-category) or singleField (to do a comparison based on a single field).
     ex: &#39;multiFields&#39;
    --&gt;

    &lt;!-- defaultLevel: the title you want to display when no filter is selected --&gt;


    &lt;!-- ### FILTERS SETTINGS ### --&gt;
    &lt;!-- IF_COMPARE_BY_MULTIFIELDS --&gt;
    &lt;!-- fields : List of fields available on the comparison filters, and their corresponding field id in the dataset.
        You can put as many fields as you have available on your dataset.
        List of parameters are :
        - name (label of the filter to be display on the filter list) ex: &#39;Region&#39;
        - idField (id of the field containing the id of the filter) ex: &#39;reg_code&#39;. can be the same as the labelField.
        - labelField (id of the field containing the label of the filter) ex: &#39;reg_name&#39;
        NB: the field must be a facet in the dataset
        NB: alphanumerical sort is applied in the filter view
        ex: 
        fields = [
                        {
                            name:&#39;Région&#39;,idField:&#39;reg_code&#39;,labelField:&#39;reg_name&#39;
                        },
                        {
                            name:&#39;Département&#39;,idField:&#39;dep_code&#39;,labelField:&#39;dep_name&#39;
                        },
                        {
                            name:&#39;EPCI&#39;,idField:&#39;epci_code&#39;,labelField:&#39;epci_name&#39;
                        },
                        {
                            name:&#39;Commune&#39;,idField:&#39;com_code&#39;,labelField:&#39;com_name&#39;
                        }
                ]
    --&gt;

        &lt;!-- resetFiltersButtonLabel (Label of the button) : test to display when a filter is selected
         ex: &#39;Clear all filters&#39;
    --&gt;

    &lt;!-- IF_COMPARE_BY_SINGLEFIELD --&gt;
    &lt;!--filterFieldId: id of the field containing the id of the filter field;
        filterFieldLabel: id of the field containing the label of the filter field;
        filterFieldId and filterFieldLabel can have the same id.
        ex:  filterFieldId = &#39;categetab&#39;;
             filterFieldLabel = &#39;libcategetab&#39;
    --&gt;

    &lt;!--defaultValue: default selected value you want to set up on the filter;
       ex:  defaultValue = &#39;44&#39;;
       WARNING: must be the value of the filterFieldId and NOT the filterFieldLabel, if they are different.
   --&gt;

    &lt;!-- filterPlaceholder: placeholder text for the filter --&gt;

    &lt;!-- ### KPIS SETTINGS ### --&gt;
    &lt;!-- KPIS settings is a list of object that describes each KPI
    List of available keys are:
    - title (string) : mandatory, name of the KPI, ex: ‘City population’
    - select (string) : mandatory, API V2 select, containing the calculation to perform, ex: ‘sum(population)’ or ‘count(*)’
    - precision (string) : optional, decimal precision of the KPI, ex: 2
    - unit (string) : optional, KPI unit, ex: ‘citizens’
    - faicon (string) : optional, FontAwesome icon id, ex: ‘square-o’ (omit the fa- prefix) 

    Please see the documentation for more information regarding the select
    https://help.opendatasoft.com/apis/ods-explore-v2/#section/Opendatasoft-Query-Language-(ODSQL)

    Please see all available icons here
    https://fontawesome.com/v4/icons/

    ex:
    kpis = [
              {
                  &#39;title&#39;: &#39;Nombre d\&#39;établissements&#39;,
                  &#39;select&#39;: &#39;count(*)&#39;,
                  &#39;precision&#39;: 0,
                  &#39;unit&#39;: &#39;&#39;,
                  &#39;faicon&#39;: &#39;square-o&#39;
              },
              {
                  &#39;title&#39;: &#39;Taille moyenne&#39;,
                  &#39;select&#39;: &#39;avg(surface)&#39;,
                  &#39;precision&#39;: 2,
                  &#39;unit&#39;: &#39;m2&#39;,
                  &#39;faicon&#39;: &#39;square-o&#39;
              }
           ];
--&gt;

    &lt;!-- ### CHARTS SETTINGS ### --&gt;
    &lt;!-- 2 dispositions are available: pyramid (custom css chart) and classic (ods-chart).
         Each disposition has specific parameters--&gt;
    &lt;!-- Pyramid disposition.
     List of available parameters are :
     - disposition (pyramid or classic) ex:&#39;pyramid&#39;
     - title (title of the chart) ex: &#39;Répartition par mode de fixation des tarifs&#39;
     - xAxis (id of the field for the X axis) ex: &#39;libmft&#39;
     - label (label of the serie) ex:&#39;Nombre d\&#39;établissements&#39;
     - select (function for the serie) ex:&#39;COUNT(*)&#39;

    disposition, title, xAxis, select are MANDATORY
    label is optionnal

    Available values for select are AVG, COUNT, MIN, MAX, STDDEV, SUM.
    Please see the documentation for more information
    https://help.opendatasoft.com/widgets/#/api/ods-widgets.directive:odsAnalysis

    ex:
    charts = [
                { 
                &#39;disposition&#39;:&#39;pyramid&#39;,
                &#39;title&#39;:&#39;Répartition par mode de fixation des tarifs&#39;,
                &#39;xAxis&#39;:&#39;libmft&#39;,
                &#39;label&#39;:&#39;Nombre d\&#39;établissements&#39;,
                &#39;select&#39;:&#39;COUNT(*)&#39;
                }
            ]
    --&gt;
    &lt;!-- Classic disposition.
 List of available parameters are :
 - disposition (pyramid or classic) ex:&#39;classic&#39;
 - title (title of the chart) ex: &#39;Date d\ouverture&#39;
 - xAxis (id of the field for the X axis) ex: &#39;dateouv&#39;
 - label (label of the serie) ex:&#39;Nombre d\&#39;établissements&#39;
 - type (type of chart) ex: &#39;line&#39;
 - function (function for the serie) ex:&#39;SUM&#39;
 - expression (field id that contains numerical values to use for the serie) ex: &#39;population&#39;
 - sort (rule to sort the data, empty for default order or serie1-1 to order by serie) ex:&#39;serie1-1&#39;
 - maxPoints (max number of points to display on the X axis) ex:&#39;20&#39;
 - displayValues (can be true or false, if true: values are displayed on the serie): ex:&#39;true&#39;

disposition, title, xAxis, select are MANDATORY
label is optionnal

Available values for type are line, spline, area, areaspline, column, bar, pie, scatter, polar, spiderweb, funnel, arearange, areasplinerange, columnrange

Available values for function are COUNT, AVG, MIN, MAX, STDDEV, SUM, QUANTILES, CONSTANT

Please see the documentation for more information
https://help.opendatasoft.com/widgets/#/api/ods-widgets.directive:odsChartSerie

ex:
charts = [
            {
            &#39;disposition&#39;:&#39;classic&#39;,
            &#39;title&#39;:&#39;Participation au service public hospitalier&#39;,
            &#39;xAxis&#39;:&#39;libsph&#39;,
            &#39;type&#39;:&#39;bar&#39;,
            &#39;function&#39;:&#39;COUNT&#39;,
            &#39;maxPoints&#39;:&#39;20&#39;,
            &#39;displayValues&#39;:&#39;true&#39;,
            &#39;label&#39;:&#39;Nombre d\&#39;établissements&#39;,
            &#39;sort&#39;:&#39;serie1-1&#39;,
            &#39;expression&#39;:&#39;&#39;
            }
        ]
--&gt;

    &lt;!-- DO NOT MODIFY --&gt;
    &lt;!-- Technical fields, do not modify please --&gt;

    &lt;ods-dataset-context context=&#34;ctxref,ctxcompare,ctx1,ctx2,context0,context1,context2,context3,contextcompare0,contextcompare1,contextcompare2,contextcompare3&#34;
                         ctxref-dataset=&#34;{{datasetid}}&#34;
                         ctxref-domain=&#34;{{domain}}&#34;

                         ctxcompare-dataset=&#34;{{datasetid}}&#34;
                         ctxcompare-domain=&#34;{{domain}}&#34;

                         ctx1-dataset=&#34;{{datasetid}}&#34;
                         ctx1-domain=&#34;{{domain}}&#34;

                         ctx2-dataset=&#34;{{datasetid}}&#34;
                         ctx2-domain=&#34;{{domain}}&#34;

                         context0-dataset=&#34;{{datasetid}}&#34;
                         context0-domain=&#34;{{domain}}&#34;
                         context1-dataset=&#34;{{datasetid}}&#34;
                         context1-domain=&#34;{{domain}}&#34;
                         context2-dataset=&#34;{{datasetid}}&#34;
                         context2-domain=&#34;{{domain}}&#34;
                         context3-dataset=&#34;{{datasetid}}&#34;
                         context3-domain=&#34;{{domain}}&#34;

                         contextcompare0-dataset=&#34;{{datasetid}}&#34;
                         contextcompare0-domain=&#34;{{domain}}&#34;
                         contextcompare1-dataset=&#34;{{datasetid}}&#34;
                         contextcompare1-domain=&#34;{{domain}}&#34;
                         contextcompare2-dataset=&#34;{{datasetid}}&#34;
                         contextcompare2-domain=&#34;{{domain}}&#34;
                         contextcompare3-dataset=&#34;{{datasetid}}&#34;
                         contextcompare3-domain=&#34;{{domain}}&#34;
    &gt;

        &lt;span ng-if=&#34;refineField&#34;&gt;
            {{ctxref.parameters[&#39;refine.&#39; &#43; refineField] = refineValue; 
            ctxcompare.parameters[&#39;refine.&#39; &#43; refineField] = refineValue; 
            ctx1.parameters[&#39;refine.&#39; &#43; refineField] = refineValue; 
            ctx2.parameters[&#39;refine.&#39; &#43; refineField] = refineValue;  &#34;&#34;}}
        &lt;/span&gt;

        &lt;div ods-results=&#34;results1&#34; ods-results-context=&#34;ctx1&#34; ods-results-max=&#34;10&#34;&gt;
            &lt;div ods-results=&#34;results2&#34; ods-results-context=&#34;ctx2&#34; ods-results-max=&#34;10&#34;&gt;
                &lt;h1 class=&#34;page-title&#34;&gt;
                    {{ pageTitle }}
                &lt;/h1&gt;
                &lt;p class=&#34;page-subtitle&#34;&gt;
                    {{ pageSubtitle }}
                &lt;/p&gt;
                &lt;section class=&#34;filterbloc&#34;&gt;
    &lt;h2 class=&#34;filterbloc-title&#34;&gt;{{filterTitle}}&lt;/h2&gt;
    &lt;div class=&#34;filter-list&#34; ng-if=&#34;compareType == &#39;multiFields&#39;&#34;&gt;
        &lt;div class=&#34;filter-box select-left&#34;&gt;
            &lt;h4 class=&#34;filter-title&#34;&gt;
                {{referenceFitlerTitle}}
            &lt;/h4&gt;
            &lt;div class=&#34;ods-selects&#34;&gt;
                &lt;div ng-repeat=&#34;(i, fieldname) in fields&#34;&gt;
                    &lt;div ods-adv-analysis=&#34;list1&#34;
                         ods-adv-analysis-context=&#34;{{ &#39;context&#39; &#43; i }}&#34;
                         ods-adv-analysis-select=&#34;count(*)&#34;
                         ods-adv-analysis-group-by=&#34;{{fieldname.idField}},{{fieldname.labelField}}&#34;
                         ods-adv-analysis-order-by=&#34;{{fieldname.labelField}}&#34; ods-adv-analysis-limit=&#34;300&#34;&gt;
                        &lt;ods-select selected-values=&#34;selected1[fieldname.name]&#34;
                                    placeholder=&#34;{{ fieldname.placeholder }}&#34;
                                    label-modifier=&#34;{{fieldname.labelField}}&#34;
                                    value-modifier=&#34;{&#39;code&#39;:{{fieldname.idField}},&#39;name&#39;:{{fieldname.labelField}}}&#34;
                                    options=&#34;list1&#34;
                                    multiple=&#34;false&#34;
                                    is-loading=&#34;true&#34;&gt;&lt;/ods-select&gt;

                        &lt;span ng-repeat=&#34;(j, fake) in fields&#34;&gt;
                            &lt;span ng-if=&#34;i != j&#34;&gt;
                                {{
                                $parent.$parent.$parent.$parent[&#39;context&#39; &#43; j].parameters[&#39;refine.&#39; &#43; fieldname.idField] =
                                ctx1.parameters[&#39;refine.&#39; &#43;fieldname.idField] =
                                (selected1[fieldname.name] | toObject:&#39;code&#39; | keys);&#34;&#34;
                                }}
                            &lt;/span&gt;
                        &lt;/span&gt;
                    &lt;/div&gt;
                   
                &lt;/div&gt;
                &lt;div class=&#34;clear-filters&#34; ng-if=&#34;selected1[fields[3].name].length &gt; 0 || 
                    selected1[fields[2].name].length &gt; 0 ||
                    selected1[fields[1].name].length &gt; 0 ||
                    selected1[fields[0].name].length &gt; 0&#34;&gt;
                &lt;button class=&#34;clear-filters-button&#34;
                    ng-click=&#34;
                    selected1[fields[3].name].length = 0;
                    selected1[fields[2].name].length = 0;
                    selected1[fields[1].name].length = 0;
                    selected1[fields[0].name].length = 0;&#34;&gt;
                        {{resetFiltersButtonLabel}}
                    &lt;/button&gt;
                    &lt;i class=&#34;fa fa-times-circle&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;

                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;

        &lt;div class=&#34;filter-box select-right&#34;&gt;
            &lt;h4 class=&#34;filter-title&#34;&gt;
                {{compareFilterTitle}}
            &lt;/h4&gt;
            &lt;div class=&#34;ods-selects&#34;&gt;
                            &lt;div ng-repeat=&#34;(i, fieldname) in fields&#34;&gt;
                    &lt;div ods-adv-analysis=&#34;list2&#34;
                         ods-adv-analysis-context=&#34;{{ &#39;contextcompare&#39; &#43; i }}&#34;
                         ods-adv-analysis-select=&#34;count(*)&#34;
                         ods-adv-analysis-group-by=&#34;{{fieldname.idField}},{{fieldname.labelField}}&#34;
                         ods-adv-analysis-order-by=&#34;{{fieldname.labelField}}&#34; ods-adv-analysis-limit=&#34;300&#34;&gt;
                        &lt;ods-select selected-values=&#34;selected2[fieldname.name]&#34;
                                    placeholder=&#34;{{  fieldname.placeholder }}&#34;
                                    label-modifier=&#34;{{fieldname.labelField}}&#34;
                                    value-modifier=&#34;{&#39;code&#39;:{{fieldname.idField}},&#39;name&#39;:{{fieldname.labelField}}}&#34;
                                    options=&#34;list2&#34;
                                    multiple=&#34;false&#34;
                                    is-loading=&#34;true&#34;&gt;&lt;/ods-select&gt;

                        &lt;span ng-repeat=&#34;(j, fake) in fields&#34;&gt;
                            &lt;span ng-if=&#34;i != j&#34;&gt;
                                {{
                                $parent.$parent.$parent.$parent[&#39;contextcompare&#39; &#43; j].parameters[&#39;refine.&#39; &#43; fieldname.idField] =
                                ctx2.parameters[&#39;refine.&#39; &#43;fieldname.idField] =
                                (selected2[fieldname.name] | toObject:&#39;code&#39; | keys );&#34;&#34;
                                }}
                            &lt;/span&gt;
                        &lt;/span&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class=&#34;clear-filters&#34; ng-if=&#34;
                selected2[fields[3].name].length &gt; 0 ||
                selected2[fields[2].name].length &gt; 0 ||
                selected2[fields[1].name].length &gt; 0 ||
                selected2[fields[0].name].length &gt; 0&#34;&gt;
                &lt;button class=&#34;clear-filters-button&#34; 
                ng-click=&#34;
                selected2[fields[3].name].length = 0;
                selected2[fields[2].name].length = 0;
                selected2[fields[1].name].length = 0;
                selected2[fields[0].name].length = 0;&#34;&gt;
                {{resetFiltersButtonLabel}}
                &lt;/button&gt;
                &lt;i class=&#34;fa fa-times-circle&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;
            &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&#34;filter-list&#34; ng-if=&#34;compareType == &#39;singleField&#39;&#34;&gt;
        &lt;div class=&#34;filter-box&#34;&gt;
            &lt;h4 class=&#34;filter-title&#34;&gt;
                {{referenceFitlerTitle}}
            &lt;/h4&gt;
            &lt;div ods-adv-analysis=&#34;reflist&#34; ods-adv-analysis-context=&#34;ctxref&#34;
                 ods-adv-analysis-select=&#34;count(*) as y_axis&#34;
                 ods-adv-analysis-group-by=&#34;{{filterFieldId}} as x_axis_id, {{filterFieldLabel}} as x_axis_label&#34;
                 ods-adv-analysis-order-by=&#34;y_axis&#34;&gt;
                &lt;span ng-if=&#34;!defaultValue&#34;&gt;
                    &lt;ods-select options=&#34;reflist&#34; selected-values=&#34;selectionRefFinale&#34; label-modifier=&#34;x_axis_label&#34;
                                value-modifier=&#34;x_axis_id&#34; placeholder=&#34;{{filterPlaceholder}}&#34;&gt;
                    &lt;/ods-select&gt;
                    {{ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId] = selectionRefFinale ; &#34;&#34;}}
                &lt;/span&gt;
                &lt;span ng-if=&#34;defaultValue&#34;&gt;
                    &lt;ods-select options=&#34;reflist&#34; selected-values=&#34;selectionRefFinale&#34;
                                label-modifier=&#34;x_axis_label&#34; value-modifier=&#34;x_axis_id&#34;
                                placeholder=&#34;{{filterPlaceholder}}&#34;&gt;
                    &lt;/ods-select&gt;
                    {{selectionRefFinale == 0 ? selectionRefFinale = defaultValue : &#39;&#39; ; &#34;&#34;}}
                    {{ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId] = selectionRefFinale ; &#34;&#34;}}
                &lt;/span&gt;

            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class=&#34;filter-box&#34;&gt;
            &lt;h4 class=&#34;filter-title&#34;&gt;
                {{compareFilterTitle}}
            &lt;/h4&gt;
            &lt;div ods-adv-analysis=&#34;comparelist&#34; ods-adv-analysis-context=&#34;ctxcompare&#34;
                 ods-adv-analysis-select=&#34;count(*) as y_axis&#34;
                 ods-adv-analysis-group-by=&#34;{{filterFieldId}} as x_axis_id, {{filterFieldLabel}} as x_axis_label&#34;
                 ods-adv-analysis-order-by=&#34;y_axis&#34;&gt;
                &lt;span ng-if=&#34;!defaultValue&#34;&gt;
                    &lt;ods-select options=&#34;comparelist&#34; selected-values=&#34;selectionCompareFinale&#34;
                                label-modifier=&#34;x_axis_label&#34; value-modifier=&#34;x_axis_id&#34;
                                placeholder=&#34;{{filterPlaceholder}}&#34;&gt;
                    &lt;/ods-select&gt;
                    {{ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId] = selectionCompareFinale ; &#34;&#34;}}
                &lt;/span&gt;
                &lt;span ng-if=&#34;defaultValue&#34;&gt;
                    &lt;ods-select options=&#34;comparelist&#34; selected-values=&#34;selectionCompareFinale&#34;
                                label-modifier=&#34;x_axis_label&#34; value-modifier=&#34;x_axis_id&#34;
                                placeholder=&#34;{{filterPlaceholder}}&#34;&gt;
                    &lt;/ods-select&gt;
                    {{selectionCompareFinale == 0 ? selectionCompareFinale = defaultValue : &#39;&#39; ; &#34;&#34;}}
                    {{ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId] = selectionCompareFinale ; &#34;&#34;}}
                    {{ctx2.parameters}}
                &lt;/span&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;!-- {{ctx1.parameters}} // {{ctx2.parameters}}  --&gt;                &lt;div ods-facet-results=&#34;items1&#34; ods-facet-results-context=&#34;ctx1&#34;
                     ods-facet-results-facet-name=&#34;{{filterFieldLabel}}&#34;&gt;
                    &lt;div ods-facet-results=&#34;items2&#34; ods-facet-results-context=&#34;ctx2&#34;
                         ods-facet-results-facet-name=&#34;{{filterFieldLabel}}&#34;&gt;
                        &lt;section class=&#34;box-container&#34; ng-repeat=&#34;kpi in kpis&#34;&gt;
  &lt;div class=&#34;row row-equal-height&#34; ods-adv-analysis=&#34;kpi1&#34; ods-adv-analysis-context=&#34;ctx1&#34; ods-adv-analysis-select=&#34;{{ kpi.select }} as x&#34;&gt;
    &lt;div class=&#34;col-md-4&#34;&gt;
      &lt;!-- KPI box component --&gt;
      &lt;div class=&#34;kpi-card&#34;&gt;
        &lt;i ng-if=&#34;kpi.faicon&#34; class=&#34;kpi-icon fa fa-{{ kpi.faicon }}&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;
        &lt;p class=&#34;kpi-title left&#34;&gt;
          {{ (kpi1[0].x || 0) | number : (kpi.precision || 0) }}         
           &lt;span ng-if=&#34;kpi.unit&#34; class=&#34;kpi-unit left&#34;&gt;{{ kpi.unit }}&lt;/span&gt;
        &lt;/p&gt;
        &lt;p class=&#34;kpi-description&#34;&gt;
          {{ kpi.title }}
        &lt;/p&gt;
        &lt;p class=&#34;kpi-subtitle&#34;
          ng-if=&#34;compareType == &#39;multiFields&#39;&#34;&gt;
          {{ selected1[fields[3].name][0].name ||
            selected1[fields[2].name][0].name ||
            selected1[fields[1].name][0].name ||
            selected1[fields[0].name][0].name || defaultLevel }}&lt;/p&gt;
        
        &lt;p class=&#34;kpi-subtitle&#34; ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length &gt;0&#34;&gt;
          {{results1[0].fields[filterFieldLabel]}}&lt;/p&gt;
          &lt;p class=&#34;kpi-subtitle&#34; ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 &amp;&amp; compareType==&#39;singleField&#39;&#34;&gt;
            {{defaultLevel}}&lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&#34;col-md-4&#34;  ods-adv-analysis=&#34;kpi2&#34; ods-adv-analysis-context=&#34;ctx2&#34; ods-adv-analysis-select=&#34;{{ kpi.select }} as x&#34;&gt;
      &lt;!-- KPI box component --&gt;
      &lt;div class=&#34;kpi-card&#34;&gt;
        &lt;i ng-if=&#34;kpi.faicon&#34; class=&#34;kpi-icon fa fa-{{ kpi.faicon }}&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;
        &lt;p class=&#34;kpi-title right&#34;&gt;
          {{ (kpi2[0].x || 0) | number : (kpi.precision || 0) }}         
          &lt;span ng-if=&#34;kpi.unit&#34; class=&#34;kpi-unit right&#34;&gt;{{ kpi.unit }}&lt;/span&gt;
        &lt;/p&gt;
        &lt;p class=&#34;kpi-description&#34;&gt;
          {{ kpi.title }}
        &lt;/p&gt;
        &lt;p class=&#34;kpi-subtitle&#34;
          ng-if=&#34;compareType == &#39;multiFields&#39;&#34;&gt;
          {{ selected2[fields[3].name][0].name ||
            selected2[fields[2].name][0].name ||
            selected2[fields[1].name][0].name ||
            selected2[fields[0].name][0].name || defaultLevel }}&lt;/p&gt;
        &lt;p class=&#34;kpi-subtitle&#34; ng-if=&#34;ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId].length &gt;0&#34;&gt;
          {{results2[0].fields[filterFieldLabel]}}&lt;/p&gt;
          &lt;p class=&#34;kpi-subtitle&#34; ng-if=&#34;ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 &amp;&amp; compareType==&#39;singleField&#39;&#34;&gt;
            {{defaultLevel}}&lt;/p&gt;

        &lt;p class=&#34;kpi-compare right&#34;&gt;
          {{ ((kpi2[0].x - kpi1[0].x )/kpi1[0].x )*100 &gt; 0 ? &#39;&#43;&#39; : &#39;&#39; }}{{ (((kpi2[0].x -kpi1[0].x )/kpi1[0].x )*100|| 0) | number : 2 }}%
        &lt;/p&gt;
        &lt;span style=&#34;font-style: italic;&#34;&gt;par rapport à &lt;/span&gt;
        &lt;p class=&#34;kpi-compare-subtitle&#34; ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; levelRefSelectedId].length &gt;0&#34;&gt;&lt;span
            ng-repeat=&#34;item1 in items1&#34;&gt; {{item1.name}}{{$last ? &#39;&#39; : &#39; &#43; &#39;}} &lt;/span&gt;&lt;/p&gt;
        &lt;p class=&#34;kpi-compare-subtitle&#34;
          ng-if=&#34;compareType == &#39;multiFields&#39;&#34;&gt;
          {{ selected1[fields[3].name][0].name ||
            selected1[fields[2].name][0].name ||
            selected1[fields[1].name][0].name ||
            selected1[fields[0].name][0].name || defaultLevel }}&lt;/p&gt;
        &lt;p class=&#34;kpi-compare-subtitle&#34; ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length &gt;0&#34;&gt;
          {{results1[0].fields[filterFieldLabel]}}&lt;/p&gt;
          &lt;p class=&#34;kpi-compare-subtitle&#34; ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 &amp;&amp; compareType==&#39;singleField&#39;&#34;&gt;
            {{defaultLevel}}&lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/section&gt;                        &lt;div style=&#34;text-align: right; width: 100%&#34;&gt;
                            &lt;a href=&#34;https://{{ domainid }}/explore/dataset/{{ datasetid }}/&#34;
                               target=&#34;_blank&#34;&gt;Accéder
                                aux données sources&lt;/a&gt;
                        &lt;/div&gt;
                        &lt;span ng-repeat=&#34;chart in charts&#34;&gt;
                                    &lt;span ng-if=&#34;chart.disposition==&#39;pyramid&#39;&#34;&gt;
                                        &lt;section class=&#34;page-section&#34; ng-init=&#34;pyramid = {&#39;analysisref&#39;:undefined,
                            &#39;analysiscompare&#39;:undefined,
                            &#39;orderref&#39;:{},
                            &#39;ordercompare&#39;:{},
                            &#39;defaultorder&#39;:&#39;orderref&#39;}&#34;&gt;

    &lt;div class=&#34;box-container&#34;&gt;
        &lt;div class=&#34;chart-card&#34;&gt;
            &lt;h2&gt;{{chart.title}}&lt;/h2&gt;
            &lt;span ods-adv-analysis=&#34;analysisref&#34; ods-adv-analysis-context=&#34;ctx1&#34;
                ods-adv-analysis-group-by=&#34;{{chart.xAxis}}&#34; ods-adv-analysis-select=&#34;{{chart.select}} as counttotal&#34;
                ods-adv-analysis-order-by=&#34;{{chart.select}} DESC&#34;&gt;
                &lt;div ods-subaggregation=&#34;analysisref&#34; ods-subaggregation-serie-max=&#34;MAX(counttotal)&#34;&gt;

                    {{ pyramid[&#39;maxref&#39;] = results[0].max; &#39;&#39; }}
                &lt;/div&gt;

                {{ pyramid.analysisref = analysisref ; &#39;&#39; }}
            &lt;/span&gt;
            &lt;span ods-adv-analysis=&#34;analysiscompare&#34; ods-adv-analysis-context=&#34;ctx2&#34;
                ods-adv-analysis-group-by=&#34;{{chart.xAxis}}&#34; ods-adv-analysis-select=&#34;{{chart.select}} as counttotal&#34;
                ods-adv-analysis-order-by=&#34;{{chart.select}} DESC&#34;&gt;
                &lt;div ods-subaggregation=&#34;analysiscompare&#34; ods-subaggregation-serie-max=&#34;MAX(counttotal)&#34;&gt;
                    {{ pyramid[&#39;maxcompare&#39;] = results[0].max; &#39;&#39; }}
                &lt;/div&gt;

                {{ pyramid.analysiscompare = analysiscompare ; &#39;&#39; }}
            &lt;/span&gt;
            &lt;span ng-if=&#34;pyramid[&#39;maxref&#39;] &amp;&amp; pyramid[&#39;maxcompare&#39;]&#34;&gt;
                {{ pyramid[&#39;max&#39;] =
                (pyramid[&#39;maxcompare&#39;]&gt;pyramid[&#39;maxref&#39;]?pyramid[&#39;maxcompare&#39;]:pyramid[&#39;maxref&#39;]); &#39;&#39; }}
            &lt;/span&gt;

            &lt;p ng-if=&#34;pyramid.defaultorder == &#39;orderref&#39;&#34; ng-repeat=&#34;(i,item) in pyramid.analysisref&#34;&gt;
                {{ pyramid.order[item[chart.xAxis]] = i&#43;1; &#39;&#39; }}
            &lt;/p&gt;
            &lt;p ng-if=&#34;pyramid.defaultorder == &#39;ordercompare&#39;&#34; ng-repeat=&#34;(i,item) in pyramid.analysiscompare&#34;&gt;
                {{ pyramid.order[item[chart.xAxis]] = i&#43;1; &#39;&#39; }}
            &lt;/p&gt;

            &lt;!--Custom Left/Right Graph here
    ========================================================================== --&gt;

            &lt;div class=&#34;custom-graph&#34;&gt;
                &lt;div class=&#34;custom-graph-body&#34;&gt;
                    &lt;div class=&#34;custom-graph-block&#34;&gt;
                        &lt;div class=&#34;custom-graph-header header-left left&#34;&gt;
                            &lt;h3 class=&#34;custom-graph-title&#34;&gt;
                                &lt;span ng-if=&#34;compareType==&#39;multiFields&#39;&#34;&gt; {{ selected1[fields[3].name][0].name ||
                                    selected1[fields[2].name][0].name ||
                                    selected1[fields[1].name][0].name ||
                                    selected1[fields[0].name][0].name || defaultLevel }}
                                &lt;/span&gt;
                                &lt;span ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length &gt;0&#34;&gt;
                                    {{results1[0].fields[filterFieldLabel]}}&lt;/span&gt;
                                &lt;span
                                    ng-if=&#34;ctx1.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 &amp;&amp; compareType==&#39;singleField&#39;&#34;&gt;
                                    {{defaultLevel}}&lt;/span&gt;
                            &lt;/h3&gt;
                            &lt;h4&gt;{{chart.label}}&lt;/h4&gt;
                        &lt;/div&gt;
                        &lt;div class=&#34;custom-graph-content-left&#34;&gt;
                            &lt;div class=&#34;custom-graph-item&#34; ng-repeat=&#34;itemleft in pyramid.analysisref&#34;
                                ng-if=&#34;pyramid.order[itemleft[chart.xAxis]]&lt;=10&#34; style=&#34;grid-row: {{ pyramid.order[itemleft[chart.xAxis]] }} ;
                                    grid-column:1&#34;&gt;
                                &lt;h5 class=&#34;custom-graph-item-title&#34;&gt;
                                    {{ itemleft[chart.xAxis] }}
                                &lt;/h5&gt;
                                &lt;div class=&#34;custom-graph-progress-container&#34;&gt;
                                    &lt;div class=&#34;custom-graph-progress background-left&#34;
                                        style=&#34;width: {{ 100 * itemleft.counttotal / pyramid.max }}%&#34;&gt;
                                        &lt;span class=&#34;custom-graph-progress-value&#34;&gt;
                                            {{ itemleft.counttotal | number }}
                                        &lt;/span&gt;
                                    &lt;/div&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;

                    &lt;div class=&#34;custom-graph-separator&#34;&gt;&lt;/div&gt;
                    &lt;div class=&#34;custom-graph-block&#34;&gt;
                        &lt;div class=&#34;custom-graph-header header-right right&#34;&gt;
                            &lt;h3 class=&#34;custom-graph-title&#34;&gt;
                                &lt;span ng-if=&#34;compareType==&#39;multiFields&#39;&#34;&gt; {{ selected2[fields[3].name][0].name ||
                                    selected2[fields[2].name][0].name ||
                                    selected2[fields[1].name][0].name ||
                                    selected2[fields[0].name][0].name || defaultLevel }}&lt;/span&gt;
                                &lt;span ng-if=&#34;ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId].length &gt;0&#34;&gt;
                                    {{results2[0].fields[filterFieldLabel]}}&lt;/span&gt;
                                &lt;span
                                    ng-if=&#34;ctx2.parameters[&#39;refine.&#39; &#43; filterFieldId].length ==0 &amp;&amp; compareType==&#39;singleField&#39;&#34;&gt;
                                    {{defaultLevel}}&lt;/span&gt;
                            &lt;/h3&gt;
                            &lt;h4&gt;{{chart.label}}&lt;/h4&gt;
                        &lt;/div&gt;
                        &lt;div class=&#34;custom-graph-content-right&#34;&gt;
                            &lt;div class=&#34;custom-graph-item&#34; ng-repeat=&#34;itemright in pyramid.analysiscompare&#34;
                                ng-if=&#34;pyramid.order[itemright[chart.xAxis]]&lt;=10&#34; style=&#34;grid-row: {{ pyramid.order[itemright[chart.xAxis]] }} ;
                                    grid-column:1&#34;&gt;
                                &lt;h5 class=&#34;custom-graph-item-title&#34;&gt;
                                    {{ itemright[chart.xAxis] }}
                                &lt;/h5&gt;
                                &lt;div class=&#34;custom-graph-progress-container&#34;&gt;
                                    &lt;div class=&#34;custom-graph-progress background-right&#34;
                                        style=&#34;width: {{ 100 * itemright.counttotal / pyramid.max }}%&#34;&gt;
                                        &lt;span class=&#34;custom-graph-progress-value&#34;&gt;
                                            {{ itemright.counttotal | number }}
                                        &lt;/span&gt;
                                    &lt;/div&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;                                    &lt;/span&gt;
                                    &lt;span ng-if=&#34;chart.disposition==&#39;classic&#39;&#34;&gt;
                                        &lt;div class=&#34;box-container&#34;&gt;
    &lt;div class=&#34;chart-card&#34;&gt;
        &lt;h2&gt;{{chart.title}}&lt;/h2&gt;
        &lt;ods-chart ng-if=&#34;compareType==&#39;multiFields&#39;&#34; align-month=&#34;true&#34; single-y-axis=&#34;true&#34; labels-x-length=&#34;25&#34;&gt;
            &lt;ods-chart-query context=&#34;ctx1&#34; field-x=&#34;{{chart.xAxis}}&#34; maxpoints=&#34;{{chart.maxPoints}}&#34;
                sort=&#34;{{chart.sort}}&#34;&gt;
                &lt;ods-chart-serie label-y=&#34;{{ chart.label &#43; &#39; - &#39; &#43; (selected1[fields[3].name][0].name ||
                selected1[fields[2].name][0].name ||
                selected1[fields[1].name][0].name ||
                selected1[fields[0].name][0].name ||defaultLevel ) }}&#34; expression-y=&#34;{{chart.xAxis}}&#34; chart-type=&#34;{{chart.type}}&#34;
                    function-y=&#34;{{chart.function}}&#34; color=&#34;#08A8AB&#34; scientific-display=&#34;true&#34;
                    display-values=&#34;{{chart.displayValues}}&#34; logarithmic=&#34;true&#34;&gt;
                &lt;/ods-chart-serie&gt;
            &lt;/ods-chart-query&gt;
            &lt;ods-chart-query context=&#34;ctx2&#34; field-x=&#34;{{chart.xAxis}}&#34; maxpoints=&#34;{{chart.maxPoints}}&#34; sort=&#34;{{chart.sort}}&#34;&gt;
                &lt;ods-chart-serie label-y=&#34;{{ chart.label &#43; &#39; - &#39; &#43; (selected2[fields[3].name][0].name ||
                selected2[fields[2].name][0].name ||
                selected2[fields[1].name][0].name ||
                selected2[fields[0].name][0].name || defaultLevel) }}&#34; expression-y=&#34;{{chart.xAxis}}&#34; chart-type=&#34;{{chart.type}}&#34;
                    function-y=&#34;{{chart.function}}&#34; color=&#34;#D5AC00&#34; scientific-display=&#34;true&#34;
                    display-values=&#34;{{chart.displayValues}}&#34; logarithmic=&#34;true&#34;&gt;
                &lt;/ods-chart-serie&gt;
            &lt;/ods-chart-query&gt;
        &lt;/ods-chart&gt;
        &lt;ods-chart ng-if=&#34;compareType==&#39;singleField&#39;&#34; align-month=&#34;true&#34; single-y-axis=&#34;true&#34; labels-x-length=&#34;25&#34;&gt;
            &lt;ods-chart-query context=&#34;ctx1&#34; field-x=&#34;{{chart.xAxis}}&#34; maxpoints=&#34;{{chart.maxPoints}}&#34;
                sort=&#34;{{chart.sort}}&#34;&gt;
                &lt;ods-chart-serie label-y=&#34;{{ chart.label &#43; &#39; - &#39; &#43; ((items1 | toObject : &#39;name&#39; | keys).length == 1 ? (items1 | toObject : &#39;name&#39; | keys) : defaultLevel) }}&#34; expression-y=&#34;{{chart.xAxis}}&#34; chart-type=&#34;{{chart.type}}&#34;
                    function-y=&#34;{{chart.function}}&#34; color=&#34;#08A8AB&#34; scientific-display=&#34;true&#34;
                    display-values=&#34;{{chart.displayValues}}&#34; logarithmic=&#34;true&#34;&gt;
                &lt;/ods-chart-serie&gt;
            &lt;/ods-chart-query&gt;
            &lt;ods-chart-query context=&#34;ctx2&#34; field-x=&#34;{{chart.xAxis}}&#34; maxpoints=&#34;{{chart.maxPoints}}&#34; sort=&#34;{{chart.sort}}&#34;&gt;
                &lt;ods-chart-serie label-y=&#34;{{ chart.label &#43; &#39; - &#39; &#43; ((items2 | toObject : &#39;name&#39; | keys).length == 1 ? (items2 | toObject : &#39;name&#39; | keys) : defaultLevel) }}&#34; expression-y=&#34;{{chart.xAxis}}&#34; chart-type=&#34;{{chart.type}}&#34;
                    function-y=&#34;{{chart.function}}&#34; color=&#34;#D5AC00&#34; scientific-display=&#34;true&#34;
                    display-values=&#34;{{chart.displayValues}}&#34; logarithmic=&#34;true&#34;&gt;
                &lt;/ods-chart-serie&gt;
            &lt;/ods-chart-query&gt;
        &lt;/ods-chart&gt;
    &lt;/div&gt;
&lt;/div&gt;                                    &lt;/span&gt;
                                &lt;/span&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/ods-dataset-context&gt;
&lt;/div&gt;</code></pre>
                </div>
            </div>
            
            <div class="js-tabcontent"
                 id="code-automated-comparison-dashboard-css-content"
                 data-clipboard="/* General Layout
========================================================================== */
:root {
  --left-color: #08a8ab;
  --right-color: #d5ac00;
  --secondary-color: black;
}

.left {
  color: var(--left-color);
}

.right {
  color: var(--right-color);
}

.background-left {
  background-color: var(--left-color);
}

.background-right {
  background-color: var(--right-color);
}

@media screen and (min-width: 992px) {
  .row-equal-height {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -ms-flex-wrap: wrap;
    flex-wrap: wrap;
    margin-bottom: 20px;
    width: 100%;
    justify-content: space-around;
  }

  /* Fix for early content wrapping in Safari*/
  .row-equal-height:before,
.row-equal-height:after {
    content: normal;
  }
}


.page-title {
  font-size: 3rem;
  font-weight: bold;
  margin-top: 0;
  margin-bottom: 1rem;
}

.page-subtitle {
  font-size: 1.2rem;
  line-height: 2;
  margin-top: 0;
  margin-bottom: 3rem;
}

.box-container {
  padding: 10px 0px;
}

@media screen and (min-width: 992px) {
  .box-container {
    display: flex;
    justify-content: center;
  }
}

/* Filters
========================================================================== */
.ods-selects {
  display: flex;
  flex-direction: column;
  gap: 5px;
}

.filterbloc {
  background-color: var(--boxes-background);
  height: 100%;
  padding: 20px 0px;
  border-radius: 4px;
  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.13);
  margin: 10px 0px;
  width: 100%;
}

.filterbloc-title {
  text-align: center;
}

.filter-list {
  display: flex;
  flex-wrap: wrap;
  position: relative;
  margin-bottom: 20px;
  justify-content: space-around;
}

.filter-list &gt; * {
  margin: 0 0 10px;
  width: 100%;
}

.filter-box {
  display: flex;
  flex-direction: column;
  gap: 10px;
  align-items: center;
}

.filter-title {
  margin-top: 15px;
  margin-bottom: 0px;
}

.odswidget-select .odswidget-select-dropdown.open .odswidget-select-dropdown-menu {
  width: 100%;
}

.odswidget-select,
.odswidget-select .odswidget-select-dropdown {
  width: 100%;
}

@media screen and (min-width: 500px) {
  .filter-list &gt; * {
    margin: 0 10px 10px 0;
    width: inherit;
  }

  .odswidget-select .odswidget-select-dropdown.open .odswidget-select-dropdown-menu, .odswidget-select-input, .odswidget-select-dropdown {
    width: max-content;
    min-width: 266px;
  }
}
.select-left .odswidget-select-dropdown-item-close-icon, .select-left .odswidget-select-dropdown-item-icon.fa-check-square,
.select-left .odswidget-select-dropdown-item-icon.fa-minus-square,
.select-left .odswidget-select-dropdown-menu-item:hover i.fa-square-o {
  color: var(--left-color);
}

.select-right .odswidget-select-dropdown-item-close-icon, .select-right .odswidget-select-dropdown-item-icon.fa-check-square,
.select-right .odswidget-select-dropdown-item-icon.fa-minus-square,
.select-right .odswidget-select-dropdown-menu-item:hover i.fa-square-o {
  color: var(--right-color);
}

.clear-filters {
  display: flex;
  align-items: center;
  justify-content: center;
  margin-top: 5px;
}

.clear-filters-button {
  background: none;
  border: none;
  color: var(--text);
}

.clear-filters-button:hover {
  opacity: 0.65;
}

/* KPI Card
========================================================================== */
.kpi-card {
  background-color: var(--boxes-background);
  height: 100%;
  padding: 39px;
  border-radius: 4px;
  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.13);
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
  -ms-flex-direction: column;
  flex-direction: column;
  -webkit-box-align: center;
  -ms-flex-align: center;
  align-items: center;
  text-align: center;
  -webkit-box-pack: center;
  -ms-flex-pack: center;
  justify-content: center;
  text-align: center;
  width: 100%;
  margin-bottom: 5px;
}

.kpi-icon {
  color: var(--secondary-color);
  font-size: 4rem;
  margin-top: 0;
  margin-bottom: 13px;
  max-width: 100%;
}

.kpi-title {
  font-weight: normal;
  font-size: 3.2rem;
  margin-top: 0;
  max-width: 100%;
  margin-bottom: 5px;
}

.kpi-compare {
  font-weight: normal;
  font-size: 1.8rem;
  margin-top: 0;
  margin-bottom: 0px;
  max-width: 100%;
}

.kpi-unit {
  font-size: 0.8em;
}

.kpi-description {
  color: var(--text);
  font-size: 1rem;
  line-height: 1.5;
  font-weight: normal;
  margin-top: 0;
  margin-bottom: 0;
  max-width: 100%;
}

.kpi-subtitle {
  font-weight: bold;
  text-transform: uppercase;
  margin-bottom: 0;
}

.kpi-compare-subtitle {
  text-transform: uppercase;
  margin-bottom: 0;
}

/* Charts
========================================================================== */
.chart-card {
  background-color: var(--boxes-background);
  height: 100%;
  padding: 39px;
  border-radius: 4px;
  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.13);
  display: block;
  width: 100%;
  margin-bottom: 10px;
}

.chart-title:first-child {
  margin-top: 20px;
}

rect.highcharts-background {
  fill: transparent !important;
}

/* Custom Charts
========================================================================== */
.custom-graph {
  display: flex;
  flex-direction: column;
  margin-bottom: 4rem;
  width: 100%;
}

.custom-graph-body {
  display: flex;
  align-items: stretch;
}

.custom-graph-block {
  flex: 1 1 auto;
}

.custom-graph-separator {
  width: 3px;
  background-color: #232423;
}

.custom-graph-header {
  display: block;
  margin-bottom: 0.5rem;
}
.custom-graph-header h4 {
  margin-top: 0;
}

.header-right {
  text-align: right;
}

.custom-graph-title {
  font-size: 1.43rem;
  margin: 0;
  text-transform: uppercase;
  color: var(--titles);
  font-weight: bold;
}

.custom-graph-content {
  display: grid;
}

.custom-graph-item {
  border-bottom: 1px solid #979797;
  margin-top: 0.5rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  min-height: 50px;
}

.custom-graph-item-title {
  font-size: 0.75rem;
  color: var(--titles);
  font-weight: normal;
  margin: 0;
  flex: 0 0 35%;
}

.custom-graph-progress-container {
  align-self: end;
  flex: 1 1 65%;
}

.custom-graph-progress {
  height: 30px;
  display: flex;
  align-items: center;
}

.custom-graph-progress-value {
  font-size: 0.625rem;
  color: var(--titles);
  margin: 0 9px;
}

.custom-graph-content-left .custom-graph-progress {
  margin-left: auto;
  border-radius: 8px 0 0 8px;
  justify-content: flex-end;
}

.custom-graph-content-right .custom-graph-item-title {
  order: 1;
  text-align: right;
}

.custom-graph-content-right .custom-graph-progress {
  order: 1;
  margin-right: auto;
  border-radius: 0 8px 8px 0;
  justify-content: flex-start;
}

.custom-graph-inverted-text-color .custom-graph-progress-value,
.custom-graph-inverted-text-color .custom-graph-item-title {
  color: inherit;
}"
            >
                <div class="highlight">
                    <pre class="language-css" data-lang="css"><code>/* General Layout
========================================================================== */
:root {
  --left-color: #08a8ab;
  --right-color: #d5ac00;
  --secondary-color: black;
}

.left {
  color: var(--left-color);
}

.right {
  color: var(--right-color);
}

.background-left {
  background-color: var(--left-color);
}

.background-right {
  background-color: var(--right-color);
}

@media screen and (min-width: 992px) {
  .row-equal-height {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -ms-flex-wrap: wrap;
    flex-wrap: wrap;
    margin-bottom: 20px;
    width: 100%;
    justify-content: space-around;
  }

  /* Fix for early content wrapping in Safari*/
  .row-equal-height:before,
.row-equal-height:after {
    content: normal;
  }
}


.page-title {
  font-size: 3rem;
  font-weight: bold;
  margin-top: 0;
  margin-bottom: 1rem;
}

.page-subtitle {
  font-size: 1.2rem;
  line-height: 2;
  margin-top: 0;
  margin-bottom: 3rem;
}

.box-container {
  padding: 10px 0px;
}

@media screen and (min-width: 992px) {
  .box-container {
    display: flex;
    justify-content: center;
  }
}

/* Filters
========================================================================== */
.ods-selects {
  display: flex;
  flex-direction: column;
  gap: 5px;
}

.filterbloc {
  background-color: var(--boxes-background);
  height: 100%;
  padding: 20px 0px;
  border-radius: 4px;
  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.13);
  margin: 10px 0px;
  width: 100%;
}

.filterbloc-title {
  text-align: center;
}

.filter-list {
  display: flex;
  flex-wrap: wrap;
  position: relative;
  margin-bottom: 20px;
  justify-content: space-around;
}

.filter-list &gt; * {
  margin: 0 0 10px;
  width: 100%;
}

.filter-box {
  display: flex;
  flex-direction: column;
  gap: 10px;
  align-items: center;
}

.filter-title {
  margin-top: 15px;
  margin-bottom: 0px;
}

.odswidget-select .odswidget-select-dropdown.open .odswidget-select-dropdown-menu {
  width: 100%;
}

.odswidget-select,
.odswidget-select .odswidget-select-dropdown {
  width: 100%;
}

@media screen and (min-width: 500px) {
  .filter-list &gt; * {
    margin: 0 10px 10px 0;
    width: inherit;
  }

  .odswidget-select .odswidget-select-dropdown.open .odswidget-select-dropdown-menu, .odswidget-select-input, .odswidget-select-dropdown {
    width: max-content;
    min-width: 266px;
  }
}
.select-left .odswidget-select-dropdown-item-close-icon, .select-left .odswidget-select-dropdown-item-icon.fa-check-square,
.select-left .odswidget-select-dropdown-item-icon.fa-minus-square,
.select-left .odswidget-select-dropdown-menu-item:hover i.fa-square-o {
  color: var(--left-color);
}

.select-right .odswidget-select-dropdown-item-close-icon, .select-right .odswidget-select-dropdown-item-icon.fa-check-square,
.select-right .odswidget-select-dropdown-item-icon.fa-minus-square,
.select-right .odswidget-select-dropdown-menu-item:hover i.fa-square-o {
  color: var(--right-color);
}

.clear-filters {
  display: flex;
  align-items: center;
  justify-content: center;
  margin-top: 5px;
}

.clear-filters-button {
  background: none;
  border: none;
  color: var(--text);
}

.clear-filters-button:hover {
  opacity: 0.65;
}

/* KPI Card
========================================================================== */
.kpi-card {
  background-color: var(--boxes-background);
  height: 100%;
  padding: 39px;
  border-radius: 4px;
  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.13);
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
  -ms-flex-direction: column;
  flex-direction: column;
  -webkit-box-align: center;
  -ms-flex-align: center;
  align-items: center;
  text-align: center;
  -webkit-box-pack: center;
  -ms-flex-pack: center;
  justify-content: center;
  text-align: center;
  width: 100%;
  margin-bottom: 5px;
}

.kpi-icon {
  color: var(--secondary-color);
  font-size: 4rem;
  margin-top: 0;
  margin-bottom: 13px;
  max-width: 100%;
}

.kpi-title {
  font-weight: normal;
  font-size: 3.2rem;
  margin-top: 0;
  max-width: 100%;
  margin-bottom: 5px;
}

.kpi-compare {
  font-weight: normal;
  font-size: 1.8rem;
  margin-top: 0;
  margin-bottom: 0px;
  max-width: 100%;
}

.kpi-unit {
  font-size: 0.8em;
}

.kpi-description {
  color: var(--text);
  font-size: 1rem;
  line-height: 1.5;
  font-weight: normal;
  margin-top: 0;
  margin-bottom: 0;
  max-width: 100%;
}

.kpi-subtitle {
  font-weight: bold;
  text-transform: uppercase;
  margin-bottom: 0;
}

.kpi-compare-subtitle {
  text-transform: uppercase;
  margin-bottom: 0;
}

/* Charts
========================================================================== */
.chart-card {
  background-color: var(--boxes-background);
  height: 100%;
  padding: 39px;
  border-radius: 4px;
  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.13);
  display: block;
  width: 100%;
  margin-bottom: 10px;
}

.chart-title:first-child {
  margin-top: 20px;
}

rect.highcharts-background {
  fill: transparent !important;
}

/* Custom Charts
========================================================================== */
.custom-graph {
  display: flex;
  flex-direction: column;
  margin-bottom: 4rem;
  width: 100%;
}

.custom-graph-body {
  display: flex;
  align-items: stretch;
}

.custom-graph-block {
  flex: 1 1 auto;
}

.custom-graph-separator {
  width: 3px;
  background-color: #232423;
}

.custom-graph-header {
  display: block;
  margin-bottom: 0.5rem;
}
.custom-graph-header h4 {
  margin-top: 0;
}

.header-right {
  text-align: right;
}

.custom-graph-title {
  font-size: 1.43rem;
  margin: 0;
  text-transform: uppercase;
  color: var(--titles);
  font-weight: bold;
}

.custom-graph-content {
  display: grid;
}

.custom-graph-item {
  border-bottom: 1px solid #979797;
  margin-top: 0.5rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  min-height: 50px;
}

.custom-graph-item-title {
  font-size: 0.75rem;
  color: var(--titles);
  font-weight: normal;
  margin: 0;
  flex: 0 0 35%;
}

.custom-graph-progress-container {
  align-self: end;
  flex: 1 1 65%;
}

.custom-graph-progress {
  height: 30px;
  display: flex;
  align-items: center;
}

.custom-graph-progress-value {
  font-size: 0.625rem;
  color: var(--titles);
  margin: 0 9px;
}

.custom-graph-content-left .custom-graph-progress {
  margin-left: auto;
  border-radius: 8px 0 0 8px;
  justify-content: flex-end;
}

.custom-graph-content-right .custom-graph-item-title {
  order: 1;
  text-align: right;
}

.custom-graph-content-right .custom-graph-progress {
  order: 1;
  margin-right: auto;
  border-radius: 0 8px 8px 0;
  justify-content: flex-start;
}

.custom-graph-inverted-text-color .custom-graph-progress-value,
.custom-graph-inverted-text-color .custom-graph-item-title {
  color: inherit;
}</code></pre>
                </div>
            </div>
            
        </div>
    </div>
</div>

                </div>
            
        </article>
        
    </div>
</section>

      </div>
    </div>

    <footer class="footer">
    <a href="https://www.opendatasoft.com"
       class="footer-link"
       title="Opendatasoft website">
        <img src="/img/ods-logo.svg"
             class="footer-logo"
             alt="Opendatasoft logo"
        />
    </a>
    <span class="footer-copyright">
        &copy; Copyright 2020
    </span>
</footer>
    
    
    

    <script>
      var process = { env: { NODE_ENV: "production" } };
    </script>
    <script
      type="text/javascript"
      src="/index.min.ba71bbe69583a06c1a20d50de7512f7cd7ee767a9fcdbe52935b11b762c22a39.js"
      defer
    ></script>
  </body>
</html>
